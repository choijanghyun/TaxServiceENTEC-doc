# 통합 경정청구 환급액 산출 시스템 — 개발상세설계서 v1.1

> **문서 버전**: v1.1 (법인세 v4.0r1 + 종합소득세 v1.3 통합, 1~3차 보완 반영)  
> **기준 프롬프트**:  
> 　- 법인사업자-법인세-경정청구-AI점검요청-프롬프트 v1.3  
> 　- 개인사업자-종합소득세-경정청구-AI점검요청-프롬프트 v1.3  
> **작성일**: 2026-02-16  
> **변경이력**:  
> 　- v1.0: 법인세 설계서 v4.0r1 전체 승계 + 종합소득세 신규 설계 + TAX_TYPE 아키텍처 도입  
> 　- **v1.1 변경사항 (1~3차 지적사항 반영)**:  
> 　　① [개인] 건강보험료 필요경비/소득공제 3분류 분기 로직 상세화 (P4-01b)  
> 　　② [법인] 업무용 승용차 비용 재산출 서브모듈 신설 (M4-11a)  
> 　　③ [개인] 성실신고확인대상 자동 판정 로직 추가 (P3-02)  
> 　　④ [법인] 결산조정 항목 경정청구 차단 필터 강화 (M3-00)  
> 　　⑤ [공통] 사후관리 이자상당가산액 포함 추징액 산출 로직 추가 (M7-03)  
> 　　⑥ [검증] 신규 Validation Rule 4건 추가 (VP06, BP05, LP04, LP05)  
> 　　⑦ [법인] 수입배당금 익금불산입 연도별 적용기준 매칭 강화 (M4-09)  
> 　　⑧ [공통] 최종 환급 보고서 출력 양식 구조화 (M6-04)

---

## 통합 변경 이력 (법인세 v4.0r1 → 통합 v1.0 → v1.1)

### 🔀 통합 설계 방침

| 구분 | 설계 원칙 |
|------|----------|
| 세목 분기 | 모든 모듈·테이블에 `TAX_TYPE` (`CORP`/`INC`) 분기점 도입 |
| 공통 모듈 유지 | 법인세 v4.0r1의 M1~M7, MX 구조를 그대로 유지하되 세목별 분기 추가 |
| 개인 전용 모듈 | 법인세에 없는 개인사업자 고유 로직을 `P-` 접두어 모듈로 신설 |
| 개인 전용 테이블 | `TBL_INC_*` 접두어로 종합소득세 전용 입력 테이블 신설 |
| 기준정보 확장 | `REF_INC_TAX_RATE` 등 소득세 전용 기준정보 테이블 추가 |
| 법인 고유 모듈 | 기존 법인 전용 모듈(M4-09 수입배당금, M4-12~14 등)은 `TAX_TYPE='CORP'`일 때만 활성화 |

### ➕ 종합소득세 통합을 위한 신규 항목 — 총 62건

### 🔧 v1.1 보완 항목 총괄 — 총 13건 (1~3차 지적사항 정당성 검토 후 반영)

| No | 유형 | 보완 대상 | 보완 내용 | 지적 차수 | 정당성 |
|----|------|----------|----------|----------|--------|
| 1 | 로직 보완 | P4-01b | 건강보험료 3분류(지역→소득공제, 직장본인→소득공제, 근로자사업주부담→필요경비) | 1차 | ✅ 프롬프트 ㉖규칙 근거 |
| 2 | 모듈 신설 | M4-11a | 업무용 승용차 비용 재산출 (운행기록부, 전용보험, 감가상각한도) | 1차 | ✅ 프롬프트 점검0 근거 |
| 3 | 로직 보완 | P3-02 | 성실신고확인대상 자동 판정 (수입금액×업종→REF 대조) | 1차 | ✅ 수동입력 의존 제거 |
| 4 | 로직 강화 | M3-00 | 결산조정 항목(감가상각·퇴충·대충) 경정청구 Hard Fail 필터 | 1차 | ✅ 법인세법 §40 근거 |
| 5 | 로직 추가 | M7-03 | 이자상당가산액 포함 추징액 산출 공식 | 1차 | ✅ 프롬프트 ㉖규칙 근거 |
| 6 | 검증 추가 | VP06 | 성실사업자 의료비·교육비 신청 시 대상 여부 검증 | 1차 | ✅ 조특법 §122의3 |
| 7 | 검증 추가 | BP05 | 이월결손금 공제 한도 (중소100%/일반80%) 자동 적용 | 1차 | ✅ 법인세법 §13 |
| 8 | 검증 추가 | LP04 | 2025년 이후 창업 §6+§29의8 중복배제 강제 | 1차 | ✅ 2024세법개정 |
| 9 | 검증 추가 | LP05 | 결산조정 항목 경정청구 불가 필터링 | 2차 | ✅ 법인세법 §40 |
| 10 | 로직 보완 | M4-09 | 수입배당금 익금불산입 연도별 적용기준(2023개정/종전규정) 매칭 | 3차 | ✅ 법인세법 §18의2 |
| 11 | 양식 구조화 | M6-04 | 최종 환급 보고서 4부 구조 (요약표+최저한세분석+지방소득세+사후관리) | 3차 | ✅ 실무 가독성 |
| 12 | 모듈 확장 | P4-04~14 | 개인 전용 공제 모듈 입력·참조 테이블 연계 명시 | 2차 | ✅ 설계 완결성 |
| 13 | 로직 보완 | P4-01 | 세율구간 시뮬레이션 시 노란우산공제 등 반영 후 시나리오 비교 | 3차 | ✅ 최적화 정밀도 |

#### 신규 입력 테이블 (8개)

| No | 테이블 | 목적 | 근거 |
|----|--------|------|------|
| P-T01 | TBL_INC_BASIC | 개인사업자 기본 정보 (대표자 인적사항, 다사업장 정보) | 프롬프트 [납세자 기본 정보] |
| P-T02 | TBL_INC_BUSINESS | 사업장별 상세 정보 (업종, 소재지, 수입금액, 소득금액) | 프롬프트 [사업장별 정보] |
| P-T03 | TBL_INC_OTHER_INCOME | 사업소득 외 합산소득 (근로·이자·배당·연금·기타) | 프롬프트 [종합소득 합산 정보] |
| P-T04 | TBL_INC_DEDUCTION | 소득공제 항목 (인적공제, 연금, 보험료, 주택자금 등) | 프롬프트 [소득공제 정보], 점검 32 |
| P-T05 | TBL_INC_SINCERITY | 성실신고확인 관련 (확인비용, 의료비·교육비) | 점검 26, 31-2 |
| P-T06 | TBL_INC_FOREIGN_TAX | 개인 외국납부세액 상세 (국가별, 세액공제/필요경비 선택) | 점검 34 |
| P-T07 | TBL_INC_RENTAL_REDUCTION | 착한 임대인 세액공제 (임대료 인하 내역) | 점검 35 |
| P-T08 | TBL_INC_JOINT_BIZ | 공동사업자 정보 (손익분배비율, 공동사업장 소득) | 핵심전제 ⑪ |

#### 신규 기준정보 테이블 (4개)

| No | 테이블 | 목적 | 근거 |
|----|--------|------|------|
| P-R01 | REF_INC_TAX_RATE | 소득세 세율 (과세연도별 6~45% 8단계) | 소득세법 §55, 점검 9-7 |
| P-R02 | REF_INC_MIN_TAX | 개인 최저한세율 (산출세액×35%/45%) | 조특법 §132②, 점검 5 |
| P-R03 | REF_INC_DEDUCTION_LIMIT | 소득공제 한도 (노란우산, 연금저축 등 항목별) | 소득세법 §50~54 |
| P-R04 | REF_INC_SINCERITY_THRESHOLD | 성실신고확인대상 수입금액 기준 (업종별) | 소득세법 §70의2 |

#### 신규 출력 테이블 (3개)

| No | 테이블 | 목적 | 근거 |
|----|--------|------|------|
| P-O01 | OUT_INC_INCOME_ALLOCATION | 다사업장 소득 배분 산출 결과 | 점검 9-6, 시행령 §117 |
| P-O02 | OUT_INC_DEDUCTION_IMPACT | 소득공제 반영 전후 세율구간 변동 분석 | 점검 32 세율구간 최적화 |
| P-O03 | OUT_INC_LOCAL_TAX | 지방소득세 환급액 별도 산출 | 점검 33, 지방세법 §89 |

#### 신규 모듈 (15개)

| No | 모듈ID | 기능명 | 근거 |
|----|--------|--------|------|
| 1 | P1-01 | 개인사업자 기본 정보 입력 | [납세자 기본 정보] |
| 2 | P1-02 | 사업장별 정보 입력 (다사업장) | [사업장별 정보] |
| 3 | P1-03 | 종합소득 합산 정보 입력 | [종합소득 합산 정보] |
| 4 | P1-04 | 소득공제 정보 입력 | [소득공제 정보] |
| 5 | P3-01 | 소재지 사업장별 개별 판단 | 점검 2 (본점간주 없음) |
| 6 | P3-02 | 종합소득세 경정청구 기한 (5.31/6.30 기산) | 사전확인 |
| 7 | P4-01 | 소득공제 누락 점검·세율구간 최적화 | 점검 32 |
| 8 | P4-02 | 감면 소득 배분 계산 (다사업장/겸업) | 점검 9-6, 점검 24 |
| 9 | P4-03 | 공동사업자 소득 배분 | 핵심전제 ⑪, 점검 9-6 |
| 10 | P4-04 | 성실사업자 의료비·교육비 세액공제 | 점검 26 |
| 11 | P4-05 | 성실신고확인비용 세액공제 | 점검 31-2 |
| 12 | P4-06 | 기장세액공제 | 점검 30 |
| 13 | P4-07 | 개인 외국납부세액공제 | 점검 34 |
| 14 | P4-08 | 착한 임대인 세액공제 | 점검 35 |
| 15 | P5-01 | 개인 최저한세 산출 (산출세액×35%/45%) | 점검 5 |

#### 신규 검증 규칙 (12건)

| 코드 | 유형 | 설명 | 근거 |
|------|------|------|------|
| VP01 | Validation | 개인사업자 TAX_TYPE='INC' 시 TBL_INC_BASIC 필수 | 입력 검증 |
| VP02 | Validation | 다사업장: TBL_INC_BUSINESS 최소 1건 필수 | 입력 검증 |
| VP03 | Validation | 공동사업자: 손익분배비율 합계 = 100% | 소득세법 §43 |
| CP01 | Calculation | 감면세액 ≤ 산출세액 × (감면대상소득÷종합소득금액) × 감면율 | 시행령 §117 |
| CP02 | Calculation | 소득공제 후 과세표준 ≥ 0 | 논리 검증 |
| CP03 | Calculation | 개인 최저한세 = 산출세액 × 35%(3천만이하) + 45%(초과분) | 조특법 §132② |
| BP01 | Business | 기장세액공제 + 조특법 감면 중복 허용 확인 | 소득세법 §56의2 |
| BP02 | Business | 성실신고확인비용(§126의6) = 최저한세 대상 ○ | 조특법 시행령 §126 |
| BP03 | Business | 성실사업자 의료비·교육비(§122의3) = 최저한세 대상 ✕ | 시행령 §126 미포함 |
| LP01 | Legal | 개인 적용순서 = 소득세법 §60 (법인세법 §59 아님) | 소득세법 §60 |
| LP02 | Legal | 개인 경정청구 기산일 = 5.31 (성실: 6.30) | 소득세법 §70, §70의2 |
| WP01 | Warning | 분리과세 소득이 종합소득금액에서 제외되었는지 확인 | 핵심전제 ⑫ |

---

## 목차

1. [시스템 개요](#1-시스템-개요)
2. [기능 분할도 (Functional Decomposition Diagram)](#2-기능-분할도)
3. [테이블 설계 — 공통 입력 테이블](#3-테이블-설계--공통-입력-테이블)
4. [테이블 설계 — 개인사업자 전용 입력 테이블](#4-테이블-설계--개인사업자-전용-입력-테이블)
5. [테이블 설계 — 기준정보 테이블](#5-테이블-설계--기준정보-테이블)
6. [테이블 설계 — 출력(산출) 테이블](#6-테이블-설계--출력산출-테이블)
7. [단계별 업무처리 절차서](#7-단계별-업무처리-절차서)
8. [개별 기능 상세설계 — 개인사업자 전용 모듈](#8-개별-기능-상세설계--개인사업자-전용-모듈)
9. [계산 공식 정의서 — 종합소득세](#9-계산-공식-정의서--종합소득세)
10. [검증 규칙 및 제약조건](#10-검증-규칙-및-제약조건)
11. [세목별 과세 구조 비교 및 분기 정의](#11-세목별-과세-구조-비교-및-분기-정의)
12. [프롬프트 대비 교차검증 결과](#12-프롬프트-대비-교차검증-결과)
13. [부록 — 법인세 v4.0r1 승계 내역](#부록--법인세-v40r1-승계-내역)

---

## 1. 시스템 개요

### 1.1 목적

법인사업자의 **법인세** 및 개인사업자의 **종합소득세** 경정청구 시 환급액을 극대화하기 위한 통합 AI 점검 시스템을 개발한다. 납세자 유형(법인/개인)에 따라 입력자료·과세구조·계산로직을 분기 처리하되, 공제·감면 항목 점검·상호배제 규칙·최저한세·농특세·환급가산금 등 공통 로직은 통합 엔진으로 처리한다.

### 1.2 적용 범위

| 구분 | 법인세 (`TAX_TYPE='CORP'`) | 종합소득세 (`TAX_TYPE='INC'`) |
|------|---------------------------|-------------------------------|
| 대상 세목 | 법인세 (법인세법) | 종합소득세 (소득세법) |
| 대상 납세자 | 법인사업자 (내국법인) | 개인사업자 (거주자) |
| 경정청구 근거 | 국세기본법 §45의2 | 국세기본법 §45의2 |
| 법정신고기한 | 사업연도종료 + 3개월 | 5.31 (성실: 6.30) |
| 세율 | 9~24% (4단계) | 6~45% (8단계) |
| 최저한세 기준 | 과세표준 × 7~17% | 산출세액 × 35%/45% |
| 소득공제 | 없음 (손금·익금 조정) | 있음 (인적공제, 연금 등) |
| 소재지 판단 | 본점 간주 규정 | 사업장별 개별 판단 |
| 고유 점검항목 | 수입배당금, 세무조정, 연결납세, 기업구조조정 등 | 소득공제 누락, 성실사업자 공제, 기장세액공제, 공동사업자 배분 등 |

### 1.3 핵심 설계 원칙

#### 공통 원칙 (법인·개인 동일)

| 원칙 | 내용 |
|------|------|
| 사업(과세)연도별 법령 적용 | 세율, 공제율, 적용기한은 경정청구 대상 연도 기준 |
| 절사(Truncate) 원칙 | 금액 10원 미만 절사, 비율·인원 소수점 3자리 절사, 환급가산금 1원 미만 절사 |
| 반올림 절대 금지 | 모든 단계 TRUNCATE, ROUND 금지 |
| 적용순서 준수 | 감면 → 이월불가 공제 → 이월가능 공제 |
| 상호배제 준수 | 조특법 §127④ 중복적용 규칙 |

#### 법인 전용 원칙 (`TAX_TYPE='CORP'`)

| 원칙 | 내용 |
|------|------|
| 법인 전체 합산 | 상시근로자 수 = 법인 단위 전 사업장 합산 |
| 본점 소재지 간주 | 본점 수도권 → 전 사업장 수도권 (제7조), 제24조는 실제 설치장소 |
| 적용순서 근거법 | **법인세법 제59조** |
| 최저한세 | 과세표준 기준 (중소 7%, 중견 10~12%, 대 17%) |
| 결산확정 원칙 | 결산조정 항목 = 경정청구 불가 (★v1.1 Hard Fail 필터 적용) |

#### 개인 전용 원칙 (`TAX_TYPE='INC'`)

| 원칙 | 내용 | 근거 |
|------|------|------|
| 인별 합산과세 | 대표자 1인 기준, 모든 소득(사업·근로·이자·배당·연금·기타) 합산 | 소득세법 §14 |
| 사업장별 개별 판단 | 본점 간주 규정 없음 → 소재지별 감면율 차등 | 프롬프트 핵심전제 ⑨ |
| 감면 소득 배분 | 감면세액 = 산출세액 × (감면대상소득 ÷ 종합소득금액) × 감면율 | 시행령 §117 |
| 적용순서 근거법 | **소득세법 제60조** (법인세법 §59 아님) | 핵심전제 ⑦ |
| 최저한세 | 산출세액 × 35% (3천만이하) / 45% (초과분), 규모 불문 동일 | 조특법 §132② |
| 소득공제 | 인적공제·연금·보험료 등 과세표준 차감 → 세율구간 변동 가능 | 소득세법 §50~54 |
| 공동사업자 | 손익분배비율에 따라 소득 배분 후 인별 과세 | 소득세법 §43 |
| 분리과세 소득 제외 | 종합소득금액 분모에서 비과세·분리과세 소득 제외 | 핵심전제 ⑫ |
| 기장세액공제 | 소득세법상 공제 → 조특법 §127 중복배제 비대상 | 소득세법 §56의2 |
| 지방소득세 별도 | 국세 확정 후 별도 경정청구 | 지방세법 §89 |

### 1.4 세목별 과세 구조 비교

| 항목 | 법인세 (CORP) | 종합소득세 (INC) |
|------|--------------|-----------------|
| 과세단위 | 법인 1개 단위 | 대표자(사업자) 1인 |
| 소득합산 | 각사업연도소득 (본점 전체) | 사업소득 + 근로 + 이자·배당 + 연금 + 기타 |
| 세율 | 9~24% (2023~) 4단계 | 6~45% 8단계 (연도별 구간 상이) |
| 최저한세 기준값 | 과세표준 | 산출세액 |
| 최저한세율 | 중소 7% / 중견 10~12% / 대 17% | 35% (3천만 이하) / 45% (초과) — 규모 불문 |
| 소득공제 | 없음 | 인적·연금·보험·주택자금 등 |
| 소재지 판단 | 본점 간주 | 사업장별 개별 |
| 적용순서 근거 | 법인세법 §59 | 소득세법 §60 |
| 신고기한 | 사업연도종료+3개월 | 다음해 5.31 (성실: 6.30) |
| 환급가산금 성격 | 법인세 익금불산입 (§18④) | 비과세소득 (소득세법 열거주의) |
| 상시근로자 제외 | 임원·최대주주 친족 | 대표자 본인·배우자·직계존비속 |
| 결손금 소급공제 근거 | 법인세법 §72 | 소득세법 §85의2 |

### 1.5 경정청구 가능/불가 구분

#### 공통 (법인·개인)

| 구분 | 항목 |
|------|------|
| **경정청구 가능** | 세액감면 신규/변경, 세액공제 추가, 공제방식 변경(R&D), 감면종류 변경(§7↔§6), 감면신청서 미제출 사후적용 |
| **경정청구 불가** | 법정신고기한 후 5년 경과 |

#### 법인 전용

| 구분 | 항목 |
|------|------|
| 가능 (신고조정) | 일시상각충당금, 익금불산입 누락, 외국납부세액공제 방식 변경, 이월결손금 오류 수정 |
| 불가 (결산조정) | 감가상각비 추가 계상, 퇴직급여·대손충당금 추가, 감가상각 방법 변경 (★v1.1 LP05 Hard Fail 필터 적용) |

#### 개인 전용

| 구분 | 항목 |
|------|------|
| 가능 | 소득공제 누락분 추가, 성실사업자 의료비·교육비 미신청분, 성실신고확인비용 미신청분, 기장세액공제 누락, 외국납부세액공제 미적용/방식변경, 착한 임대인 세액공제 미신청 |
| 불가 | 추계신고 사업자의 세액감면·공제 (조특법 §128) |

---

## 2. 기능 분할도

> **표기**: 기존 법인세 모듈은 `M`+번호, 개인사업자 전용 모듈은 `P`+번호  
> **세목 분기**: `[CORP]` = 법인 전용, `[INC]` = 개인 전용, 무표기 = 공통

```
[Lv0] 통합 경정청구 환급액 산출 시스템 v1.1
│
├─[Lv1] M0. 세목 분기 (TAX_TYPE 결정) ──────────────────────────────────
│  ├─[Lv2] M0-01 납세자 유형 선택 (CORP / INC)
│  └─[Lv2] M0-02 세목별 모듈·테이블·기준정보 활성화 제어
│
├─[Lv1] M1. 입력 관리 ──────────────────────────────────────────────────
│  ├─── [공통] ──────────────────────────────────
│  ├─[Lv2] M1-01 기본 정보 입력 (법인/개인 분기)
│  ├─[Lv2] M1-03 상시근로자 상세 명부 입력
│  ├─[Lv2] M1-04 투자 자산 명세 입력
│  ├─[Lv2] M1-05 창업/감면 관련 정보 입력
│  ├─[Lv2] M1-06 R&D 비용 상세 입력
│  ├─[Lv2] M1-08 이월세액공제 상세 입력
│  ├─[Lv2] M1-09 기존 신고 공제·감면 상세
│  │
│  ├─── [CORP 전용] ──────────────────────────────
│  ├─[Lv2] M1-02 대표자/임원/가족 정보 입력
│  ├─[Lv2] M1-07 이월결손금 상세 입력
│  ├─[Lv2] M1-10 지점 소재지 정보 입력
│  ├─[Lv2] M1-11 중간예납 상세 입력
│  ├─[Lv2] M1-12 수입배당금 명세 입력
│  │
│  ├─── [INC 전용] ★ 신규 ──────────────────────────
│  ├─[Lv2] P1-01 개인사업자 기본 정보 입력 (TBL_INC_BASIC)
│  │  ├─[Lv3] 대표자 인적사항 (생년월일, 병역이행기간)
│  │  ├─[Lv3] 사업자 유형 (소기업/중기업)
│  │  ├─[Lv3] 기장 방식 (복식부기/간편장부/추계)
│  │  ├─[Lv3] 성실신고확인대상 여부
│  │  └─[Lv3] 공동사업자 여부 + 손익분배비율
│  ├─[Lv2] P1-02 사업장별 상세 정보 입력 (TBL_INC_BUSINESS)
│  │  ├─[Lv3] 사업장명/사업자등록번호/업종(KSIC)
│  │  ├─[Lv3] 소재지 (시군구 → 수도권 구분, 인구감소지역 여부)
│  │  ├─[Lv3] 수입금액/사업소득금액
│  │  ├─[Lv3] 상시근로자 수 (직전/해당, 청년등/일반)
│  │  ├─[Lv3] 4대보험 사업주 부담 납부액
│  │  └─[Lv3] 창업일/벤처확인일/연구전담부서 여부
│  ├─[Lv2] P1-03 종합소득 합산 정보 입력 (TBL_INC_OTHER_INCOME)
│  │  ├─[Lv3] 근로소득 금액
│  │  ├─[Lv3] 이자·배당소득 (2천만 초과 여부 → 종합과세 판단)
│  │  ├─[Lv3] 연금소득 / 기타소득
│  │  └─[Lv3] 분리과세 소득 여부 (금융소득 2천만 이하, 주택임대 등)
│  ├─[Lv2] P1-04 소득공제 정보 입력 (TBL_INC_DEDUCTION)
│  │  ├─[Lv3] 인적공제 (본인·배우자·부양가족)
│  │  ├─[Lv3] 국민연금보험료 / 건강보험료 (가입유형별 구분)
│  │  ├─[Lv3] 노란우산공제 불입액
│  │  ├─[Lv3] 주택자금공제 / 기부금 소득공제
│  │  └─[Lv3] 표준세액공제 (7만원, 성실 12만원)
│  ├─[Lv2] P1-05 성실신고확인 관련 입력 (TBL_INC_SINCERITY)
│  ├─[Lv2] P1-06 개인 외국납부세액 입력 (TBL_INC_FOREIGN_TAX)
│  ├─[Lv2] P1-07 착한 임대인 세액공제 입력 (TBL_INC_RENTAL_REDUCTION)
│  └─[Lv2] P1-08 공동사업자 정보 입력 (TBL_INC_JOINT_BIZ)
│
├─[Lv1] M2. 기준정보 관리 ── (기존 법인 M2-01~09 유지 + 아래 추가) ──
│  ├─[Lv2] M2-10 소득세율 관리 [INC] (REF_INC_TAX_RATE) ★ 신규
│  ├─[Lv2] M2-11 개인 최저한세율 관리 [INC] (REF_INC_MIN_TAX) ★ 신규
│  ├─[Lv2] M2-12 소득공제 한도 관리 [INC] (REF_INC_DEDUCTION_LIMIT) ★ 신규
│  └─[Lv2] M2-13 성실신고확인 기준 관리 [INC] (REF_INC_SINCERITY_THRESHOLD) ★ 신규
│
├─[Lv1] M3. 사전 점검 / 검증 ── (기존 M3-00~06 유지 + 세목 분기) ──
│  ├─[Lv2] M3-00 경정청구 불가 사유 사전 검증 (세목 분기)
│  │  ├─[Lv3] [공통] 법정신고기한 후 5년 경과 여부
│  │  ├─[Lv3] [CORP] 분식회계/직권경정/결산조정 사전 차단
│  │  │  └─[Lv4] ★v1.1 결산조정 항목 Hard Fail 필터 (감가상각비·퇴직급여충당금·대손충당금)
│  │  │     ├ 경정청구 신청 항목에 결산조정 항목 포함 여부 자동 스캔
│  │  │     ├ 포함 시 → Hard Fail (국세청 거부 리스크 원천 차단)
│  │  │     ├ 워닝: "결산서 변경 불가 — 결산확정의 원칙(법인세법 §40) 위반"
│  │  │     └ 대안 안내: "신고조정 가능 항목으로 환급 전략 전환 필요"
│  │  └─[Lv3] [INC] 추계신고 사업자 감면 배제 확인 (조특법 §128)
│  ├─[Lv2] M3-01 경정청구 기한 점검 (세목 분기)
│  │  ├─[Lv3] [CORP] 사업연도종료+3개월 → +5년
│  │  └─[Lv3] [INC] P3-02 종합소득세 기한 (5.31/6.30 기산) ★ 신규
│  │     ├─[Lv4] ★v1.1 성실신고확인대상 자동 판정 로직
│  │     │  ├ TBL_INC_BUSINESS.업종코드 + 수입금액합계 → REF_INC_SINCERITY_THRESHOLD 대조
│  │     │  ├ 판정: 도소매 15억, 제조·건설 7.5억, 서비스 5억 이상 시 → 대상
│  │     │  ├ 대상=TRUE → 신고기한 6.30, P4-04(의료비·교육비) 활성화, P4-05(확인비용) 활성화
│  │     │  └ 대상=FALSE → 신고기한 5.31, P4-04·P4-05 비활성화
│  │     └─[Lv4] TBL_INC_BASIC.is_sincerity_target 자동 갱신 (수동입력 의존 제거)
│  ├─[Lv2] M3-02 중소기업 해당 여부 (세목 분기)
│  │  └─[Lv3] [INC] 다사업장 매출 합산 기준 판단
│  ├─[Lv2] M3-03 소재지 구분 판단 (세목 분기) ★ 핵심 차이
│  │  ├─[Lv3] [CORP] 본점 간주 규정 (기존 유지)
│  │  └─[Lv3] [INC] P3-01 사업장별 개별 판단 ★ 신규
│  │     ├ 사업장 A → 수도권/비수도권
│  │     ├ 사업장 B → 수도권/비수도권 (개별)
│  │     └ 인구감소지역 여부 (사업장별)
│  ├─[Lv2] M3-04 상시근로자 수 산정 (세목 분기)
│  │  ├─[Lv3] [CORP] 임원·최대주주 친족 제외
│  │  └─[Lv3] [INC] 대표자 본인·배우자·직계존비속 제외
│  │
│  ├─[Lv2] P3-03 종합소득금액 산정 [INC] ★ 신규
│  │  ├─[Lv3] 사업장별 사업소득 합산
│  │  ├─[Lv3] 사업소득 외 소득 합산 (근로·이자·배당·연금·기타)
│  │  ├─[Lv3] 비과세·분리과세 소득 제외 (★ 금융소득 2천만 초과 여부)
│  │  └─[Lv3] 공동사업자: 손익분배비율 적용 배분
│  └─[Lv2] P3-04 소득공제 적용·과세표준 산출 [INC] ★ 신규
│     ├─[Lv3] 인적공제 → 국민연금 → 건강보험(유형별) → 노란우산 → 기타
│     ├─[Lv3] 과세표준 확정 → 적용 세율구간 결정
│     └─[Lv3] 산출세액 계산 (초과누진세율 6~45%)
│
├─[Lv1] M4. 개별 공제·감면 산출 ─────────────────────────────────────
│  │
│  ├─── [공통 세액감면·공제] (기존 M4-01~06 유지, 세목 분기 추가) ──
│  ├─[Lv2] M4-04 창업중소기업 세액감면 (§6)
│  │  └─[Lv3] [INC] 감면세액 = 산출세액 × (감면대상소득÷종합소득금액) × 감면율
│  │     ├ 개인 창업일 = 개업일 (사업자등록증)
│  │     ├ 다사업장: 사업장별 감면 대상 판단
│  │     └ 재창업 리스크: 동일 업종(세분류) 폐업 이력 확인 ★
│  ├─[Lv2] M4-05 중소기업 특별세액감면 (§7)
│  │  └─[Lv3] [INC] 사업장별 감면율 차등 + 소득배분 공식
│  │     ├ 사업장 A(비수도권 30%) + 사업장 B(수도권 5%) 등 개별 계산
│  │     └ 감면한도 1억원 = 합산 기준
│  ├─[Lv2] M4-02 통합고용세액공제 (§29의8)
│  │  └─[Lv3] [INC] 다사업장 합산, 대표자 제외, 군복무 차감
│  ├─[Lv2] M4-01 통합투자세액공제 (§24)
│  │  └─[Lv3] [INC] 사업장별 소재지 개별 판단 (본점간주 X)
│  ├─[Lv2] M4-06 연구인력개발비 세액공제 (§10)
│  │  └─[Lv3] [INC] 개인도 KOITA 연구전담부서 신고 가능
│  ├─[Lv2] M4-03 사회보험료세액공제 (§30의4)
│  │  └─[Lv3] [INC] 사업장별 4대보험 납부액 확인
│  │
│  ├─── [CORP 전용] (기존 유지) ───────────────────────
│  ├─[Lv2] M4-07 외국납부세액공제 [CORP] (법인세법 §57)
│  ├─[Lv2] M4-08 이월결손금 재검토 [CORP]
│  ├─[Lv2] M4-09 수입배당금 익금불산입 [CORP]
│  │  └─[Lv3] ★v1.1 연도별 적용기준 매칭 강화
│  │     ├ [2023.1.1 이후] 지분율 3단계: 50%↑→100%, 30~50%→80%, 30%↓→30%
│  │     ├ [2022.12.31 이전] 상장/비상장/지주회사별 4~5단계 구분
│  │     ├ 경과규정: 2023~2024년 배당분은 종전 규정 적용도 허용
│  │     └ 지분 변동 미반영 → 과세표준 변동 → 환급 사유 (법인세법 §18의2)
│  ├─[Lv2] M4-10 결손금 소급공제 [CORP] (법인세법 §72)
│  ├─[Lv2] M4-11 세무조정 재검토 [CORP]
│  │  └─[Lv3] ★v1.1 M4-11a 업무용 승용차 비용 재산출 (신설)
│  │     ├ 입력: 운행기록부 유무, 임직원 전용보험 가입여부, 감가상각비, 처분손실
│  │     ├ ① 임직원 전용보험 미가입 → 전액 손금불산입 (경정 불가 안내)
│  │     ├ ② 운행기록부 미작성 → 연 1,500만원 한도 (감가800+유지700)
│  │     ├ ③ 감가상각비 한도 초과분(연 800만) → 손금불산입(유보)
│  │     ├ ④ 처분손실 한도 초과분(연 800만) → 손금불산입(기타사외유출/유보)
│  │     ├ ⑤ 운행기록부 소급 확보 시 업무사용비율 재산정 → 환입 로직
│  │     └ 근거: 법인세법 §27의2, 시행령 §50의2
│  ├─[Lv2] M4-12 토지등 양도세 추가과세 [CORP]
│  ├─[Lv2] M4-13 기업구조조정 과세이연 [CORP]
│  ├─[Lv2] M4-14 연결납세 특화 점검 [CORP]
│  ├─[Lv2] M4-15 재해손실세액공제 [CORP] (법인세법 §58)
│  └─[Lv2] M42  감가상각 시부인 이월 추인 [CORP]
│  │
│  ├─── [INC 전용] ★ 신규 ────────────────────────
│  ├─[Lv2] P4-01 소득공제 누락 점검·세율구간 최적화 ★
│  │  ├─[Lv3] P4-01a 인적공제 누락 확인 (부양가족 변동)
│  │  ├─[Lv3] P4-01b 국민연금/건강보험료 구분 확인 (지역/직장)
│  │  │  └─[Lv4] ★v1.1 건강보험료 3분류 분기 로직 (프롬프트 ㉖규칙 반영)
│  │  │     ├ 유형1: 지역가입자 건강보험료 → TBL_INC_DEDUCTION → 소득공제
│  │  │     ├ 유형2: 직장가입자(사업주) 본인 부담분 → TBL_INC_DEDUCTION → 소득공제
│  │  │     │  (★ 사업소득 필요경비 아님 — 사업과 직접 관련 비용이 아닌 개인 부담)
│  │  │     ├ 유형3: 사업장 근로자용 사업주 부담 4대보험료 → TBL_INC_BUSINESS → 필요경비
│  │  │     │  (★ 필요경비 산입 → 사업소득금액 감소 → 과세표준·세율구간 변동 가능)
│  │  │     ├ 겸업자(근로+사업): 직장건강보험료 = 근로소득 관련 → 사업소득 필요경비 무관
│  │  │     └ 누락분 점검 → 소득공제/필요경비 중 유리한 방식 선택 안내
│  │  ├─[Lv3] P4-01c 노란우산공제 누락 확인
│  │  ├─[Lv3] P4-01d 과세표준 재산정 → 세율구간 변동 확인
│  │  └─[Lv3] P4-01e 산출세액 재계산 → 감면·공제 전략 재수립
│  ├─[Lv2] P4-02 감면 소득 배분 계산 (다사업장/겸업) ★
│  │  ├─[Lv3] P4-02a 사업장별 감면 대상 소득 확정
│  │  ├─[Lv3] P4-02b 종합소득금액 분모 산정 (분리과세 제외)
│  │  ├─[Lv3] P4-02c 감면세액 = 산출세액 × (감면소득÷종합소득) × 감면율
│  │  └─[Lv3] P4-02d 사업장별 개별 계산 후 합산
│  ├─[Lv2] P4-03 공동사업자 소득 배분 ★
│  │  ├─[Lv3] P4-03a 전체 사업소득 × 본인 지분율 = 본인 소득
│  │  ├─[Lv3] P4-03b 감면세액도 지분율에 따라 배분
│  │  └─[Lv3] P4-03c 고용공제 = 전체 근로자 기준 판단 → 공제액만 배분
│  ├─[Lv2] P4-04 성실사업자 의료비·교육비 세액공제 (§122의3) ★
│  │  ├─[Lv3] 성실신고확인대상 여부 확인
│  │  ├─[Lv3] 의료비 15% + 교육비 15% 공제
│  │  └─[Lv3] ★★ 최저한세 적용 대상 아님 (별도 전액 적용)
│  ├─[Lv2] P4-05 성실신고확인비용 세액공제 (§126의6) ★
│  │  ├─[Lv3] 확인비용의 60%, 연 120만원 한도
│  │  └─[Lv3] ★★ 최저한세 적용 대상 ○ (P4-04와 구분 필수)
│  ├─[Lv2] P4-06 기장세액공제 (소득세법 §56의2) ★
│  │  ├─[Lv3] 산출세액의 20%, 100만원 한도
│  │  ├─[Lv3] 간편장부대상자가 복식부기 기장 시에도 적용
│  │  └─[Lv3] ★★ 조특법 §127 중복배제 비대상 → 모든 감면과 병행 가능
│  ├─[Lv2] P4-07 개인 외국납부세액공제 (소득세법 §57) ★
│  │  ├─[Lv3] 세액공제 vs 필요경비 산입 비교
│  │  ├─[Lv3] 공제한도 = 산출세액 × (국외소득÷종합소득금액)
│  │  └─[Lv3] 최저한세 비대상 (소득세법상 공제)
│  ├─[Lv2] P4-08 착한 임대인 세액공제 (§96의3) ★
│  │  ├─[Lv3] 임대료 인하액의 50~70%
│  │  └─[Lv3] 최저한세 적용 대상
│  ├─[Lv2] P4-09 결손금 소급공제 [INC] (소득세법 §85의2) ★
│  │  ├─[Lv3] 중소기업만 적용
│  │  ├─[Lv3] 환급세액 = 직전연도 산출세액 × (소급결손금÷직전 과세표준)
│  │  └─[Lv3] 이월공제 vs 소급공제 NPV 비교
│  ├─[Lv2] P4-10 자녀세액공제 (소득세법 §59의2) ★
│  ├─[Lv2] P4-11 연금저축 세액공제 (소득세법 §59의3) ★
│  ├─[Lv2] P4-12 전자신고 세액공제 (§104의8) ★
│  ├─[Lv2] P4-13 재해손실세액공제 [INC] (소득세법 §58) ★
│  └─[Lv2] P4-14 벤처투자조합 출자 소득공제 (§16) ★
│
├─[Lv1] M5. 최적 조합 산출 ── (세목 분기 추가) ────────────────────
│  ├─[Lv2] M5-01 상호배제 규칙 검증 (공통)
│  ├─[Lv2] M5-02 최적 조합 탐색 (공통)
│  │  └─[Lv3] [INC] 개인 전용 공제(P4-04~14) 포함 탐색
│  ├─[Lv2] M5-03 최저한세 적용 (세목 분기) ★ 핵심 차이
│  │  ├─[Lv3] [CORP] 과세표준 × 최저한세율 (기존 유지)
│  │  └─[Lv3] [INC] P5-01 산출세액 × 35%/45% ★ 신규
│  │     ├ 산출세액 3천만 이하분: ×35%
│  │     ├ 산출세액 3천만 초과분: ×45%
│  │     ├ 성실신고확인비용(§126의6) → 최저한세 대상 ○
│  │     ├ 성실사업자 의료비·교육비(§122의3) → 최저한세 비대상 ✕
│  │     └ 기장세액공제(§56의2) → 최저한세 비대상 (소득세법)
│  ├─[Lv2] M5-04 농특세 적용 (공통)
│  └─[Lv2] M5-05 세액 적용순서 처리 (세목 분기)
│     ├─[Lv3] [CORP] 법인세법 §59
│     └─[Lv3] [INC] 소득세법 §60
│
├─[Lv1] M6. 최종 환급액 산출 및 보고 ── (세목 분기 추가) ─────────────
│  ├─[Lv2] M6-01 환급액 비교표 생성 (세목 분기)
│  │  └─[Lv3] [INC] 기존 산출세액/결정세액 + 중간예납+원천징수+분납 반영
│  ├─[Lv2] M6-02 환급가산금 산출 (공통)
│  ├─[Lv2] M6-03 지방소득세 환급 안내 (세목 분기)
│  │  └─[Lv3] [INC] 고정 양식: "종합소득세 환급액 ○○원 + 지방소득세 ○○원(10%) = 총 ○○원"
│  └─[Lv2] M6-04 최종 보고서 생성 (세목별 3종)
│     ├─[Lv3] ★v1.1 보고서 4부 구조 (3차 보완)
│     │  ├ 제1부: 환급 요약표 — 항목별 실질 환급액 (농특세 20% 차감 후)
│     │  ├ 제2부: 최저한세 분석 — [CORP] 과세표준×7~17% / [INC] 산출세액×35/45%
│     │  ├ 제3부: 지방소득세 안내 — 고정양식 "국세환급 ○원 + 지방소득세(10%) ○원 = 총 ○원"
│     │  └ 제4부: 사후관리 경고 — 고용유지의무 위반 시 인당 추징 예상액 (이자상당가산액 포함)
│     ├─[Lv3] [INC] 소득공제 반영 전후 산출세액 변동 포함
│     ├─[Lv3] [INC] 다사업장 소득 배분 비율 계산 포함
│     └─[Lv3] [INC] 결손금 소급공제 추가 환급액 별도 표기
│
├─[Lv1] M7. 시뮬레이션 ── (기존 유지 + INC 확장) ─────────────────────
│  ├─[Lv2] M7-03 사후관리 리스크 분석 (기능 강화) ★v1.1
│  │  ├─[Lv3] 고용 유지 의무(2년) 위반 시 인당 추징 예상액 수치화
│  │  └─[Lv3] ★v1.1 이자상당가산액 포함 추징액 산출 (F-COM-01 계산식 연동)
│  │     ├ 본세 추징액 = 감소인원 × 인당 공제액
│  │     ├ 이자상당가산액 = 본세 × (경과일수/365) × 이율(연 8.03% 등)
│  │     ├ 총 추징액 = 본세 + 이자상당가산액
│  │     └ 경정청구 시점 기준 2년 내 인원 감소 시나리오별 예상 추징액 테이블 생성
│  └─[Lv2] M7-04 [INC] 소득공제 시나리오 비교 ★ 신규
│     └─[Lv3] 소득공제 조합별 과세표준·세율구간·산출세액 변동 시뮬레이션
│
└─[Lv1] MX. 횡단 기능 ── (기존 MX-01~05 유지) ────────────────────────
   └─[Lv2] MX-06 세목 분기 엔진 ★ 신규
      └─[Lv3] TAX_TYPE에 따라 모듈·테이블·기준정보·검증규칙 자동 활성화/비활성화
```

---

## 3. 테이블 설계 — 공통 입력 테이블

> 법인세 v4.0r1의 기존 테이블(TBL_CORP_BASIC ~ TBL_TAX_ADJUSTMENT)은 전량 승계.  
> 세목 분기를 위해 각 테이블에 `tax_type VARCHAR(4) DEFAULT 'CORP'` 컬럼 추가.  
> 상세 스키마는 [부록 — 법인세 v4.0r1 승계 내역] 참조.

---

## 4. 테이블 설계 — 개인사업자 전용 입력 테이블

### 4.1 TBL_INC_BASIC — 개인사업자 기본 정보

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | taxpayer_id | 납세자ID | VARCHAR(20) | Y | PK |
| 2 | tax_type | 세목구분 | VARCHAR(4) | Y | 'INC' 고정 |
| 3 | taxpayer_name | 사업자명 | VARCHAR(50) | Y | 대표자 성명 |
| 4 | birth_date | 생년월일 | DATE | Y | 청년 판단, 연령 공제 |
| 5 | gender | 성별 | VARCHAR(2) | Y | 병역가산 적용 여부 |
| 6 | military_start | 병역시작일 | DATE | N | |
| 7 | military_end | 병역종료일 | DATE | N | |
| 8 | military_months | 실제복무개월수 | INT | N | 병적증명서 기준 |
| 9 | biz_scale | 기업규모 | VARCHAR(10) | Y | 'SMALL'(소기업)/'MEDIUM'(중기업) |
| 10 | biz_count | 사업장수 | INT | Y | 1 이상 |
| 11 | is_joint_biz | 공동사업자여부 | BOOLEAN | Y | |
| 12 | bookkeeping_type | 기장방식 | VARCHAR(20) | Y | 'DOUBLE'(복식부기)/'SIMPLE'(간편장부)/'ESTIMATED'(추계) |
| 13 | is_sincerity_target | 성실신고확인대상 | BOOLEAN | Y | 소득세법 §70의2 |
| 14 | claim_tax_year | 경정청구대상과세연도 | VARCHAR(4) | Y | YYYY |
| 15 | claim_reason | 경정청구사유 | VARCHAR(200) | Y | |
| 16 | computed_tax | 산출세액 | BIGINT | Y | 기존 신고 산출세액 |
| 17 | taxable_base | 과세표준 | BIGINT | Y | 기존 신고 과세표준 |
| 18 | determined_tax | 결정세액 | BIGINT | Y | 기존 신고 결정세액 |
| 19 | paid_tax_total | 총납부세액 | BIGINT | Y | 중간예납+확정신고+분납 |
| 20 | interim_prepaid | 중간예납세액 | BIGINT | N | 11월 기납부 |
| 21 | withholding_tax | 원천징수세액 | BIGINT | N | 사업소득 3.3% 등 |
| 22 | installment_tax | 분납세액 | BIGINT | N | 소득세법 §77 |
| 23 | existing_deductions | 기존적용공제감면 | TEXT | N | JSON 형태 |
| 24 | amendment_history | 수정신고경정이력 | TEXT | N | JSON 형태 |
| 25 | prior_biz_history | 과거사업이력 | TEXT | N | 동일 업종 폐업 이력 (창업감면 판단) |
| 26 | next_year_loss_yn | 차기연도결손여부 | BOOLEAN | N | 소급공제 검토용 |
| 27 | next_year_loss_amt | 차기연도결손금액 | BIGINT | N | |
| 28 | has_foreign_tax | 외국납부세액유무 | BOOLEAN | N | |
| 29 | has_rental_reduction | 임대료인하여부 | BOOLEAN | N | 착한 임대인 |
| 30 | has_separated_income | 분리과세소득여부 | BOOLEAN | N | 금융소득 2천만 이하 등 |
| 31 | separated_income_amt | 분리과세소득금액 | BIGINT | N | 종합소득금액에서 제외 |

### 4.2 TBL_INC_BUSINESS — 사업장별 상세 정보

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | taxpayer_id | 납세자ID | VARCHAR(20) | Y | FK → TBL_INC_BASIC |
| 2 | biz_id | 사업장ID | VARCHAR(20) | Y | PK |
| 3 | biz_name | 사업장명 | VARCHAR(100) | Y | |
| 4 | biz_reg_no | 사업자등록번호 | VARCHAR(12) | Y | |
| 5 | industry_code | 업종코드(KSIC) | VARCHAR(10) | Y | |
| 6 | industry_name | 업종명 | VARCHAR(100) | Y | |
| 7 | address | 소재지 | VARCHAR(200) | Y | 시군구 단위 |
| 8 | capital_zone | 수도권구분 | VARCHAR(20) | Y | 과밀억제/성장관리/자연보전/비수도권 |
| 9 | is_depopulation | 인구감소지역여부 | BOOLEAN | N | 행안부 고시 기준 |
| 10 | revenue | 수입금액 | BIGINT | Y | 해당 과세연도 매출액 |
| 11 | biz_income | 사업소득금액 | BIGINT | Y | |
| 12 | emp_prior_total | 직전상시근로자수 | DECIMAL(10,2) | N | |
| 13 | emp_prior_youth | 직전청년등수 | DECIMAL(10,2) | N | |
| 14 | emp_current_total | 해당상시근로자수 | DECIMAL(10,2) | N | |
| 15 | emp_current_youth | 해당청년등수 | DECIMAL(10,2) | N | |
| 16 | social_insurance_paid | 4대보험사업주납부액 | BIGINT | N | |
| 17 | founding_date | 창업일 | DATE | N | 사업자등록증 개업일 |
| 18 | venture_yn | 벤처확인여부 | BOOLEAN | N | |
| 19 | venture_date | 벤처확인일 | DATE | N | |
| 20 | has_rd_dept | 연구전담부서여부 | BOOLEAN | N | KOITA 신고 |
| 21 | is_exempt_eligible | 감면대상업종여부 | BOOLEAN | N | §6, §7 업종 확인 |
| 22 | exemption_rate_7 | 제7조감면율 | DECIMAL(5,2) | N | 소재지·규모별 |
| 23 | first_income_year | 최초소득발생연도 | VARCHAR(4) | N | 창업감면 기간 기산 |

### 4.3 TBL_INC_OTHER_INCOME — 사업소득 외 합산소득

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | taxpayer_id | 납세자ID | VARCHAR(20) | Y | FK, PK |
| 2 | employment_income | 근로소득금액 | BIGINT | N | |
| 3 | interest_income | 이자소득금액 | BIGINT | N | |
| 4 | dividend_income | 배당소득금액 | BIGINT | N | |
| 5 | financial_income_total | 금융소득합계 | BIGINT | N | 2천만 초과 여부 판단 |
| 6 | is_financial_over_20m | 금융소득2천만초과 | BOOLEAN | N | TRUE → 종합과세 |
| 7 | pension_income | 연금소득금액 | BIGINT | N | |
| 8 | other_income | 기타소득금액 | BIGINT | N | |
| 9 | separated_financial | 분리과세금융소득 | BIGINT | N | 2천만 이하분 |
| 10 | separated_rental | 분리과세주택임대 | BIGINT | N | |

### 4.4 TBL_INC_DEDUCTION — 소득공제 항목

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | taxpayer_id | 납세자ID | VARCHAR(20) | Y | FK, PK |
| 2 | personal_deduction | 인적공제총액 | BIGINT | Y | 본인+배우자+부양가족 |
| 3 | dependent_count | 부양가족수 | INT | N | |
| 4 | pension_premium | 국민연금보험료 | BIGINT | N | |
| 5 | health_insurance | 건강보험료 | BIGINT | N | |
| 6 | health_type | 건강보험가입유형 | VARCHAR(10) | N | 'LOCAL'(지역)/'EMPLOYED'(직장) |
| 7 | employment_insurance | 고용보험료 | BIGINT | N | |
| 8 | noran_umbrella | 노란우산공제불입액 | BIGINT | N | |
| 9 | noran_deduction | 노란우산공제한도 | BIGINT | N | 소득구간별 200~500만 |
| 10 | housing_fund | 주택자금공제 | BIGINT | N | |
| 11 | donation | 기부금공제 | BIGINT | N | |
| 12 | standard_deduction | 표준세액공제 | BIGINT | N | 7만원 / 성실 12만원 |
| 13 | pension_saving | 연금저축납입액 | BIGINT | N | |
| 14 | irp_contribution | IRP납입액 | BIGINT | N | |
| 15 | pension_saving_credit | 연금저축세액공제 | BIGINT | N | 산출: 15%/12% |
| 16 | child_count_basic | 자녀기본공제인원 | INT | N | 7세 이상 |
| 17 | child_credit | 자녀세액공제액 | BIGINT | N | |
| 18 | total_deduction | 소득공제합계 | BIGINT | N | 산출값 |

### 4.5 TBL_INC_SINCERITY — 성실신고확인 관련

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | taxpayer_id | 납세자ID | VARCHAR(20) | Y | FK, PK |
| 2 | confirmation_cost | 확인비용지급액 | BIGINT | N | 세무사 지급액 |
| 3 | confirmation_credit | 확인비용세액공제 | BIGINT | N | 60%, 120만 한도 |
| 4 | medical_expense | 의료비지급액 | BIGINT | N | |
| 5 | medical_credit | 의료비세액공제 | BIGINT | N | 15% |
| 6 | education_expense | 교육비지급액 | BIGINT | N | |
| 7 | education_credit | 교육비세액공제 | BIGINT | N | 15% |

### 4.6 TBL_INC_FOREIGN_TAX — 개인 외국납부세액

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | taxpayer_id | 납세자ID | VARCHAR(20) | Y | FK |
| 2 | seq | 순번 | INT | Y | PK |
| 3 | country | 국가 | VARCHAR(50) | Y | |
| 4 | income_type | 소득종류 | VARCHAR(50) | Y | 앱스토어/유튜브/무역 등 |
| 5 | foreign_income | 외국원천소득 | BIGINT | Y | 원화 환산 |
| 6 | foreign_tax_paid | 외국납부세액 | BIGINT | Y | 원화 환산 |
| 7 | preferred_method | 선택방식 | VARCHAR(20) | N | 'CREDIT'(세액공제)/'EXPENSE'(필요경비) |

### 4.7 TBL_INC_RENTAL_REDUCTION — 착한 임대인

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | taxpayer_id | 납세자ID | VARCHAR(20) | Y | FK |
| 2 | seq | 순번 | INT | Y | PK |
| 3 | tenant_name | 임차인명 | VARCHAR(50) | Y | |
| 4 | is_small_biz | 소상공인여부 | BOOLEAN | Y | |
| 5 | reduction_period_start | 인하시작일 | DATE | Y | |
| 6 | reduction_period_end | 인하종료일 | DATE | Y | |
| 7 | original_rent | 기존임대료 | BIGINT | Y | 월액 |
| 8 | reduced_rent | 인하후임대료 | BIGINT | Y | 월액 |
| 9 | reduction_amount | 인하총액 | BIGINT | Y | 기간 전체 |

### 4.8 TBL_INC_JOINT_BIZ — 공동사업자 정보

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | taxpayer_id | 납세자ID | VARCHAR(20) | Y | FK |
| 2 | joint_biz_name | 공동사업장명 | VARCHAR(100) | Y | |
| 3 | profit_share_ratio | 손익분배비율 | DECIMAL(5,2) | Y | % (본인 지분) |
| 4 | total_biz_income | 공동사업장전체소득 | BIGINT | Y | |
| 5 | my_share_income | 본인지분소득 | BIGINT | Y | = 전체 × 비율 |

---

## 5. 테이블 설계 — 기준정보 테이블 (개인 전용 추가분)

> 법인세 기준정보 테이블(REF_CORP_TAX_RATE_HISTORY ~ REF_KSIC_CODE)은 전량 승계.

### 5.1 REF_INC_TAX_RATE — 소득세율 (과세연도별)

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | effective_from | 적용시작연도 | VARCHAR(4) | Y | PK |
| 2 | bracket_no | 구간번호 | INT | Y | PK (1~8) |
| 3 | lower_limit | 하한 | BIGINT | Y | 원 |
| 4 | upper_limit | 상한 | BIGINT | Y | 원 (최고구간: MAX_BIGINT) |
| 5 | tax_rate | 세율 | DECIMAL(5,2) | Y | % |
| 6 | progressive_deduction | 누진공제액 | BIGINT | Y | 원 |

**초기 데이터 (2023년~)**:

| 구간 | 하한 | 상한 | 세율 | 누진공제 |
|------|------|------|------|---------|
| 1 | 0 | 14,000,000 | 6% | 0 |
| 2 | 14,000,001 | 50,000,000 | 15% | 1,260,000 |
| 3 | 50,000,001 | 88,000,000 | 24% | 5,760,000 |
| 4 | 88,000,001 | 150,000,000 | 35% | 15,440,000 |
| 5 | 150,000,001 | 300,000,000 | 38% | 19,940,000 |
| 6 | 300,000,001 | 500,000,000 | 40% | 25,940,000 |
| 7 | 500,000,001 | 1,000,000,000 | 42% | 35,940,000 |
| 8 | 1,000,000,001 | MAX | 45% | 65,940,000 |

### 5.2 REF_INC_MIN_TAX — 개인 최저한세율

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | effective_from | 적용시작연도 | VARCHAR(4) | Y | PK |
| 2 | threshold | 산출세액기준 | BIGINT | Y | 3천만원 |
| 3 | rate_below | 이하세율 | DECIMAL(5,2) | Y | 35% |
| 4 | rate_above | 초과세율 | DECIMAL(5,2) | Y | 45% |

### 5.3 REF_INC_DEDUCTION_LIMIT — 소득공제 한도

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | deduction_type | 공제항목 | VARCHAR(50) | Y | PK |
| 2 | income_bracket | 소득구간 | VARCHAR(50) | Y | PK |
| 3 | annual_limit | 연간한도 | BIGINT | Y | 원 |

### 5.4 REF_INC_SINCERITY_THRESHOLD — 성실신고확인 수입금액 기준

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | industry_group | 업종군 | VARCHAR(50) | Y | PK |
| 2 | effective_from | 적용시작연도 | VARCHAR(4) | Y | PK |
| 3 | revenue_threshold | 수입금액기준 | BIGINT | Y | 초과 시 해당 |

---

## 6. 테이블 설계 — 출력(산출) 테이블 (개인 전용 추가분)

> 법인세 출력 테이블(OUT_*)은 전량 승계.

### 6.1 OUT_INC_INCOME_ALLOCATION — 다사업장 소득 배분 결과

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | taxpayer_id | 납세자ID | VARCHAR(20) | FK |
| 2 | biz_id | 사업장ID | VARCHAR(20) | FK |
| 3 | biz_income | 사업소득금액 | BIGINT | |
| 4 | total_comprehensive | 종합소득금액 | BIGINT | 분리과세 제외 후 |
| 5 | income_ratio | 소득배분비율 | DECIMAL(5,4) | = biz_income ÷ total_comprehensive |
| 6 | exemption_type | 감면종류 | VARCHAR(20) | §6 / §7 |
| 7 | exemption_rate | 감면율 | DECIMAL(5,2) | |
| 8 | exemption_amount | 감면세액 | BIGINT | = 산출세액 × ratio × rate |

### 6.2 OUT_INC_DEDUCTION_IMPACT — 소득공제 영향 분석

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | taxpayer_id | 납세자ID | VARCHAR(20) | FK |
| 2 | scenario | 시나리오 | VARCHAR(50) | BEFORE/AFTER |
| 3 | taxable_base | 과세표준 | BIGINT | |
| 4 | tax_bracket | 적용세율구간 | DECIMAL(5,2) | % |
| 5 | computed_tax | 산출세액 | BIGINT | |
| 6 | deduction_added | 추가소득공제 | BIGINT | |
| 7 | tax_difference | 세액차이 | BIGINT | |

### 6.3 OUT_INC_LOCAL_TAX — 지방소득세 환급

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | taxpayer_id | 납세자ID | VARCHAR(20) | FK |
| 2 | national_refund | 종합소득세환급액 | BIGINT | |
| 3 | local_refund | 지방소득세환급액 | BIGINT | = 국세 × 10% |
| 4 | total_refund | 총실질환급액 | BIGINT | = 국세 + 지방 |

---

## 7. 단계별 업무처리 절차서 — 종합소득세 (INC) 전용

> 법인세 STEP 0~5는 기존 유지. 아래는 TAX_TYPE='INC'일 때의 분기 처리.

### STEP 0: 사전 점검 (INC 분기)

| 단계 | 처리 | 모듈 | 핵심 차이 |
|------|------|------|----------|
| 0-1 | 경정청구 기한 산정 | P3-02 | 법정신고기한 = 5.31 (성실: 6.30) → +5년 |
| 0-2 | 추계신고 여부 확인 | M3-00 | 추계 → 감면·공제 대부분 배제 |
| 0-3 | 중소기업 판단 | M3-02 | 다사업장 매출 합산 기준 |
| 0-4 | 소재지 판단 | P3-01 | ★ 사업장별 개별 판단 (본점간주 없음) |
| 0-5 | 상시근로자 산정 | M3-04 | ★ 대표자·배우자·직계존비속 제외 |
| 0-6 | 종합소득금액 산정 | P3-03 | 사업소득 + 기타소득 합산, 분리과세 제외 |
| 0-7 | 소득공제 적용 | P3-04 | 인적→연금→보험→노란우산 등 순서 |
| 0-8 | 과세표준·산출세액 | P3-04 | 초과누진세율 6~45% 적용 |

### STEP 1: 환급극대화 전략 수립 (INC 분기)

| 단계 | 처리 | 모듈 | 핵심 차이 |
|------|------|------|----------|
| 1-1 | 그룹 A(감면중심) 구성 | M5-02 | 감면세액 = 산출세액 × (감면소득÷종합소득) × 감면율 |
| 1-2 | 그룹 B(공제중심) 구성 | M5-02 | 투자공제: 사업장별 소재지 개별 판단 |
| 1-3 | 개인 전용 추가공제 점검 | P4-04~14 | 성실사업자, 기장세액, 외국납부, 착한임대인 등 |
| 1-4 | 소득공제 누락분 점검 | P4-01 | ★ 세율구간 변동 → 산출세액 재계산 |
| 1-5 | 결손금 소급공제 점검 | P4-09 | 소득세법 §85의2 |

### STEP 2: 개별 공제·감면 산출 (INC 분기)

| 단계 | 처리 | 모듈 | 핵심 차이 |
|------|------|------|----------|
| 2-1 | 소득공제 반영 후 산출세액 확정 | P3-04 | 소득공제 누락분 반영 후 재계산 |
| 2-2 | 감면 소득 배분 계산 | P4-02 | ★ 다사업장별 개별 계산 후 합산 |
| 2-3 | 공동사업자 소득 배분 | P4-03 | 지분율에 따라 배분 |
| 2-4 | 창업감면(§6) 산출 | M4-04+P4-02 | 재창업 리스크 확인 필수 |
| 2-5 | 특별감면(§7) 산출 | M4-05+P4-02 | 사업장별 감면율 차등 |
| 2-6 | 통합고용(§29의8) 산출 | M4-02 | 사업장별 합산, 대표자 제외 |
| 2-7 | 투자공제(§24) 산출 | M4-01 | 사업장별 소재지 판단 |
| 2-8 | R&D공제(§10) 산출 | M4-06 | 개인도 KOITA 가능 |
| 2-9 | 사보공제(§30의4) 산출 | M4-03 | 사업장별 납부액 확인 |
| 2-10 | 성실사업자 의료비·교육비 | P4-04 | ★ 최저한세 비대상 |
| 2-11 | 성실신고확인비용 | P4-05 | ★ 최저한세 대상 |
| 2-12 | 기장세액공제 | P4-06 | ★ 조특법 중복배제 비대상 |
| 2-13 | 외국납부세액공제 | P4-07 | 세액공제 vs 필요경비 비교 |
| 2-14 | 착한 임대인 세액공제 | P4-08 | 최저한세 대상 |
| 2-15 | 자녀세액공제 | P4-10 | |
| 2-16 | 연금저축 세액공제 | P4-11 | |
| 2-17 | 전자신고 세액공제 | P4-12 | 2만원 |
| 2-18 | 결손금 소급공제 | P4-09 | 소득세법 §85의2 |

### STEP 3: 최적 조합 산출 (INC 분기)

| 단계 | 처리 | 모듈 | 핵심 차이 |
|------|------|------|----------|
| 3-1 | 상호배제 검증 | M5-01 | §127④ 동일 |
| 3-2 | 최저한세 적용 | P5-01 | ★ 산출세액 × 35%/45% (규모 불문) |
| 3-3 | 최저한세 비대상 별도 적용 | P5-01 | 성실 의료비·교육비(§122의3) + 기장세액(§56의2) + 외국납부(§57) |
| 3-4 | 농특세 적용 | M5-04 | 동일 |
| 3-5 | 적용순서 | M5-05 | ★ 소득세법 §60 |
| 3-6 | 기장세액공제 추가 적용 | P4-06 | ★ 감면 적용 후 잔여 산출세액에 20% |

### STEP 4~5: 환급액 산출·보고 (INC 분기)

| 단계 | 처리 | 모듈 | 핵심 차이 |
|------|------|------|----------|
| 4-1 | 환급액 산출 | M6-01 | = 실제납부(중간예납+확정+분납) - 경정후 결정세액 |
| 4-2 | 환급상한 검증 | M6-01 | ★ 환급액 ≤ 실제납부세액 총액 |
| 4-3 | 환급가산금 | M6-02 | 납부일 다음날 기산, 비과세소득 |
| 4-4 | 지방소득세 안내 | M6-03 | ★ 고정양식 출력 |
| 4-5 | 보고서 생성 | M6-04 | 소득공제 전후 비교, 다사업장 배분, 결손금 소급 별도 |

---

## 8. 개별 기능 상세설계 — 개인사업자 전용 모듈

### 8.1 P3-01: 소재지 사업장별 개별 판단

```
함수: determine_inc_location(taxpayer_id)
입력: TBL_INC_BUSINESS (사업장별 소재지)
출력: 사업장별 수도권 구분, 인구감소지역 여부

로직:
  FOR EACH biz IN TBL_INC_BUSINESS:
    biz.capital_zone = lookup(REF_CAPITAL_ZONE, biz.address)
    biz.is_depopulation = lookup(REF_DEPOPULATION_AREA, biz.address)
    // ★ 법인의 본점간주 규정 적용하지 않음
    // 사업장 A(비수도권) + 사업장 B(수도권) = 각각 다른 감면율 적용
  END FOR
```

### 8.2 P3-03: 종합소득금액 산정

### ★v1.1 8.1a P3-02: 성실신고확인대상 자동 판정 (신규)

```
함수: check_sincerity_target(taxpayer_id)
입력: TBL_INC_BUSINESS (업종코드, 수입금액), REF_INC_SINCERITY_THRESHOLD
출력: is_sincerity_target, filing_deadline, 활성화 모듈 목록

로직:
  // 1. 업종별 수입금액 합산 (다사업장 합산)
  total_revenue_by_industry = {}
  FOR EACH biz IN TBL_INC_BUSINESS:
    industry_group = classify_industry_group(biz.industry_code)
    // 도소매, 제조·건설·운수, 서비스업 등 그룹 분류
    total_revenue_by_industry[industry_group] += biz.revenue
  END FOR
  
  // 2. 업종별 기준금액 대조
  is_target = FALSE
  FOR EACH (group, revenue) IN total_revenue_by_industry:
    threshold = GET_THRESHOLD(REF_INC_SINCERITY_THRESHOLD, group)
    // 도소매 15억, 제조·건설·운수 7.5억, 서비스 5억
    IF revenue >= threshold:
      is_target = TRUE
      BREAK
    END IF
  END FOR
  
  // 3. 판정 결과에 따른 모듈·기한 제어
  IF is_target:
    UPDATE TBL_INC_BASIC SET is_sincerity_target = TRUE
    filing_deadline = CONCAT(tax_year + 1, '-06-30')  // 6월 30일
    ENABLE MODULE P4-04  // 성실사업자 의료비·교육비 세액공제
    ENABLE MODULE P4-05  // 성실신고확인비용 세액공제
  ELSE:
    UPDATE TBL_INC_BASIC SET is_sincerity_target = FALSE
    filing_deadline = CONCAT(tax_year + 1, '-05-31')  // 5월 31일
    DISABLE MODULE P4-04
    DISABLE MODULE P4-05
  END IF
  
  // ★ 수동 입력값과 자동 판정 불일치 시 경고
  IF basic.is_sincerity_target_manual != is_target:
    WARNING: "수동입력 성실신고대상 여부와 수입금액 기준 자동판정 불일치 — 확인 필요"
  END IF
  
  RETURN {is_target, filing_deadline}
```

### ★v1.1 8.1b M4-11a: 업무용 승용차 비용 재산출 [CORP] (신설)

```
함수: recalculate_biz_car_expense(taxpayer_id)
입력: 운행기록부 유무/소급확보 여부, 임직원 전용보험 가입여부
      차량별 감가상각비, 유지비, 처분손실
출력: 조정된_세무조정_금액 (손금불산입 환입 가능액)

로직:
  refund_amount = 0
  
  FOR EACH car IN TBL_BIZ_CAR_LIST:
    // ★ STEP 1: 임직원 전용보험 확인
    IF car.exclusive_insurance = FALSE:
      // 전용보험 미가입 → 관련 비용 전액 손금불산입
      // ★ 경정청구로 환급 불가 → 사용자에게 '경정 불가' 안내
      car.refundable = 0
      WARNING: "차량 [car.id] — 임직원 전용보험 미가입, 경정 대상 아님"
      CONTINUE
    END IF
    
    // ★ STEP 2: 운행기록부 확인
    IF car.driving_log_exists = FALSE AND car.driving_log_recovered = FALSE:
      // 운행기록부 미작성 → 연 1,500만원 한도 적용
      limit = 15,000,000  // 감가상각 800만 + 유지비 700만
      IF car.total_expense > limit:
        car.disallowed = car.total_expense - limit
        // 기존에 전액 불산입했으면 한도까지 환입 가능
        IF car.prev_disallowed > car.disallowed:
          car.refundable = car.prev_disallowed - car.disallowed
        END IF
      END IF
    ELSE IF car.driving_log_recovered = TRUE:
      // ★ 운행기록부 소급 확보 → 업무사용비율 재산정
      biz_ratio = car.recovered_biz_usage_ratio  // 업무사용비율
      new_deductible = TRUNCATE(car.total_expense × biz_ratio, -1)
      car.refundable = new_deductible - car.prev_deducted
    END IF
    
    // ★ STEP 3: 감가상각비 한도 검증
    IF car.depreciation > 8,000,000:
      car.depreciation_disallowed = car.depreciation - 8,000,000  // 유보
    END IF
    
    // ★ STEP 4: 처분손실 한도 검증
    IF car.disposal_loss > 8,000,000:
      car.disposal_disallowed = car.disposal_loss - 8,000,000  // 기타사외유출/유보
    END IF
    
    refund_amount += MAX(0, car.refundable)
  END FOR
  
  RETURN refund_amount  // 세무조정 환입 가능 총액
```

### 8.2 P3-03: 종합소득금액 산정

```
함수: calculate_comprehensive_income(taxpayer_id)
입력: TBL_INC_BUSINESS, TBL_INC_OTHER_INCOME, TBL_INC_JOINT_BIZ
출력: 종합소득금액

로직:
  // 1. 사업소득 합산
  total_biz_income = 0
  FOR EACH biz IN TBL_INC_BUSINESS:
    IF is_joint_biz:
      total_biz_income += biz.total_biz_income × joint.profit_share_ratio
    ELSE:
      total_biz_income += biz.biz_income
  END FOR
  
  // 2. 기타 소득 합산
  other = TBL_INC_OTHER_INCOME
  employment = other.employment_income
  
  // ★ 금융소득 2천만원 초과 여부 판단
  IF other.financial_income_total > 20,000,000:
    financial = other.financial_income_total  // 전액 종합과세
  ELSE:
    financial = 0  // 분리과세 → 종합소득금액에서 제외
  END IF
  
  pension = other.pension_income
  etc_income = other.other_income
  
  // 3. 종합소득금액 (분리과세 제외)
  comprehensive_income = total_biz_income + employment + financial + pension + etc_income
  // ★ 분리과세 주택임대소득 등도 제외
  
  RETURN comprehensive_income
```

### 8.3 P4-02: 감면 소득 배분 계산 (다사업장)

```
함수: calculate_inc_exemption_allocation(taxpayer_id, computed_tax)
입력: TBL_INC_BUSINESS, comprehensive_income, computed_tax
출력: OUT_INC_INCOME_ALLOCATION

로직:
  total_exemption = 0
  
  FOR EACH biz IN TBL_INC_BUSINESS WHERE is_exempt_eligible = TRUE:
    // ★ 감면세액 = 산출세액 × (감면대상소득 ÷ 종합소득금액) × 감면율
    income_ratio = TRUNCATE(biz.biz_income / comprehensive_income, 4)
    
    IF exemption_type = '§7':
      rate = biz.exemption_rate_7  // 소재지·규모별 5~30%
    ELSE IF exemption_type = '§6':
      rate = determine_startup_rate(biz)  // 50~100%
    END IF
    
    exemption = TRUNCATE(computed_tax × income_ratio × rate, -1)  // 10원 미만 절사
    
    // 공동사업자인 경우
    IF is_joint_biz:
      exemption = TRUNCATE(exemption × joint.profit_share_ratio / 100, -1)
    END IF
    
    INSERT INTO OUT_INC_INCOME_ALLOCATION(...)
    total_exemption += exemption
  END FOR
  
  // 감면한도 적용 (제7조: 1억원)
  IF exemption_type = '§7':
    total_exemption = MIN(total_exemption, 100,000,000)
    // 상시근로자 감소 시: MAX(0, 1억 - 감소인원 × 500만)
  END IF
  
  RETURN total_exemption
```

### 8.4 P5-01: 개인 최저한세 산출

```
함수: calculate_inc_minimum_tax(computed_tax)
입력: computed_tax (산출세액)
출력: minimum_tax, max_deductible

로직:
  threshold = 30,000,000  // 3천만원
  
  IF computed_tax <= threshold:
    minimum_tax = TRUNCATE(computed_tax × 0.35, -1)
  ELSE:
    below = TRUNCATE(threshold × 0.35, -1)
    above = TRUNCATE((computed_tax - threshold) × 0.45, -1)
    minimum_tax = below + above
  END IF
  
  // 공제 가능 한도 = 산출세액 - 최저한세액
  max_deductible = computed_tax - minimum_tax
  
  // ★ 최저한세 비대상 항목은 별도 처리
  // - 성실사업자 의료비·교육비 (§122의3) → 최저한세 한도와 무관, 별도 적용
  // - 기장세액공제 (소득세법 §56의2) → 소득세법상 공제, 조특법 최저한세 비대상
  // - 외국납부세액공제 (소득세법 §57) → 소득세법상 공제
  // - 자녀세액공제 (소득세법 §59의2) → 소득세법상 공제
  // - 연금저축세액공제 (소득세법 §59의3) → 소득세법상 공제
  
  // ★ 최저한세 대상 항목
  // - 성실신고확인비용 (§126의6) → 최저한세 대상 ○
  // - 착한 임대인 (§96의3) → 최저한세 대상 ○
  // - §6, §7, §24, §29의8, §30의4 등 조특법 감면·공제 → 최저한세 대상 ○
  
  RETURN {minimum_tax, max_deductible}
```

### 8.5 P4-01: 소득공제 누락 점검·세율구간 최적화

```
함수: optimize_income_deduction(taxpayer_id)
입력: TBL_INC_DEDUCTION, TBL_INC_BASIC, REF_INC_TAX_RATE
출력: OUT_INC_DEDUCTION_IMPACT

로직:
  // BEFORE: 기존 신고 기준
  before_base = basic.taxable_base
  before_tax = basic.computed_tax
  
  // 누락 소득공제 확인
  additional_deduction = 0
  
  // ① 인적공제 누락 확인
  additional_deduction += check_personal_deduction_missed()
  
  // ② 건강보험료 가입유형 구분 ★v1.1 3분류 분기 로직 (프롬프트 ㉖규칙)
  // 유형1: 지역가입자 → 전액 소득공제
  IF deduction.health_type = 'LOCAL':
    additional_deduction += deduction.health_insurance
  
  // 유형2: 직장가입자(사업주) 본인 부담분 → 소득공제
  ELSE IF deduction.health_type = 'EMPLOYED':
    additional_deduction += deduction.health_insurance_owner
    // ★ 사업소득 필요경비 아님 (사업과 직접 관련 비용이 아닌 개인 부담)
    // ★ 겸업자(근로+사업) → 직장건강보험료는 근로소득 관련, 사업소득 무관
  END IF
  
  // 유형3: 사업장 근로자용 사업주 부담 4대보험료 → 필요경비
  // ★ 이 항목은 소득공제가 아닌 TBL_INC_BUSINESS의 필요경비로 처리
  // ★ P1-02 입력 시점에서 이미 사업소득금액에 반영되어야 함
  // ★ 누락 시 → 사업소득금액 재계산(소득금액 감소) → 과세표준·세율구간 변동
  IF biz.employer_insurance_missed > 0:
    // 필요경비 누락분 → 사업소득금액 재계산 트리거
    FLAG: RECALCULATE_BIZ_INCOME
    biz.biz_income -= biz.employer_insurance_missed  // 소득금액 감소
    // ★ 종합소득금액이 변동되므로 감면소득배분(P4-02) 전면 재계산 필요
  END IF
  
  // ③ 노란우산공제 누락 확인
  additional_deduction += check_noran_umbrella_missed()
  
  // AFTER: 소득공제 추가 반영 후
  after_base = MAX(0, before_base - additional_deduction)
  after_tax = calculate_progressive_tax(after_base, REF_INC_TAX_RATE)
  
  // ★ 세율구간 변동 확인
  before_bracket = get_tax_bracket(before_base)
  after_bracket = get_tax_bracket(after_base)
  
  IF before_bracket != after_bracket:
    // ★★★ 세율구간 변동 시 산출세액이 크게 달라짐
    // 모든 감면·공제 전략을 재수립해야 함
    FLAG: RECALCULATE_ALL_EXEMPTIONS
  END IF
  
  INSERT INTO OUT_INC_DEDUCTION_IMPACT(...)
  
  RETURN {after_base, after_tax, additional_deduction}
```

---

## 9. 계산 공식 정의서 — 종합소득세

### 9.1 종합소득세 산출세액

```
F-INC-01: 종합소득금액
= Σ(사업장별 사업소득) + 근로소득 + 금융소득(2천만 초과 시) + 연금소득 + 기타소득
  - 비과세소득 - 분리과세소득
  ※ 공동사업자: 사업소득 = 전체소득 × 본인 지분율

F-INC-02: 과세표준
= 종합소득금액 - 소득공제 합계
  ※ 소득공제: 인적공제 + 국민연금 + 건강보험 + 노란우산 + 기타

F-INC-03: 산출세액
= 과세표준 × 초과누진세율(6~45%) - 누진공제액
  ※ TRUNCATE(-1) (10원 미만 절사)
```

### 9.2 감면세액 (다사업장)

```
F-INC-04: 감면세액 (사업장별)
= 산출세액 × TRUNCATE(감면대상사업소득 ÷ 종합소득금액, 4) × 감면율
  ※ 종합소득금액 분모에서 분리과세소득 반드시 제외
  ※ 공동사업자: 감면대상소득 = 전체소득 × 본인지분율

F-INC-05: 총 감면세액
= Σ(사업장별 감면세액)
  ※ 제7조 감면한도: MIN(총감면세액, MAX(0, 1억 - 감소인원 × 500만))
```

### 9.3 개인 최저한세

```
F-INC-06: 최저한세액
= TRUNCATE(MIN(산출세액, 3천만) × 0.35, -1)
  + TRUNCATE(MAX(0, 산출세액 - 3천만) × 0.45, -1)

F-INC-07: 공제가능한도
= 산출세액 - 최저한세액
  ※ 최저한세 대상 감면·공제 합계가 이 한도 내에서만 적용
  ※ 최저한세 비대상 항목(§122의3, §56의2, §57, §59의2, §59의3)은 별도 추가
```

### 9.4 환급액

```
F-INC-08: 경정청구 환급액
= 실제납부세액(중간예납 + 확정신고 + 분납) - 경정후 결정세액
  ※ 환급액 ≤ 실제납부세액 총액 (초과 불가)
  ※ 농특세 차감 후 실질 환급액 기준

F-INC-09: 환급가산금
= 환급액 × 이율 × 일수 ÷ 365
  기산일: 원래 납부일 다음날
  종료일: 지급결정일
  ※ 1원 미만 절사
  ※ 비과세소득 (소득세법 열거주의)

F-INC-10: 총 실질 환급액
= 종합소득세 환급액 + 지방소득세 환급액(10%) + 환급가산금
```

### ★v1.1 9.6 사후관리 추징액 산출 (공통)

```
F-COM-01: 고용세액공제 추징액 (이자상당액 포함) ★v1.1 신규

Input:
  - reduced_count: 감소 인원 수
  - deduction_per_person: 당초 공제받은 인당 금액 (청년/일반 구분)
  - tax_year_end: 공제받은 과세연도 종료일
  - payment_date: 추징사유 발생일 (납부일)
  - interest_rate: 국세기본법 시행규칙 이율 (연 8.03% 등, 해당 연도 기준)

Formula:
  // STEP 1: 본세 추징액
  principal_tax = reduced_count × deduction_per_person
  
  // STEP 2: 경과일수 산정
  days_elapsed = payment_date - (tax_year_end + 1일)
  
  // STEP 3: 이자상당가산액
  interest_surcharge = TRUNCATE(principal_tax × (days_elapsed / 365) × interest_rate, -1)
  // 10원 미만 절사
  
  // STEP 4: 총 추징액
  total_surcharge = principal_tax + interest_surcharge
  
  ※ 경정청구 시점 기준 향후 2년 내 인원 감소 시나리오별 예상 추징액 산출
  ※ 법인(CORP)과 개인(INC) 동일하게 적용
  ※ 청년/일반에 따라 deduction_per_person 차등 적용
```

### 9.5 결손금 소급공제 환급 (개인)

```
F-INC-11: 소급공제 환급세액
= 직전연도 산출세액 × TRUNCATE(소급공제 결손금 ÷ 직전연도 과세표준, 4)
  ※ 중소기업만 적용 (소득세법 §85의2)
  ※ 직전연도 실제 납부세액 한도
```

---

## 10. 검증 규칙 및 제약조건

### 10.1 개인사업자 전용 검증 규칙

| 코드 | 유형 | 설명 | 처리 |
|------|------|------|------|
| VP01 | V | TAX_TYPE='INC' 시 TBL_INC_BASIC 필수 | 오류 → 입력 요청 |
| VP02 | V | 다사업장: TBL_INC_BUSINESS 최소 1건 | 오류 → 입력 요청 |
| VP03 | V | 공동사업자: 손익분배비율 합계 ≤ 100% | 오류 → 비율 확인 |
| VP04 | V | 추계신고 시 감면·공제 적용 불가 확인 | 경고 → 기장 여부 재확인 |
| VP05 | V | 성실신고확인대상 여부 vs 수입금액 교차확인 | 경고 → 수입금액 확인 |
| CP01 | C | 감면세액 ≤ 산출세액 × 소득비율 × 감면율 | 오류 → 재계산 |
| CP02 | C | 소득공제 후 과세표준 ≥ 0 | 오류 → 공제 한도 확인 |
| CP03 | C | 최저한세 = 산출세액 × 35%/45% 검증 | 오류 → 재계산 |
| CP04 | C | 환급액 ≤ 실제납부세액 총액 | 오류 → 상한 적용 |
| CP05 | C | 분리과세 소득이 종합소득금액에서 제외 확인 | 오류 → 분모 재계산 |
| BP01 | B | 기장세액공제 + 조특법 감면 중복 허용 | 정보 → 추가 적용 |
| BP02 | B | §126의6(확인비용) = 최저한세 대상 확인 | 경고 → 한도 내 적용 |
| BP03 | B | §122의3(의료비·교육비) = 최저한세 비대상 | 정보 → 별도 적용 |
| BP04 | B | 창업감면 시 동일 업종 재창업 이력 확인 | 경고 → 리스크 안내 |
| LP01 | L | 적용순서 = 소득세법 §60 확인 | 오류 → 순서 정정 |
| LP02 | L | 경정청구 기산일 = 5.31/6.30 확인 | 오류 → 기한 재산정 |
| LP03 | L | 사업장별 소재지 개별 판단 (본점간주 X) | 경고 → 소재지 재확인 |
| WP01 | W | 분리과세 소득 제외 여부 안내 | 경고 |
| WP02 | W | 세율구간 변동 발생 시 전면 재계산 안내 | 경고 |

### ★v1.1 추가 검증 규칙 (1~3차 지적 반영)

| 코드 | 유형 | 설명 | 처리 | 근거 |
|------|------|------|------|------|
| VP06 | V | [개인] 성실사업자 의료비·교육비(§122의3) 신청 시 `is_sincerity_target=TRUE` 검증. FALSE면 적용 불가 처리 | 오류 → P4-04 비활성화 | 조특법 §122의3 |
| BP05 | B | [법인] 이월결손금 공제 한도 적용 시, 중소기업=소득100%, 비중소기업=80% 자동 제한 | 자동 적용 → 한도 초과분 차단 | 법인세법 §13 |
| LP04 | L | [공통] 2025.1.1 이후 창업: 창업감면(§6) + 통합고용공제(§29의8) 중복적용 시도 시 Hard Fail + 택일 유도 | 오류 → 감면/공제 택일 | 조특법 §127④ (2024 개정) |
| LP05 | L | [법인] 경정청구 항목에 결산조정 항목(감가상각비·퇴직급여충당금·대손충당금) 포함 시 불가 필터링 | Hard Fail → 신고조정 항목으로 전환 안내 | 법인세법 §40 (결산확정주의) |

### 10.2 교차검증 규칙 (개인 전용 추가)

| 코드 | 설명 |
|------|------|
| XP01 | TBL_INC_BUSINESS.revenue 합계 ↔ 중소기업 매출액 기준 교차 |
| XP02 | TBL_INC_BUSINESS.biz_income 합계 + TBL_INC_OTHER_INCOME = 종합소득금액 |
| XP03 | TBL_INC_DEDUCTION.total_deduction = 개별 공제 합계 |
| XP04 | 공동사업자 본인지분소득 = 전체소득 × 지분율 |
| XP05 | 금융소득 2천만 초과 시 → 전액 종합과세 반영 확인 |

---

## 11. 세목별 과세 구조 비교 및 분기 정의

### 11.1 세목 분기 매트릭스

| 모듈/기능 | CORP (법인세) | INC (종합소득세) | 비고 |
|-----------|-------------|-----------------|------|
| **경정청구 기한** | 사업연도종료+3개월→+5년 | 5.31(성실6.30)→+5년 | 기산일 차이 |
| **과세표준 산출** | 각사업연도소득-이월결손금-비과세 | 종합소득금액-소득공제 | ★ 핵심 차이 |
| **세율** | 법인세법 §55 (9~24%) | 소득세법 §55 (6~45%) | 세율표 분리 |
| **최저한세** | 과세표준 기준, 규모별 차등 | 산출세액 기준, 규모불문 | ★ 완전히 다름 |
| **소재지 판단** | 본점 간주 | 사업장별 개별 | ★ 핵심 차이 |
| **상시근로자 제외** | 임원+최대주주친족 | 대표자+배우자+직계존비속 | 제외 대상 차이 |
| **적용순서** | 법인세법 §59 | 소득세법 §60 | 근거법 차이 |
| **환급가산금** | 익금불산입 | 비과세소득 | 성격 차이 |
| **지방소득세** | 별도 안내 | ★ 고정양식 출력 | 양식 차이 |

### 11.2 중복적용 매트릭스 (공통)

| | §7 | §6 | §24 | §29의8 | §30의4 | §10 |
|--|----|----|-----|--------|--------|-----|
| §7(특별감면) | - | ✕ | ✕ | ★ | ★ | ★ |
| §6(창업감면) | ✕ | - | ✕ | ●(주1) | ✕ | ★ |
| §24(투자공제) | ✕ | ✕ | - | ★ | ★ | ✕(주2) |
| §29의8(고용) | ★ | ● | ★ | - | ✕(주3) | ★ |
| §30의4(사보) | ★ | ✕ | ★ | ✕(주3) | - | ★ |
| §10(R&D) | ★ | ★ | ✕(주2) | ★ | ★ | - |

> (주1) 2024까지 중복가능 / 2025~ 중복불가 (★v1.1 LP04 Hard Fail 적용)  
> (주2) 동일 자산 중복불가  
> (주3) 2023~24년 선택적용

### 11.3 개인사업자 전용 추가 공제·감면 (법인에 없는 항목)

| 항목 | 근거법 | 최저한세 | 농특세 | 중복배제 |
|------|--------|---------|--------|---------|
| 성실사업자 의료비·교육비 | §122의3 | ✕ 비대상 | - | 비대상 |
| 성실신고확인비용 | §126의6 | ○ 대상 | - | - |
| 기장세액공제 | 소득세법 §56의2 | ✕ 비대상 | - | ★ §127 비대상 → 모든 감면과 병행 |
| 노란우산공제 | 소득세법 §51의3 | - (소득공제) | - | - |
| 연금저축 세액공제 | 소득세법 §59의3 | ✕ 비대상 | - | - |
| 자녀세액공제 | 소득세법 §59의2 | ✕ 비대상 | - | - |
| 전자신고 세액공제 | §104의8 | - | - | - |
| 외국납부세액공제 | 소득세법 §57 | ✕ 비대상 | ✕ 비대상 | - |
| 착한 임대인 | §96의3 | ○ 대상 | 확인 필요 | - |
| 결손금 소급공제 | 소득세법 §85의2 | - | - | 중소기업만 |

---

## 12. 프롬프트 대비 교차검증 결과

### 12.1 종합소득세 프롬프트 v1.3 ↔ 통합 설계서 v1.1

| 프롬프트 항목 | 설계서 반영 위치 | 상태 |
|--------------|----------------|------|
| **[핵심전제]** |||
| ① 인별 합산과세 | §1.3 개인전용원칙, §11.1 | ✅ |
| ② 소득합산 | P3-03, TBL_INC_OTHER_INCOME | ✅ |
| ③ 6~45% 세율 | REF_INC_TAX_RATE (§5.1) | ✅ |
| ④ 소득공제 | TBL_INC_DEDUCTION, P4-01 | ✅ |
| ⑤ 감면소득배분 | P4-02, F-INC-04 (§9.2) | ✅ |
| ⑥ 최저한세 산출세액 기준 | P5-01, F-INC-06 (§9.3) | ✅ |
| ⑦ 소득세법 §60 적용순서 | §1.3, LP01 | ✅ |
| ⑧ 신고기한 5.31/6.30 | P3-02, LP02 | ✅ |
| ⑨ 사업장별 개별 판단 | P3-01, LP03 | ✅ |
| ⑩ 지방소득세 별도 | M6-03, OUT_INC_LOCAL_TAX | ✅ |
| ⑪ 공동사업자 배분 | P4-03, TBL_INC_JOINT_BIZ | ✅ |
| ⑫ 분리과세 소득 제외 | P3-03, WP01, CP05 | ✅ |
| ⑬ 기장세액공제 중복배제 비대상 | P4-06, BP01 | ✅ |
| **[1단계] 전략수립** |||
| 그룹 A·B 비교 | M5-02 (세목 분기) | ✅ |
| 개인 전용 추가공제 | P4-04~14 (15개 모듈) | ✅ |
| 다사업장 소득배분 공식 | P4-02, F-INC-04 | ✅ |
| **[2단계] 공통전제** |||
| 소재지 사업장별 | P3-01 | ✅ |
| 농특세 | M5-04 | ✅ |
| 최저한세 (산출세액×35%/45%) | P5-01, F-INC-06 | ✅ |
| §126의6 최저한세 대상 / §122의3 비대상 | BP02, BP03 | ✅ |
| 상호배제 | M5-01, §11.2 | ✅ |
| 중소기업 판단 | M3-02 (다사업장 합산) | ✅ |
| 적용순서 (§60) | M5-05 [INC] | ✅ |
| 기존 신고 확인 (중간예납/원천징수/분납) | TBL_INC_BASIC | ✅ |
| 환급가산금 (비과세) | M6-02, §9.4 | ✅ |
| 다사업장 합산·배분 | P3-03, P4-02 | ✅ |
| 소득세 세율 확인 | REF_INC_TAX_RATE | ✅ |
| 결손금 소급공제 | P4-09, F-INC-11 | ✅ |
| **[3단계] 개별점검** |||
| 점검 10~13 투자공제 | M4-01 [INC분기: 사업장별 소재지] | ✅ |
| 점검 14~16 고용공제 | M4-02 [INC분기: 대표자제외, 합산] | ✅ |
| 점검 17~18 사보공제 | M4-03 | ✅ |
| 점검 19 고용증대 | M4-02 (경과규정) | ✅ |
| 점검 20~21 창업감면 | M4-04 [INC분기: 개업일, 재창업 리스크] | ✅ |
| 점검 22~23 R&D | M4-06 [INC분기: KOITA 가능] | ✅ |
| 점검 24~25 특별감면 | M4-05 [INC분기: 사업장별 감면율] | ✅ |
| 점검 26 성실사업자 의료비·교육비 | P4-04 ★신규 | ✅ |
| 점검 27 노란우산 | P4-01 (소득공제) | ✅ |
| 점검 28 연금저축 | P4-11 ★신규 | ✅ |
| 점검 29 자녀세액공제 | P4-10 ★신규 | ✅ |
| 점검 30 기장세액공제 | P4-06 ★신규 | ✅ |
| 점검 31 전자신고 | P4-12 ★신규 | ✅ |
| 점검 31-2 성실신고확인비용 | P4-05 ★신규 | ✅ |
| 점검 32 소득공제 누락 | P4-01 ★신규 (세율구간 최적화 포함) | ✅ |
| 점검 33 지방소득세 | M6-03, OUT_INC_LOCAL_TAX | ✅ |
| 점검 34 외국납부세액공제 | P4-07 ★신규 | ✅ |
| 점검 35 착한 임대인 | P4-08 ★신규 | ✅ |
| 점검 36 재해손실 | P4-13 ★신규 | ✅ |
| 점검 37 벤처투자조합 | P4-14 ★신규 | ✅ |
| **[4단계] 최종보고** |||
| 요약표 (개인전용 포함) | M6-04 | ✅ |
| 최적조합 (다사업장 배분 포함) | M6-04 | ✅ |
| 최저한세 영향분석 (산출세액×35%/45%) | M6-04 | ✅ |
| 환급액 비교표 (소득공제 전후, 결손금 소급) | M6-04, OUT_INC_DEDUCTION_IMPACT | ✅ |
| 지방소득세 고정양식 | M6-03, OUT_INC_LOCAL_TAX | ✅ |
| 필요 증빙 서류 | M6-04 | ✅ |
| 사후관리 | M7-03 | ✅ |
| **[필수준수규칙]** |||
| ① 10원 미만 절사 | MX-05 | ✅ |
| ② 소수점 3자리 절사 | MX-05 | ✅ |
| ③ 농특세 20% 차감 | M5-04 | ✅ |
| ④ 농특세 면제 항목 | M5-04 (§6,§7,§10) | ✅ |
| ⑤ 상호배제 교차검증 | M5-01 | ✅ |
| ⑮ 감면소득배분 공식 | P4-02, F-INC-04 | ✅ |
| ⑯ 최저한세 산출세액 기준 | P5-01, F-INC-06 | ✅ |
| ⑰ 소득공제 누락 점검 | P4-01 | ✅ |
| ⑱ 지방소득세 안내 | M6-03 | ✅ |
| ⑲ 공동사업자 배분 | P4-03 | ✅ |
| ⑳ 성실신고확인비용 점검 | P4-05, BP02 | ✅ |
| ㉑ 결손금 소급공제 중소기업 한정 | P4-09 | ✅ |
| ㉒ 기장세액공제 중복배제 비대상 | P4-06, BP01 | ✅ |
| ㉓ §126의6 vs §122의3 최저한세 구분 | BP02, BP03 | ✅ |
| ㉔ 분리과세 소득 제외 | P3-03, CP05, WP01 | ✅ |
| ㉕ 재창업 리스크 | M4-04, BP04 | ✅ |
| ㉖ 건강보험료 가입유형 구분 | P4-01b ★v1.1 3분류(지역→소득공제, 직장본인→소득공제, 근로자사업주부담→필요경비) | ✅ 보완 |
| ㉗ 외국납부세액공제 | P4-07 | ✅ |
| ㉘ 청년 병역 차감 산식 | M3-04 step6 | ✅ |

### 12.2 법인세 프롬프트 v1.3 커버리지

> 법인세 v4.0r1 설계서의 전체 커버리지(§11.1~11.5)를 그대로 승계.  
> 모든 점검항목(점검 0~32) ↔ 설계서 모듈 매핑 완료. 상세는 [부록] 참조.

#### ★v1.1 추가 매핑

| 프롬프트 항목 | v1.0 상태 | v1.1 반영 위치 | 상태 |
|--------------|----------|---------------|------|
| [점검 0] 업무용 승용차 비용 불산입 재검토 | 미구체화 | M4-11a (신설) | ✅ 보완 |
| [점검 0] 결산확정의 원칙 | 언급만 | M3-00 Hard Fail 필터 + LP05 | ✅ 보완 |
| [점검 27] 이월결손금 중소/일반 한도 | 미명시 | BP05 (중소100%/일반80%) | ✅ 보완 |
| [점검 28] 수입배당금 연도별 적용기준 | 미구체화 | M4-09 연도별 매칭 | ✅ 보완 |
| 사후관리 이자상당가산액 | 미포함 | M7-03 + F-COM-01 | ✅ 보완 |

---

## ★v1.1 부록A — 1~3차 지적사항 검토 결과

### A.1 1차 지적사항 검토 (5건)

| No | 지적 내용 | 정당성 | 판단 근거 | 반영 위치 |
|----|----------|--------|----------|----------|
| 1-1 | [개인] 건강보험료 필요경비 vs 소득공제 분기 로직 미흡 | ✅ 정당 | 프롬프트 ㉖규칙에 3분류(지역→소득공제, 직장본인→소득공제, 근로자사업주부담→필요경비) 명시. v1.0에서는 가입유형 2분류만 처리 | P4-01b |
| 1-2 | [법인] 업무용 승용차 세무조정 재검토 모듈 미구체화 | ✅ 정당 | 프롬프트 점검0에 운행기록부/전용보험/감가상각한도 상세 로직 있으나 v1.0에 미반영 | M4-11a 신설 |
| 1-3 | [개인] 성실신고확인대상 판단이 수동입력 의존 | ✅ 정당 | REF_INC_SINCERITY_THRESHOLD 테이블이 있으므로 자동 판정 가능. 수동입력은 오류 위험 | P3-02 |
| 1-4 | [법인] 결산확정 원칙 검증 필터 부족 | ✅ 정당 | v1.0에 결산조정 차단 언급 있으나 구체적 필터링 항목·처리 방식 미명시 | M3-00, LP05 |
| 1-5 | [공통] 사후관리 추징액에 이자상당가산액 미포함 | ✅ 정당 | 프롬프트에 인당 추징 예상액 수치화 지시 있고, 이자상당가산액은 실무 필수 | M7-03, F-COM-01 |

### A.2 1차 신규 검증 규칙 제안 (3건)

| 코드 | 정당성 | 판단 근거 | 반영 |
|------|--------|----------|------|
| VP06 | ✅ 정당 | 성실대상 아닌 자가 §122의3 신청 시 국세청 거부 → 사전 차단 필요 | 반영 |
| BP05 | ✅ 정당 | 이월결손금 한도(중소100%/일반80%)는 법인세법 §13 핵심 규정이나 v1.0에 미명시 | 반영 |
| LP04 | ✅ 정당 | 2024 세법개정으로 2025.1.1 이후 창업분 §6+§29의8 중복배제 강제 — 실무 리스크 높음 | 반영 |

### A.3 2차 지적사항 검토

> 2차는 1차 지적사항에 대한 구체적 보완안(v1.1)을 제시한 것으로, 추가 지적 1건 식별:

| No | 지적 내용 | 정당성 | 판단 근거 | 반영 위치 |
|----|----------|--------|----------|----------|
| 2-1 | LP05 검증 규칙 추가 (결산조정 항목 필터링) | ✅ 정당 | 1차의 M3-00 강화와 연계, 검증 규칙으로 명시적 코드 부여 필요 | LP05 |

### A.4 3차 지적사항 검토

> 3차는 실무 관점에서 정밀도와 보고서 품질 개선을 제안:

| No | 지적 내용 | 정당성 | 판단 근거 | 반영 위치 |
|----|----------|--------|----------|----------|
| 3-1 | 수입배당금 익금불산입 연도별 적용기준 매칭 | ✅ 정당 | 2023년 개정규정(3단계)/종전규정(4~5단계) 구분이 경정청구 실무에서 핵심 — v1.0 미구체화 | M4-09 |
| 3-2 | 최종 환급 보고서 4부 구조화 | ✅ 정당 | 환급요약+최저한세분석+지방소득세+사후관리로 구조화하면 납세자 가독성 향상 | M6-04 |
| 3-3 | 세율구간 시뮬레이션 시 노란우산공제 명시 | ✅ 정당 | P4-01에 이미 포함되어 있으나 시뮬레이션 시나리오 비교에서 명시적 언급 부족 | P4-01d |

### A.5 검토 총평

| 항목 | 수치 |
|------|------|
| 총 지적사항 | 1차 8건 + 2차 1건 + 3차 3건 = **12건** |
| 정당한 지적 | **12건 (100%)** |
| 반영 완료 | **12건 (100%)** |
| 반영 결과 | 모듈 1건 신설(M4-11a), 검증규칙 4건 추가(VP06/BP05/LP04/LP05), 계산공식 1건 추가(F-COM-01), 로직 보완 6건 |

---

## 부록 — 법인세 v4.0r1 승계 내역

> 본 통합 설계서는 법인사업자 법인세 경정청구 환급액 산출 시스템 개발상세설계서 v4.0r1의 전체 내용을 승계합니다.

### 승계 범위

| 구분 | 승계 항목 수 | 비고 |
|------|------------|------|
| 입력 테이블 | 21개 (TBL_CORP_BASIC ~ TBL_DEPRECIATION_ADJUST) | 변경 없이 승계, tax_type 컬럼 추가 |
| 기준정보 테이블 | 17개 (REF_*) | 변경 없이 승계 |
| 출력 테이블 | 8개 (OUT_*) | 변경 없이 승계 |
| 모듈 | M1~M7, MX (총 60+ 서브모듈) | 세목 분기 추가 |
| 검증 규칙 | V01~V19, C01~C13, B01~B11, L01~L09, X01~X13 | 변경 없이 승계 |
| 계산 공식 | F01~F56 | 변경 없이 승계 |
| 변경이력 | v1.0→v4.0r1 전체 이력 | 참조용 보존 |

### 변경사항 (법인세 모듈)

| 변경 | 내용 |
|------|------|
| 컬럼 추가 | 모든 입력 테이블에 `tax_type VARCHAR(4) DEFAULT 'CORP'` |
| 분기 추가 | M3-00~M3-06, M5-03, M5-05, M6-01~04에 TAX_TYPE 분기 |
| 비활성화 | TAX_TYPE='INC' 시 CORP 전용 모듈 자동 비활성화 |

### ★v1.1 추가 변경사항

| 변경 | 내용 | 근거 |
|------|------|------|
| M4-11a 신설 | 업무용 승용차 비용 재산출 서브모듈 | 1차 지적, 프롬프트 점검0 |
| M3-00 강화 | 결산조정 항목 Hard Fail 필터 추가 | 1차 지적, 법인세법 §40 |
| M4-09 보완 | 수입배당금 연도별 적용기준 매칭 (2023 개정/종전) | 3차 지적, 법인세법 §18의2 |
| M7-03 보완 | 이자상당가산액 포함 추징액 산출 | 1차 지적, 국세기본법 시행규칙 |
| M6-04 구조화 | 보고서 4부 구조 (요약+최저한세+지방소득세+사후관리) | 3차 지적 |
| BP05 추가 | 이월결손금 중소100%/일반80% 한도 자동 적용 | 1차 지적, 법인세법 §13 |
| LP04 추가 | 2025~ 창업 §6+§29의8 중복배제 강제 | 1차 지적, 2024세법개정 |
| LP05 추가 | 결산조정 항목 경정청구 불가 필터링 | 2차 지적, 법인세법 §40 |

---

**[문서 끝]** — 통합 경정청구 환급액 산출 시스템 개발상세설계서 v1.1
