# 법인사업자 법인세 경정청구 환급액 산출 시스템 — 개발상세설계서 v4.0

> **문서 버전**: v4.0 (v3.0 + 오류수정·누락보완·개선)  
> **기준 프롬프트**: 법인사업자-법인세-경정청구-AI점검요청-프롬프트 v1.3  
> **기준 입력양식**: 입력자료작성-미완성테스트샘플 v1.2  
> **작성일**: 2026-02-15  
> **변경이력**: v3.0(v1.1+v2.0 통합본) + v4.0(오류수정 8건·누락보완 12건·추가정보 15개·외부참조 10개·개선 10건) + v4.0r1(외부검토 반영: 오류수정 3건·누락보완 8건·추가정보 10개·외부참조 2개)

---

## 변경 이력 (v1.0 → v2.0)

### ?? 오류 수정 (Errors Fixed)

| No | 구분 | v1.0 내용 | v2.0 수정 | 근거 |
|----|------|----------|----------|------|
| E01 | TBL_EMPLOYEE_DETAIL.year_type | `'PRIOR'(직전)/current'(해당)` (대소문자 불일치, 따옴표 누락) | `'PRIOR'/'CURRENT'` (대문자 통일) | 코딩 컨벤션 |
| E02 | 프롬프트 점검 9-3 근거법령 참조 | 설계서에서 소득세법 제56조/제60조 혼재 | `법인세법 제59조` 통일, 소득세법 조문은 비교 참고용으로만 명시 | 프롬프트 핵심전제 |
| E03 | M5-02 최적조합탐색 로직 | R&D 최저한세 배제분 처리 위치가 최저한세 검증 이후 | 최저한세 대상 항목 적용 → 최저한세 한도 검증 → R&D 배제분 추가 적용 순으로 정정 | 조특법 §132②, 프롬프트 점검 22-5 |
| E04 | 최저한세 적용 로직 | 감면 초과분 처리 누락 | 감면(이월불가) 초과분 = 소멸, 공제(이월가능) 초과분 = 이월(10년) 명확화 | 프롬프트 점검 15-5 [C] |
| E05 | 통합고용세액공제 공제금액 | 고정값으로 기재 (1,550만원 등) | `사업연도별 시행령 별표 참조` 원칙 명시, 고정값은 2024년 예시로 한정 | 프롬프트 점검 15 ① |
| E06 | 환급가산금 산출 공식 | `환급액 × 이율 × 일수 ÷ 365` | 기산일 = "원래 납부일의 다음날", 종료일 = "충당일 또는 지급결정일" 명확화 | 프롬프트 점검 9-5, 국기법 §52 |
| E07 | TBL_CORP_BASIC | `taxable_income`을 '공제 전 과세표준'으로 설명 | 과세표준 = 각사업연도소득 - 이월결손금 - 비과세소득이므로, '기신고 과세표준'으로 정정 | 법인세법 §13 |

### ?? 누락 보완 (Missing Content Added)

| No | 누락 항목 | 보완 내용 | 프롬프트 근거 |
|----|----------|----------|-------------|
| M01 | 각 사업연도 소득 컬럼 | TBL_CORP_BASIC에 `biz_income` (각사업연도소득) 추가 | [법인 기본 정보] 입력란 |
| M02 | 비과세소득 컬럼 | TBL_CORP_BASIC에 `non_taxable_income` 추가 | 점검 0 ② 과세표준 산출공식 |
| M03 | 이월결손금 상세 테이블 | TBL_LOSS_CARRYFORWARD 신설 (발생연도별 잔액, 이월기간) | [법인 기본 정보], 점검 27 |
| M04 | 이월세액공제 상세 테이블 | TBL_CREDIT_CARRYFORWARD 신설 (조항별·연도별 미공제액) | [법인 기본 정보], 점검 22-6 [D] |
| M05 | R&D 비용 입력 테이블 | TBL_RD_EXPENSE 신설 (유형별·비목별 R&D비) | 점검 22-2 [B] |
| M06 | 결손금 소급공제 처리 | M4-10 모듈 신설, 비교 로직 포함 | 점검 0 (Loss Carryback) |
| M07 | 세무조정사항 재검토 | M4-11 모듈 신설 (손금불산입/익금불산입 오류 검토) | 점검 0 세무조정사항 |
| M08 | 업무용 승용차 비용 불산입 | M4-11에 통합 (법인세법 시행령 §50의2) | 점검 0 업무용 승용차 |
| M09 | 결산확정의 원칙 검증 | M3-06 모듈 신설 (신고조정/결산조정 구분 필터) | 점검 0 결산확정의 원칙 |
| M10 | 토지등 양도세 추가과세 | M4-12 모듈 신설 | 점검 1 법인 특화 추가 |
| M11 | 기업구조조정 과세이연 | M4-13 모듈 신설 | 점검 31 |
| M12 | 연결납세 특화 점검 | M4-14 모듈 신설 | 점검 32 |
| M13 | 환급가산금 이율 기준 테이블 | REF_REFUND_INTEREST_RATE 신설 | 점검 9-5, 국기법 시행규칙 §19의3 |
| M14 | 지점 소재지 테이블 | TBL_BRANCH_LOCATION 신설 | [법인 기본 정보] 지점 소재지 |
| M15 | 중간예납 상세 테이블 | TBL_INTERIM_TAX 신설 (납부일, 금액) | 점검 29, 점검 9-5 |
| M16 | 후발적 경정청구 처리 | M3-01에 후발적 사유 판단 로직 추가 | 사전확인, 국기법 §45의2② |
| M17 | 북한이탈주민 구분 | TBL_EMPLOYEE_DETAIL.emp_type에 '북한이탈주민' 추가 | 점검 16, 청년등 정의 |
| M18 | 사보공제 청년 기준 차이 | M4-03에 만15~29세 별도 기준 명시 | 점검 18 |
| M19 | 경력단절여성 상세 정보 | TBL_EMPLOYEE_DETAIL에 career_break_reason/rehire_date 추가 | 점검 15 ④, 점검 15-2 [B]④ |
| M20 | 졸업유예 상세 관리 | TBL_CORP_BASIC에 graduation_year, graduation_grace_period 추가 | 점검 9-2 ③ |
| M21 | 고용증대세액공제 경과규정 | M4-02에 제29조의7 경과규정 비교 로직 포함 | 점검 19, 점검 15-6 [D] |
| M22 | 기존 신고 공제·감면 상세 | TBL_EXISTING_DEDUCTION 신설 (항목별 기존 적용 내역) | 점검 9-4 |
| M23 | 수정신고·경정 이력 | TBL_CORP_BASIC에 amendment_history 추가 | 점검 9-4 ④ |
| M24 | 사후관리 리스크 평가 | OUT_RISK_ASSESSMENT 신설 | 점검 15 ⑤, 점검 15-6 [E] |

### ?? 개선사항 (Improvements)

| No | 개선 내용 | 효과 |
|----|----------|------|
| I01 | 에러코드 체계 확장 (V/C/B → V/C/B/L/W) | 법령검증(L), 경고(W) 유형 추가로 정밀한 검증 |
| I02 | 사업연도별 법령 버전 관리 체계 | REF_LAW_VERSION 테이블 추가, 연도별 적용 법령 자동 매칭 |
| I03 | 시뮬레이션 모듈 신설 | M7 모듈 - 다수 과세연도 일괄 시뮬레이션 |
| I04 | 감면/공제 적격성 사전 스크리닝 | M3에 적격성 점수(Score) 산출 기능 추가 |
| I05 | 이월공제 활용 계획 수립 | OUT_CARRYFORWARD_PLAN 테이블 - 향후 10년 이월공제 활용 시나리오 |
| I06 | 감사추적(Audit Trail) 테이블 | LOG_CALCULATION 신설 - 모든 산출 단계 로그 기록 |
| I07 | 입력 데이터 자동 검증 강화 | 교차검증(Cross-validation) 규칙 30건 추가 |
| I08 | 보고서 템플릿 다양화 | 요약보고서/상세보고서/납세자제출용 3종 분리 |
| I09 | 환급 시나리오별 현재가치 비교 | 소급공제 vs 이월공제 NPV 비교 기능 |
| I10 | 조합 탐색 알고리즘 최적화 | 브루트포스(2^n) → 가지치기(Branch & Bound) 적용 |
| I11 | 농특세 연쇄 영향 분석 | 공제 조합 변경 시 농특세 영향 자동 재계산 |
| I12 | 중간예납 환급가산금 별도 기산 | 본세와 중간예납의 환급가산금 기산일 분리 계산 |
| I13 | 프롬프트 오류 피드백 | 프롬프트 v1.3 내 소득세법 조문 참조 불일치(§56 vs §60) 식별 |
| I14 | 데이터 무결성 제약조건 강화 | FK 관계, UNIQUE 제약, CHECK 제약 명시 |
| I15 | API 인터페이스 설계 추가 | 외부 시스템 연계를 위한 REST API 엔드포인트 정의 |


### 🔄 v1.1 → v3.0 통합 내역

| No | 항목 | v1.1 내용 | v3.0 반영 위치 |
|----|------|----------|---------------|
| T01 | TBL_CORP_BASIC 소급공제 필드 | current_year_loss, prior_year_tax_paid, prior_year_tax_base 추가 | §3.1 No.39~41 |
| T02 | TBL_CORP_BASIC 세액 필드 | interim_prepaid_tax, withholding_tax 추가 | §3.1 No.37~38 |
| T03 | TBL_DIVIDEND_INCOME | 수입배당금 명세 입력 테이블 신설 | §3.14 |
| T04 | TBL_INVESTMENT_ASSET.install_location_zone | 설치장소 수도권구분 컬럼 추가 | §3.5 No.13 |
| T05 | REF_DIVIDEND_EXCLUSION | 수입배당금 익금불산입률 기준 테이블 신설 | §4.15 |
| T06 | REF_RD_MIN_TAX_EXEMPT | R&D 최저한세 배제율 테이블 신설 | §4.16 |
| T07 | M3-03 소재지 분기 로직 | 항목별 소재지 판단 기준 이원화 함수 | §7.7 |
| T08 | M5-03 최저한세 상세 | 최저한세 산출 + R&D 배제분 상세 계산 함수 | §7.8 |
| T09 | M4-09 수입배당금 상세 | 연도별·지분율별 익금불산입 산출 함수 | §7.9 |
| T10 | M4-10 소급공제 시뮬레이션 | 소급 vs 이월 NPV 비교 함수 | §7.10 |
| T11 | 상세 계산 공식 | 산출세액·고용·투자·감면·소급공제 공식 상세 | §8.5 |
| T12 | 부록 A | 오류지적사항 4건 검토 결과 보존 | §부록 A |

---

## 변경 이력 (v3.0 → v4.0)

### ❌ 오류 수정 (Errors Fixed) — 8건

| No | 구분 | v3.0 내용 | v4.0 수정 | 근거 |
|----|------|----------|----------|------|
| E08 | 농특세 비과세 항목 (§8.4 F40) | "통합고용(§29의8), R&D(§10), 통합투자(§24) 비과세" | **비과세 = 제6조(창업감면), 제7조(중소특별), 제10조(R&D)만.** 제29조의8·제24조는 과세 20% | 농특세법 §4③, REF_NONGTEUKSE 테이블 |
| E09 | 수입배당금 익금불산입률 (§6.4.8) | "지분율별 차등: 100%/80%/50%/30%" (4단계) | **2023년 개정법은 3단계:** 50%이상→100%, 30~50%미만→80%, 30%미만→30% | 법인세법 §18의2 (2022.12.31. 개정) |
| E10 | 최저한세 계산 기준 주석 (§7.8) | `max_deductible = computed_tax - min_tax` 주석 불명확 | **주석 보강:** "과세표준 × 최저한세율 = 최저한세액, 산출세액 - 최저한세액 = 공제가능한도" 명시 | 조특법 §132 |
| E11 | TBL_EMPLOYEE_MONTHLY 북한이탈주민 누락 | nk_defector_count 컬럼 없음 | `nk_defector_count DECIMAL(10,2)` 컬럼 추가 | 프롬프트 점검 16 청년등 정의 |
| E12 | 국고보조금 익금불산입 모듈 누락 | M4-11에 상세 로직 부재 | M4-11에 국고보조금 익금불산입(법인세법 §18①) 검토 로직 추가 | 프롬프트 점검 0 |
| E13 | 외국납부세액 상세 입력 테이블 누락 | TBL_CORP_BASIC.foreign_tax_paid는 BOOLEAN만 | **TBL_FOREIGN_TAX 신설** (국가별·소득종류별 외국소득금액, 외국납부세액) | 법인세법 §57 |
| E14 | 업무용 승용차 입력 테이블 누락 | M4-11에 통합 언급만 | **TBL_BUSINESS_VEHICLE 신설** (차량번호, 취득가, 운행기록부, 전용보험 등) | 법인세법 시행령 §50의2 |
| E15 | 세무조정계산서 입력 테이블 누락 | M4-11 기능 존재하나 입력 데이터 없음 | **TBL_TAX_ADJUSTMENT 신설** (조정항목, 조정금액, 손금/익금 구분) | 법인세법 §60 |

### ➕ 누락 보완 (Missing Content Added) — 12건

| No | 누락 항목 | 보완 내용 | 근거 |
|----|----------|----------|------|
| M25 | 접대비 한도 기준 테이블 | REF_ENTERTAINMENT_LIMIT 신설 (중소기업 우대 한도) | 법인세법 §25 |
| M26 | 업종별 감면 적격성 판단 테이블 | REF_INDUSTRY_ELIGIBILITY 신설 (KSIC 코드별 감면 적격성) | 조특법 §6·§7 |
| M27 | 가지급금 인정이자 입력 | TBL_CORP_BASIC + TBL_SHAREHOLDER_LOAN 신설 | 법인세법 시행령 §89 |
| M28 | 업무무관자산 차입금이자 입력 | TBL_CORP_BASIC + TBL_NON_BUSINESS_ASSET 신설 | 법인세법 §28 |
| M29 | 감가상각 의무 이행 추적 | TBL_INVESTMENT_ASSET에 actual_depreciation, required_depreciation 추가 | 조특법 §128⑨ |
| M30 | 자산 처분 추징 리스크 추적 | TBL_INVESTMENT_ASSET에 disposal_date, disposal_reason 추가 | 조특법 §146 |
| M31 | 환급 결정 예상일 입력 | TBL_CORP_BASIC에 expected_refund_decision_date 추가 | 국기법 §52 |
| M32 | NPV 할인율 기준 | REF_SYSTEM_PARAM 신설 (discount_rate 파라미터화) | §7.10 소급공제 NPV |
| M33 | 인구감소지역 갱신 프로세스 | 행정안전부 고시 연동 또는 수동 갱신 절차 명시 | 프롬프트 점검 12 |
| M34 | 환급가산금 이율 갱신 프로세스 | 국기법 시행규칙 §19의3 이율 변동 시 갱신 프로세스 명시 | M6-02 |
| M35 | 한국표준산업분류(KSIC) 코드 테이블 | REF_KSIC_CODE 신설 (코드, 업종명, 감면 적격성 매핑) | 법인 기본 정보 |
| M36 | 다수 과세연도 중소기업 판단 | 연도별 매출액·독립성·졸업유예 재판단 로직 추가 | 점검 9-2 |

### 📊 법인사업자 추가 필요 정보 — 15개 항목

#### TBL_CORP_BASIC 확장 (7개 컬럼)
| 항목 | 컬럼명 | 데이터타입 | 필수 | 사유 |
|------|--------|-----------|------|------|
| 외국소득 총액 | foreign_income_total | BIGINT | N | 외국납부세액공제 한도 계산 (법인세법 §57) |
| 가지급금 잔액 | shareholder_loan_balance | BIGINT | N | 인정이자 익금산입 (시행령 §89) |
| 업무무관자산 가액 | non_business_asset_value | BIGINT | N | 차입금이자 손금불산입 (법인세법 §28) |
| 관련 차입금이자 | related_interest | BIGINT | N | 손금불산입 재검토 |
| 환급 결정 예상일 | expected_refund_decision_date | DATE | N | 환급가산금 종료일 |
| 접대비 지출액 | entertainment_expense | BIGINT | N | 한도 초과 검토 (법인세법 §25) |
| 국고보조금 수령액 | government_subsidy | BIGINT | N | 익금불산입 검토 (법인세법 §18①) |

#### 신규 입력 테이블 (7개) → §3.15~§3.21
| 테이블 | 목적 | 근거 |
|--------|------|------|
| TBL_FOREIGN_TAX | 외국납부세액 상세 (국가별·소득종류별) | 법인세법 §57, E13 |
| TBL_BUSINESS_VEHICLE | 업무용 승용차 (운행기록부·전용보험) | 시행령 §50의2, E14 |
| TBL_TAX_ADJUSTMENT | 세무조정계산서 (조정항목·금액·구분) | 법인세법 §60, E15 |
| TBL_ENTERTAINMENT | 접대비 상세 | 법인세법 §25, M25 |
| TBL_GOVERNMENT_SUBSIDY | 국고보조금 수령 내역 | 법인세법 §18①, E12 |
| TBL_SHAREHOLDER_LOAN | 가지급금 잔액·인정이자 | 시행령 §89, M27 |
| TBL_NON_BUSINESS_ASSET | 업무무관자산·관련 차입금이자 | 법인세법 §28, M28 |

#### 신규 기준정보 테이블 (4개) → §4.17~§4.20
| 테이블 | 목적 | 근거 |
|--------|------|------|
| REF_INDUSTRY_ELIGIBILITY | KSIC 코드별 감면 적격성 | 조특법 §6·§7, M26 |
| REF_ENTERTAINMENT_LIMIT | 접대비 한도 (중소기업 우대) | 법인세법 §25, M25 |
| REF_SYSTEM_PARAM | NPV 할인율, 환급결정소요일 등 시스템 파라미터 | M32 |
| REF_KSIC_CODE | 한국표준산업분류 코드·업종명 | M35 |

### 🔍 외부 참조 데이터 구분 — 10개 항목

#### 법령 기준 데이터 (정부 고시·법령 연동)
| 데이터 | 출처 | 갱신 주기 | 테이블 |
|--------|------|----------|--------|
| 법인세율 | 법인세법 §55 | 세법개정 시 | REF_CORP_TAX_RATE_HISTORY |
| 최저한세율 | 조특법 §132 | 세법개정 시 | REF_MIN_TAX_RATE |
| 통합고용 공제금액 | 조특법 시행령 별표 | 매년 | REF_EMPLOYMENT_CREDIT |
| 환급가산금 이율 | 국기법 시행규칙 §19의3 | 분기별 | REF_REFUND_INTEREST_RATE |
| 인구감소지역 목록 | 행정안전부 고시 | 연 1회 | REF_DEPOPULATION_AREA |
| 수도권 지역 구분 | 수도권정비계획법 §2 | 법령개정 시 | REF_CAPITAL_ZONE |
| 한국표준산업분류 | 통계청 KSIC | 5년 주기 | REF_KSIC_CODE *(v4.0 신규)* |

#### 내부 설정 데이터 (시스템 파라미터)
| 데이터 | 기본값 | 설정 가능 | 테이블 |
|--------|--------|----------|--------|
| NPV 할인율 | 3% | 가능 | REF_SYSTEM_PARAM *(v4.0 신규)* |
| 환급 결정 예상 소요일 | 90일 | 가능 | REF_SYSTEM_PARAM *(v4.0 신규)* |
| 절사 정책 | TRUNCATE | 불가 | 시스템 상수 (반올림 절대 금지) |

#### 업종별 기준 데이터 (법령 해석 필요)
| 데이터 | 출처 | 테이블 |
|--------|------|--------|
| 감면 대상/제외 업종 | 조특법 §6·§7 | REF_INDUSTRY_ELIGIBILITY *(v4.0 신규)* |
| 접대비 한도 | 법인세법 §25 | REF_ENTERTAINMENT_LIMIT *(v4.0 신규)* |
| R&D 최저한세 배제율 | 조특법 §132② | REF_RD_MIN_TAX_EXEMPT (기존) |

### ⚡ 개선사항 (Improvements) — 10건

| No | 개선 내용 | 효과 |
|----|----------|------|
| I16 | 순환 참조 해결 (과세표준 변동 → 최저한세 재계산 루프) | 정확한 공제 가능 한도 산출 |
| I17 | 다수 과세연도 일괄 시뮬레이션 강화 (연도별 중소기업 재판단) | 복수 연도 정확도 향상 |
| I18 | 이월공제 최적 활용 시나리오 정교화 (향후 소득 예측) | 이월 vs 소급 비교 정확도 향상 |
| I19 | 감면·공제 조합 탐색 가지치기 조건 상세화 | 대규모 조합 탐색 성능 향상 |
| I20 | 농특세 연쇄 영향 자동 재계산 트리거 | 실질 환급액 정확도 향상 |
| I21 | 사후관리 리스크 정량화 (추징액 + 이자상당가산액 자동 계산) | 의사결정 지원 강화 |
| I22 | 보고서 템플릿 3종 구체적 양식 작성 | 즉시 활용 가능 산출물 |
| I23 | 입력 데이터 교차검증 규칙 15건 추가 (총 24건) | 입력 오류 사전 차단 |
| I24 | 법령 버전 자동 매칭 로직 (사업연도 입력 시 자동 로드) | 사용자 편의성 향상 |
| I25 | API 인터페이스 설계 구체화 (엔드포인트 정의) | 외부 시스템 연계 용이 |


## 변경 이력 (v4.0 외부검토 반영 — v4.0r1)

> 외부 검토(제미나이 프로 1차·2차)에서 도출된 지적사항을 분석하여, 프롬프트 v1.3 근거가 확인된 항목을 반영하였습니다.

### 외부검토 지적사항 판단 요약

#### ❌ 오류 수정 (3건 — 모두 타당)

| No | 구분 | 지적 내용 | 판단 | 반영 | 근거 |
|----|------|----------|------|------|------|
| E16 | 통합투자 임대자산 배제 | 임대사업자의 임대용 자산 제외 로직 누락 | **타당** | TBL_INVESTMENT_ASSET에 is_rental_asset, is_used_asset 추가 | 프롬프트 점검 10 "임대사업자의 임대용 자산 (2024.12.31. 세법개정 추가)" 명시 |
| E17 | R&D 위탁연구비 예외 | 위탁연구비는 전담부서 없이도 공제 가능 | **타당** | TBL_RD_EXPENSE에 is_commissioned, commissioned_lab_name 추가 | 조특법 시행령 §9, 프롬프트 점검 22-2에 위탁연구비 언급 |
| E18 | 외국납부세액 간접공제 | 자회사 배당 시 간접외국납부세액공제 누락 | **타당** | TBL_FOREIGN_TAX 확장 + M4-07 로직 보강 | 프롬프트 점검 26 "간접외국납부세액공제 (자회사 배당 시)" 명시 |

#### ➕ 누락 보완 (8건 — 타당 6건, 부분타당 2건)

| No | 지적 내용 | 판단 | 반영 | 근거 |
|----|----------|------|------|------|
| M37 | 재해손실세액공제 | **타당** | TBL_DISASTER_LOSS + M4-15 신설 | 점검 9-3 "재해손실세액공제(제58조)" 명시 |
| M38 | 연결납세 자회사 정보 | **타당** | TBL_CONSOLIDATED_SUBSIDIARY 신설 | 점검 32 연결납세 구조, M4-14 데이터 부재 |
| M39 | 벤처확인 3년 제한 강화 | **타당** | TBL_STARTUP_INFO 검증 로직 보강 | 점검 20-2 [B]③ "창업 후 3년 이내 확인 시" |
| M40 | 무형자산 투자 구분 | **타당** | TBL_INVESTMENT_ASSET에 asset_class_code 추가 | 점검 10 "특정 무형자산(산업재산권, 업무용 소프트웨어 등)" |
| M41 | 유보 소득 처분 추적 | **부분타당** | TBL_TAX_ADJUSTMENT에 reserve_type, reserve_balance 추가. 전체 자적을표 연동은 과잉 | 점검 0 세무조정 |
| M42 | 감가상각비 시부인 | **부분타당** | TBL_DEPRECIATION_ADJUST 신설 (핵심 로직만). 결산확정 원칙상 추가 계상은 불가하나, 한도초과 이월 추인(신고조정)은 경정청구 대상 | 점검 0 결산확정 원칙 |
| M43 | 경정청구 불가 사유 검증 | **타당** | M3-01 사전점검에 경정청구 불가 사유(분식회계 등) 검증 추가 | 프롬프트 "경정청구 자체가 불가능한 경우" 명시 |
| M44 | 고용유지 퇴사 예외 사유 | **타당** | TBL_EMPLOYEE_DETAIL에 resign_exception_code 추가 | 점검 15-6 [E] 사후관리 |

#### 📊 추가 필요 정보 (10개 → 9개 반영, 1개 기각)

| 항목 | 판단 | 사유 |
|------|------|------|
| is_rental_asset | ✅ 반영 | 2024 세법개정 명시 |
| is_used_asset | ✅ 반영 | 프롬프트 점검 10 "중고품" 명시 |
| 간접공제 관련 4개 컬럼 | ✅ 반영 | 프롬프트 점검 26 근거 |
| disaster_loss 관련 | ✅ 반영 | 점검 9-3 근거 |
| is_controlling_corp | ✅ 반영 | 점검 32 근거 |
| commissioned_lab_name | ✅ 반영 | 위탁연구비 적격성 |
| reserve_total → reserve_balance | ⚠️ 축소 반영 | 핵심만 |
| resign_exception_code | ✅ 반영 | 점검 15-6 [E] 근거 |

#### 🔍 외부 참조 데이터 (4개 → 2개 반영, 2개 기각)

| 테이블 | 판단 | 사유 |
|--------|------|------|
| REF_EXCHANGE_RATE | ✅ 반영 | 외국납부세액 환율 적용 필수 |
| REF_DEEMED_INTEREST_RATE | ✅ 반영 | 인정이자율 기준 연동 |
| REF_SME_INDUSTRY_SCOPE | ❌ 기각 | REF_INDUSTRY_ELIGIBILITY(v4.0 §4.17)과 중복. 기존 테이블에 is_sme_eligible 컬럼 추가로 해결 |
| REF_CONSOLIDATED_TAX_RATE | ❌ 기각 | 연결납세 세율은 일반 법인세율(§55)과 동일. 별도 세율 테이블 불필요 |

#### 2차(사고모드) 추가 지적 판단

| No | 지적 내용 | 판단 | 사유 |
|----|----------|------|------|
| E17(2차) | 청년 판단 시점 분리 | **이미 반영** | v4.0 §7.1 M3-04 step 5에서 2024이전/2025이후 분기 처리, L02 검증 규칙 존재 |
| M39(2차) | 유보 추인 자동화 | 1차 M42와 통합 | TBL_DEPRECIATION_ADJUST로 핵심 처리 |
| M40(2차) | 이자상당가산액 정량화 | **이미 반영** | v4.0 §7.14 I21 사후관리 리스크 정량화에 이자상당가산액 포함 |


## 목차

1. [시스템 개요](#1-시스템-개요)
2. [기능 분할도 (Functional Decomposition Diagram)](#2-기능-분할도-functional-decomposition-diagram) *(v4.0r1 전면 개편)*
3. [테이블 설계 — 입력 테이블](#3-테이블-설계--입력-테이블) (v2.0: 6개 테이블 신규)
4. [테이블 설계 — 기준정보 테이블](#4-테이블-설계--기준정보-테이블) (v2.0: 5개 테이블 신규)
5. [테이블 설계 — 출력(산출) 테이블](#5-테이블-설계--출력산출-테이블) (v2.0: 4개 테이블 신규/보완)
6. [단계별 업무처리 절차서](#6-단계별-업무처리-절차서) (v2.0: 전면 보강)
7. [개별 기능 상세설계](#7-개별-기능-상세설계) (v2.0: 6개 함수 신규/보강)
8. [계산 공식 정의서](#8-계산-공식-정의서) (v2.0: 환급가산금·농특세 보강)
9. [검증 규칙 및 제약조건](#9-검증-규칙-및-제약조건) (v2.0: L/W 유형 추가, 교차검증 신규)
10. [용어 정의](#10-용어-정의) (v2.0: 15개 용어 추가)
11. [프롬프트 대비 교차검증 결과](#11-프롬프트-대비-교차검증-결과) (v2.0 신규)
12. [부록 A: v1.1 오류지적사항 검토 결과](#부록-a-v11-오류지적사항-검토-결과) (v1.1 통합 기록)

---

## 1. 시스템 개요

### 1.1 목적

법인사업자의 법인세 경정청구 시 **환급액을 극대화**하기 위한 AI 점검 시스템을 개발한다. 법인 기본 정보, 고용 현황, 투자 내역 등 입력자료를 기반으로 적용 가능한 공제·감면 항목을 자동 점검하고, 상호배제 규칙과 최저한세를 반영한 최적 조합을 산출하여 최종 환급액을 계산한다.

### 1.2 적용 범위

| 구분 | 내용 |
|------|------|
| 대상 세목 | 법인세 (법인세법) |
| 대상 납세자 | 법인사업자 (내국법인) |
| 경정청구 근거 | 국세기본법 제45조의2 (일반/후발적) |
| 대상 공제·감면 | 조특법 제6조, 제7조, 제10조, 제24조, 제29조의7(경과규정), 제29조의8, 제30조의4 등 |
| 추가 점검 | 외국납부세액공제, 수입배당금 익금불산입, 이월결손금, 결손금 소급공제, 중간예납, 세무조정 재검토, 업무용 승용차, 기업구조조정, 연결납세, 토지등 양도세 추가과세, 지방소득세 등 |

### 1.3 핵심 설계 원칙

- **사업연도별 법령 버전 적용**: 세율, 공제율, 적용기한 등은 경정청구 대상 사업연도 기준
- **절사(Truncate) 원칙**: 모든 금액 10원 미만 절사, 비율·인원수 소수점 셋째 자리 절사, 환급가산금 1원 미만 절사
- **반올림 절대 금지**: 모든 단계에서 TRUNCATE 사용, ROUND 사용 금지
- **법인 전체 합산**: 상시근로자 수는 법인 단위 전 사업장 합산
- **본점 소재지 간주 규정**: 본점이 수도권이면 모든 사업장을 수도권으로 간주 (제7조), 단 제24조는 실제 투자 장소 기준
- **적용순서 준수**: 법인세법 제59조 — 감면 → 이월불가 공제 → 이월가능 공제
- **신고조정/결산조정 구분**: 결산조정 항목은 경정청구 대상에서 제외 (법인세법 제40조)
- **경정청구 가능/불가 사전 필터**: 불가능 항목을 사전에 차단하여 오류 방지

### 1.4 법인세 과세 구조 핵심 전제

> 프롬프트 [핵심 전제] 및 [경정청구 가능/불가능 항목 요약] 기반

| 항목 | 법인세 | 소득세(참고 비교) |
|------|--------|----------------|
| 과세단위 | 법인 1개 단위 (전 사업장 합산) | 사업장별 |
| 세율 | 9~24% (4단계 초과누진, 2023~2025) | 6~45% |
| 최저한세 | 과세표준 기준 (중소 7%, 중견 10~12%, 대 17%) | 산출세액 기준 (35%/45%) |
| 본점 간주 | 본점 수도권이면 전 사업장 수도권 간주 | 사업장별 각각 판단 |
| 소득공제 | 없음 (손금·익금 조정) | 있음 |
| 이월결손금 | 소득의 80% 한도 (중소 100%), 15년 이월 | 소득의 80% 한도, 15년 이월 |
| 적용순서 근거법 | **법인세법 제59조** | 소득세법 제56조 |
| 환급가산금 | 법인세 **익금불산입** (법인세법 §18④) | 비과세소득 (열거주의) |

**경정청구 가능/불가 구분**:

| 구분 | 항목 예시 |
|------|----------|
| **경정청구 가능** (신고조정) | 세액감면 신규/변경, 세액공제 추가, 공제방식 변경(R&D), 일시상각충당금, 익금불산입 누락, 외국납부세액공제 방식 변경, 이월결손금 오류 수정 |
| **경정청구 불가** (결산조정) | 감가상각비 추가 계상, 퇴직급여충당금 추가, 대손충당금 추가, 감가상각 방법 변경, 결산서 변경 필요 항목 |
| **경정청구 자체 불가** | 법정신고기한 후 5년 경과, 결산확정 원칙 위반, 과세관청 직권경정 시 과소신고분 감면 (조특법 §128③) |

---

## 2. 기능 분할도 (Functional Decomposition Diagram) — v4.0r1 전면 개편

> **목적**: 전체 시스템을 모듈 단위로 분해하고, 각 모듈의 세부 기능을 계층적(Level 0~3)으로 나열
> **표기 규칙**: `[Lv0] 시스템` → `[Lv1] 대모듈(M1~M7)` → `[Lv2] 서브모듈(M1-01 등)` → `[Lv3] 세부 처리 단계`

### 2.1 전체 시스템 계층 구조도

```
[Lv0] 법인세 경정청구 환급액 산출 시스템 (v4.0r1)
│
├─[Lv1] M1. 입력 관리 ──────────────────────────────────────────────────
│  ├─[Lv2] M1-01 법인 기본 정보 입력
│  ├─[Lv2] M1-02 대표자/임원/가족 정보 입력
│  ├─[Lv2] M1-03 상시근로자 상세 명부 입력
│  ├─[Lv2] M1-04 투자 자산 명세 입력
│  ├─[Lv2] M1-05 창업/감면 관련 정보 입력
│  ├─[Lv2] M1-06 R&D 비용 상세 입력 ★v2.0
│  ├─[Lv2] M1-07 이월결손금 상세 입력 ★v2.0
│  ├─[Lv2] M1-08 이월세액공제 상세 입력 ★v2.0
│  ├─[Lv2] M1-09 기존 신고 공제·감면 상세 ★v2.0
│  ├─[Lv2] M1-10 지점 소재지 정보 입력 ★v2.0
│  ├─[Lv2] M1-11 중간예납 상세 입력 ★v2.0
│  └─[Lv2] M1-12 수입배당금 명세 입력 ★v3.0
│
├─[Lv1] M2. 기준정보 관리 ──────────────────────────────────────────────
│  ├─[Lv2] M2-01 법인세율 관리 (REF_CORP_TAX_RATE_HISTORY)
│  ├─[Lv2] M2-02 최저한세율 관리 (REF_MIN_TAX_RATE)
│  ├─[Lv2] M2-03 공제 금액/율 관리 (REF_EMPLOYMENT_CREDIT 등)
│  ├─[Lv2] M2-04 상호배제 매트릭스 관리 (REF_MUTUAL_EXCLUSION)
│  ├─[Lv2] M2-05 수도권 지역 구분 관리 (REF_CAPITAL_ZONE)
│  ├─[Lv2] M2-06 환급가산금 이율 관리 ★v2.0 (REF_REFUND_INTEREST_RATE)
│  ├─[Lv2] M2-07 법령 버전 관리 ★v2.0 (REF_LAW_VERSION)
│  ├─[Lv2] M2-08 외부 참조 데이터 갱신 (부록 C 절차 연동)
│  │  ├─[Lv3] 환율 정보 갱신 (REF_EXCHANGE_RATE) ★v4.0r1
│  │  ├─[Lv3] 인정이자율 갱신 (REF_DEEMED_INTEREST_RATE) ★v4.0r1
│  │  ├─[Lv3] 인구감소지역 갱신 (REF_DEPOPULATION_AREA)
│  │  └─[Lv3] KSIC 코드 갱신 (REF_KSIC_CODE) ★v4.0
│  └─[Lv2] M2-09 시스템 파라미터 관리 ★v4.0 (REF_SYSTEM_PARAM)
│
├─[Lv1] M3. 사전 점검 / 검증 (STEP 0~1) ──────────────────────────────
│  ├─[Lv2] M3-00 경정청구 불가 사유 사전 검증 ★v4.0r1 (M43)
│  │  ├─[Lv3] 0-0a 법정신고기한 후 5년 경과 여부 검증
│  │  ├─[Lv3] 0-0b 분식회계(사실과 다른 회계처리) 해당 여부
│  │  ├─[Lv3] 0-0c 직권경정 시 감면 제한 (조특법 §128③)
│  │  └─[Lv3] 0-0d 결산조정 항목 사전 배제 필터
│  ├─[Lv2] M3-01 경정청구 기한 점검
│  │  ├─[Lv3] 0-1 법정신고기한 산정 (사업연도종료 + 3개월)
│  │  ├─[Lv3] 0-2 경정청구 마감일 산출 (법정신고기한 + 5년)
│  │  └─[Lv3] 0-3 후발적 경정청구 사유 확인 ★v2.0
│  ├─[Lv2] M3-02 중소기업 해당 여부 판단
│  │  ├─[Lv3] 0-4 매출액 기준 판단 (업종별 상한)
│  │  ├─[Lv3] 0-5 독립성 기준 판단 (상호출자·자산총액)
│  │  ├─[Lv3] 0-6 졸업유예 기간 판단 ★v2.0 (3년/5년 분기)
│  │  └─[Lv3] 0-7 연도별 중소기업 재판단 ★v4.0 (M7-01 연동)
│  ├─[Lv2] M3-03 소재지 구분 판단
│  │  ├─[Lv3] 0-8 본점 소재지 → 수도권 구분 (REF_CAPITAL_ZONE)
│  │  ├─[Lv3] 0-9 본점 간주 규정 적용 (제7조 전사업장 수도권 간주)
│  │  ├─[Lv3] 0-10 투자자산 소재지 별도 판단 (제24조 실제 설치장소 기준)
│  │  └─[Lv3] 0-11 인구감소지역 해당 여부 (2025년~ 창업감면용) ★v2.0
│  ├─[Lv2] M3-04 상시근로자 수 산정
│  │  ├─[Lv3] step1 제외 대상 필터링 (임원, 최대주주 친족, 일용직, 단시간)
│  │  ├─[Lv3] step2 월별 상시근로자 수 집계
│  │  ├─[Lv3] step3 연평균 상시근로자 수 산정 (소수점 2자리)
│  │  ├─[Lv3] step4 청년등/일반 분류
│  │  ├─[Lv3] step5 청년 연령 판단 (2024이전: 과세연도말 / 2025이후: 근로계약체결시)
│  │  ├─[Lv3] step6 병역가산 적용 (최대 6년)
│  │  └─[Lv3] step7 증감분 산정 (해당-직전, 청년등증가분·일반증가분)
│  ├─[Lv2] M3-05 입력 데이터 정합성 검증
│  │  ├─[Lv3] 필수 값 검증 (V01~V16)
│  │  ├─[Lv3] 범위·논리 검증
│  │  └─[Lv3] 교차검증 (X01~X13)
│  └─[Lv2] M3-06 결산확정 원칙 검증 ★v2.0
│     ├─[Lv3] 신고조정 가능 항목 식별 → 경정청구 전략에 포함
│     └─[Lv3] 결산조정 항목 → 경정청구 대상에서 자동 배제
│
├─[Lv1] M4. 개별 공제·감면 산출 (STEP 2) ─────────────────────────────
│  │
│  ├─── [세액감면 그룹] ──────────────────────────
│  ├─[Lv2] M4-04 창업중소기업 세액감면 (조특법 §6)
│  │  ├─[Lv3] 2C-1 창업 요건 확인 (소재지, 업종, 승계, 법인전환)
│  │  ├─[Lv3] 2C-2 감면율 결정 (청년/비청년/벤처/지역별 50~100%)
│  │  │         └ 벤처확인 3년 검증 ★v4.0r1 (M39)
│  │  ├─[Lv3] 2C-3 감면 기간 확인 (최초소득+4년 = 5년)
│  │  ├─[Lv3] 2C-4 감면세액 산출 (산출세액×소득비율×감면율)
│  │  ├─[Lv3] 2C-5 중복적용 연도별 분기 ★v2.0
│  │  └─[Lv3] 2C-6 인구감소지역 100% 감면 ★v2.0
│  ├─[Lv2] M4-05 중소기업 특별세액감면 (조특법 §7)
│  │  ├─[Lv3] 2D-1 업종·규모·소재지별 감면율 결정 (5~30%)
│  │  ├─[Lv3] 2D-2 감면세액 산출
│  │  ├─[Lv3] 2D-3 감면한도 적용 (1억 - 감소인원×500만)
│  │  └─[Lv3] 2D-4 우대 감면율 확인 (10년+소득1억이하+성실→×110%)
│  │
│  ├─── [세액공제 그룹 — 이월공제 가능] ──────────
│  ├─[Lv2] M4-01 통합투자세액공제 (조특법 §24) — v4.0r1 E16 보강
│  │  ├─[Lv3] 2B-0 제외 대상 사전 필터 ★v4.0r1
│  │  │         ├ 중고품 배제 (is_used_asset)
│  │  │         ├ 임대용 자산 배제 (is_rental_asset, 2024개정)
│  │  │         ├ 소비성 서비스업 / 부동산 임대업 배제
│  │  │         └ 운용리스 배제
│  │  ├─[Lv3] 2B-1 대상 자산 분류 (유형자산 + 무형자산(SW/IP) ★v4.0r1 M40)
│  │  ├─[Lv3] 2B-2 수도권 제한 확인 (설치장소 기준, 본점간주 X)
│  │  ├─[Lv3] 2B-3 기본공제 산출 (투자금액×기본공제율)
│  │  ├─[Lv3] 2B-4 추가공제 산출 (당해-직전3년평균)×추가공제율
│  │  └─[Lv3] 2B-5 총 공제세액 합산
│  ├─[Lv2] M4-02 통합고용세액공제 (조특법 §29의8)
│  │  ├─[Lv3] 2A-1 전체 증가분 확인 (≤0 → 종료)
│  │  ├─[Lv3] 2A-2 청년등 증가분 산정
│  │  ├─[Lv3] 2A-3 일반 증가분 산정 (대기업 일반=0원) ★v2.0
│  │  ├─[Lv3] 2A-4 기본 공제세액 (규모·지역·유형별 단가)
│  │  ├─[Lv3] 2A-5~7 추가 공제 (경력단절/정규직전환/육아복귀)
│  │  ├─[Lv3] 2A-8 총 공제세액 합산
│  │  └─[Lv3] 2A-9 제29조의7 경과규정 비교 ★v2.0
│  ├─[Lv2] M4-06 연구인력개발비 세액공제 (조특법 §10)
│  │  ├─[Lv3] 2E-1 R&D 유형 구분 (일반/신성장/국가전략)
│  │  ├─[Lv3] 2E-2 증가분 방식 산출
│  │  ├─[Lv3] 2E-3 당기분 방식 산출
│  │  ├─[Lv3] 2E-4 유리한 방식 선택 (경정청구로 변경 가능)
│  │  ├─[Lv3] 2E-5 최저한세 배제액 산출 ★v2.0
│  │  └─[Lv3] 2E-6 위탁연구비 예외 처리 ★v4.0r1 (E17)
│  ├─[Lv2] M4-03 사회보험료세액공제 (조특법 §30의4)
│  │  ├─[Lv3] 2F-1 대상자 확인 (고용증가 중 사회보험 신규가입)
│  │  └─[Lv3] 2F-2 청년 기준 확인 (만15~29세 — 통합고용과 상이) ★v2.0
│  │
│  ├─── [법인세법 고유 세액공제 그룹] ──────────────
│  ├─[Lv2] M4-07 외국납부세액공제 (법인세법 §57) — v4.0r1 E18 간접공제 보강
│  │  ├─[Lv3] 2G-1 직접 외국납부세액 집계 (국가별·소득별)
│  │  ├─[Lv3] 2G-2 간접외국납부세액 계산 ★v4.0r1 (지분율≥25% 자회사 배당)
│  │  ├─[Lv3] 2G-3 공제 한도 산정 (산출세액×국외소득/과세표준)
│  │  ├─[Lv3] 2G-4 공제 방식 비교 (세액공제 vs 손금산입, 간접공제 포함)
│  │  └─[Lv3] 2G-5 한도 초과분 이월 (5년) ★v4.0r1
│  ├─[Lv2] M4-15 재해손실세액공제 (법인세법 §58) ★v4.0r1 (M37)
│  │  ├─[Lv3] 2L-1 재해 발생 확인
│  │  ├─[Lv3] 2L-2 상실 비율 검증 (≥20%)
│  │  ├─[Lv3] 2L-3 공제세액 산출 (미납부법인세×상실비율)
│  │  ├─[Lv3] 2L-4 한도 적용 (MIN(공제액, 상실자산가액))
│  │  └─[Lv3] 2L-5 기존 적용 여부 확인
│  │
│  ├─── [과세표준 영향 그룹] ────────────────────
│  ├─[Lv2] M4-08 이월결손금 재검토 (법인세법 §13)
│  ├─[Lv2] M4-09 수입배당금 익금불산입 (법인세법 §18의2)
│  │  ├─[Lv3] 2H-1 지분율 확인
│  │  ├─[Lv3] 2H-2 익금불산입률 결정 (2023년 개정: 3단계 / 2022년 이전: 구법)
│  │  ├─[Lv3] 2H-3 익금불산입 금액 산출
│  │  └─[Lv3] 2H-4 과세표준 변동 영향 분석
│  ├─[Lv2] M4-10 결손금 소급공제 검토 ★v2.0 (법인세법 §72)
│  │  ├─[Lv3] 2I-1 소급공제 요건 확인 (중소기업, 직전1년)
│  │  ├─[Lv3] 2I-2 소급 환급세액 산출
│  │  └─[Lv3] 2I-3 이월공제 vs 소급공제 NPV 비교
│  │
│  ├─── [세무조정 재검토 그룹] ──────────────────
│  ├─[Lv2] M4-11 세무조정 재검토 ★v2.0 — v4.0 보강
│  │  ├─[Lv3] 손금불산입 오류 검토 (접대비 한도, 업무무관자산 이자)
│  │  ├─[Lv3] 익금불산입 누락 검토 (국고보조금, 수입배당금)
│  │  ├─[Lv3] 가지급금 인정이자 익금산입 ★v4.0
│  │  ├─[Lv3] 업무용 승용차 비용 불산입 ★v4.0
│  │  └─[Lv3] 접대비 한도 초과 ★v4.0
│  ├─[Lv2] M42 감가상각 시부인 이월 추인 검토 ★v4.0r1
│  │  ├─[Lv3] 전기 한도초과액(유보) 잔액 확인
│  │  ├─[Lv3] 당기 시인부족액 확인
│  │  └─[Lv3] 추인 누락 여부 판단 → 손금산입(△유보) 경정청구 대상
│  │
│  ├─── [법인 특화 점검 그룹] ──────────────────
│  ├─[Lv2] M4-12 토지등 양도세 추가과세 ★v2.0 (법인세법 §55의2)
│  ├─[Lv2] M4-13 기업구조조정 과세이연 ★v2.0 (법인세법 §44~47)
│  └─[Lv2] M4-14 연결납세 특화 점검 ★v2.0 (법인세법 §76의8)
│     ├─[Lv3] 연결 과세표준 합산 시뮬레이션
│     ├─[Lv3] 연결집단 내 이월결손금 상계
│     └─[Lv3] 자회사 공제·감면 개별 산정 (TBL_CONSOLIDATED_SUBSIDIARY ★v4.0r1)
│
├─[Lv1] M5. 최적 조합 산출 (STEP 3) ──────────────────────────────────
│  ├─[Lv2] M5-01 상호배제 규칙 검증
│  │  ├─[Lv3] 3-1 제127조 제4항 중복적용 규칙 필터
│  │  ├─[Lv3] 3-2 연도별 중복 규칙 분기 (2024이전/2025이후)
│  │  └─[Lv3] 3-3 유효 조합 목록 생성
│  ├─[Lv2] M5-02 최적 조합 탐색 (그리디+가지치기)
│  │  ├─[Lv3] 3-4 그룹A(감면중심) 시나리오 산출
│  │  ├─[Lv3] 3-5 그룹B(공제중심) 시나리오 산출
│  │  ├─[Lv3] 3-6 실질 환급액 극대화 비교 엔진
│  │  └─[Lv3] 3-7 순환 참조 해결 루프 ★v4.0 (I16) — 최대 5회 반복, 1원 수렴
│  ├─[Lv2] M5-03 최저한세 적용
│  │  ├─[Lv3] 3-8 최저한세액 산출 (과세표준 × 최저한세율)
│  │  ├─[Lv3] 3-9 공제 가능 한도 산출 (산출세액 - 최저한세액)
│  │  └─[Lv3] 3-10 최저한세 배제 항목 처리 (R&D·국가전략·재해손실 등)
│  ├─[Lv2] M5-04 농특세 적용
│  │  ├─[Lv3] 3-11 항목별 과세/비과세 판정 (REF_NONGTEUKSE)
│  │  ├─[Lv3] 3-12 농특세 20% 산출
│  │  └─[Lv3] 3-13 실질 환급액 보정 (공제×80% + 비과세분 100%)
│  └─[Lv2] M5-05 세액 적용순서 처리
│     ├─[Lv3] 3-14 ① 세액감면 (면제 포함)
│     ├─[Lv3] 3-15 ② 이월공제 불가 세액공제
│     ├─[Lv3] 3-16 ③ 이월공제 가능 세액공제 (이월분 먼저)
│     └─[Lv3] 3-17 농특세 연쇄 영향 재계산 ★v4.0 (I20)
│
├─[Lv1] M6. 최종 환급액 산출 및 보고 (STEP 4~5) ─────────────────────
│  ├─[Lv2] M6-01 환급액 비교표 생성
│  │  ├─[Lv3] 4-1 기존 신고세액 집계
│  │  ├─[Lv3] 4-2 경정 후 세액 산출
│  │  └─[Lv3] 4-3 차액(환급액) 산정 (법인세 + 농특세 + 지방소득세)
│  ├─[Lv2] M6-02 환급가산금 산출
│  │  ├─[Lv3] 4-4 본세 환급가산금 (법정신고기한 다음날 ~ 환급결정일)
│  │  ├─[Lv3] 4-5 중간예납 환급가산금 (납부일 다음날 ~ 환급결정일)
│  │  └─[Lv3] 4-6 이자율 적용 (REF_REFUND_INTEREST_RATE 시기별 변동)
│  ├─[Lv2] M6-03 지방소득세 환급 안내
│  │  └─[Lv3] 4-7 법인세 환급액 × 10% 안내 + 별도 청구 기한
│  └─[Lv2] M6-04 최종 보고서 생성 (3종)
│     ├─[Lv3] 5-1 보고서A: 경영진용 요약 (1~2페이지)
│     ├─[Lv3] 5-2 보고서B: 세무대리인용 상세 (공제·감면 산출 근거)
│     └─[Lv3] 5-3 보고서C: 국세청 제출용 (경정청구서 양식)
│
├─[Lv1] M7. 시뮬레이션 ★v2.0 ────────────────────────────────────────
│  ├─[Lv2] M7-01 다수 과세연도 일괄 시뮬레이션
│  │  ├─[Lv3] 연도별 중소기업 재판단 ★v4.0 (매출액·독립성·졸업유예)
│  │  ├─[Lv3] 연도별 적용 법령 버전 자동 로드 (REF_LAW_VERSION)
│  │  └─[Lv3] 연도간 이월공제 연계 분석
│  ├─[Lv2] M7-02 이월공제 활용 시나리오 비교
│  │  ├─[Lv3] 향후 10년 이월공제 최적 활용 계획
│  │  └─[Lv3] 이월 vs 소급 NPV 비교 (REF_SYSTEM_PARAM 할인율)
│  └─[Lv2] M7-03 사후관리 리스크 평가 ★v4.0 (I21)
│     ├─[Lv3] 고용 유지 실패 리스크 (추징액 + 이자상당가산액)
│     │         └ 퇴사 예외 사유 반영 ★v4.0r1 (M44: 정년/사망/병역 등)
│     ├─[Lv3] 자산 조기 처분 리스크 (2년 이내 처분 추징)
│     └─[Lv3] 감가상각 의무 미이행 리스크
│
└─[Lv1] MX. 횡단 기능 (Cross-cutting) ────────────────────────────────
   ├─[Lv2] MX-01 순환 참조 해결 엔진 ★v4.0 (I16)
   │  └─[Lv3] 익금불산입 → 과세표준 변동 → 최저한세 재계산 루프 (최대 5회, 1원 수렴)
   ├─[Lv2] MX-02 법령 버전 자동 매칭 (I24)
   │  └─[Lv3] 사업연도 입력 → REF_LAW_VERSION → 세율·공제율·적용기한 자동 로드
   ├─[Lv2] MX-03 검증 엔진 (§9)
   │  ├─[Lv3] 입력 검증 (V01~V19)
   │  ├─[Lv3] 계산 검증 (C01~C13)
   │  ├─[Lv3] 업무 규칙 검증 (B01~B11)
   │  ├─[Lv3] 법령 검증 (L01~L09)
   │  └─[Lv3] 교차검증 (X01~X13)
   ├─[Lv2] MX-04 계산 이력 / 감사 추적 (LOG_CALCULATION)
   └─[Lv2] MX-05 절사 정책 (TRUNCATE, 반올림 금지)
```

### 2.2 모듈 간 데이터 흐름 (Data Flow)

```
                ┌─────────┐
                │ 외부참조 │ REF_* 테이블 17개 (세율·공제율·법령·환율·이자율 등)
                └────┬────┘
                     │ 참조
    ┌────────────────┼────────────────┐
    ▼                ▼                ▼
┌───────┐      ┌──────────┐     ┌──────────────┐
│  M1   │      │   M2     │     │   MX-02      │
│입력관리│──▶  │기준정보   │     │법령버전매칭   │
│       │      │관리      │     │              │
└───┬───┘      └─────┬────┘     └──────┬───────┘
    │ 입력 데이터      │ 기준정보          │ 법령 파라미터
    ▼                 ▼                  ▼
┌──────────────────────────────────────────┐
│   M3. 사전 점검 / 검증 (STEP 0~1)          │
│   M3-00 불가사유 → M3-01~06 사전점검         │
│   산출물: 중소기업여부, 소재지구분,              │
│          상시근로자수, 검증결과                 │
└──────────────────┬───────────────────────┘
                   │ 검증된 기초 데이터
                   ▼
┌──────────────────────────────────────────┐
│   M4. 개별 공제·감면 산출 (STEP 2)           │
│   14개 서브모듈 병렬 산출                      │
│   산출물: 항목별 {공제/감면액, 농특세, 이월액}    │
└──────────────────┬───────────────────────┘
                   │ 개별 산출 결과
                   ▼
┌──────────────────────────────────────────┐
│   M5. 최적 조합 산출 (STEP 3)               │◀── MX-01 순환참조 해결
│   상호배제 → 최저한세 → 농특세 → 적용순서       │
│   산출물: 최적 조합 {실질환급액 극대화}          │
└──────────────────┬───────────────────────┘
                   │ 최적 조합
                   ▼
┌──────────────────────────────────────────┐
│   M6. 최종 산출 / 보고 (STEP 4~5)           │
│   환급액비교 → 환급가산금 → 지방소득세 → 보고서    │
│   산출물: 최종보고서 3종                       │
└──────────────────┬───────────────────────┘
                   │ 최종 결과
                   ▼
┌──────────────────────────────────────────┐
│   M7. 시뮬레이션                             │
│   다수연도 → 이월최적화 → 사후관리 리스크         │
│   산출물: 시뮬레이션 시나리오 비교 보고서          │
└──────────────────────────────────────────┘
```

### 2.3 모듈별 기능 요약 (일람표)

| 모듈 | 기능ID | 기능명 | 설명 | 버전 |
|------|--------|--------|------|------|
| **M1** | M1-01 | 법인 기본 정보 입력 | 법인명, 규모, 업종, 소재지, 과세연도, 재무 정보 등 | v1.0 |
| M1 | M1-02 | 대표자/임원/가족 정보 입력 | 대표자 생년월일, 임원 목록, 최대주주 가족관계 | v1.0 |
| M1 | M1-03 | 상시근로자 상세 명부 입력 | 직전/해당 연도 월별 근로자 상세 정보 | v1.0 |
| M1 | M1-04 | 투자 자산 명세 입력 | 투자 자산별 취득가, 종류, 소재지, 구분, **임대/중고/무형 구분** | v1.0 / **v4.0r1** |
| M1 | M1-05 | 창업/감면 관련 정보 입력 | 창업일, 소재지 구분, 업종 확인, 감면 이력 | v1.0 |
| M1 | M1-06 | R&D 비용 상세 입력 | 유형별·비목별 R&D비, 직전4년 이력, **위탁연구비** | v2.0 / **v4.0r1** |
| M1 | M1-07 | 이월결손금 상세 입력 | 발생연도별 잔액, 이월기간 | v2.0 |
| M1 | M1-08 | 이월세액공제 상세 입력 | 조항별·연도별 미공제 세액 | v2.0 |
| M1 | M1-09 | 기존 신고 공제·감면 상세 | 항목별 기존 적용 내역 | v2.0 |
| M1 | M1-10 | 지점 소재지 정보 입력 | 지점별 주소, 수도권 구분 | v2.0 |
| M1 | M1-11 | 중간예납 상세 입력 | 납부일, 납부금액 | v2.0 |
| M1 | M1-12 | 수입배당금 명세 입력 | 배당 지급법인, 지분율, 배당금액, 보유기간 | v3.0 |
| **M2** | M2-01 | 법인세율 관리 | 사업연도별 초과누진 세율 테이블 | v1.0 |
| M2 | M2-02 | 최저한세율 관리 | 기업 규모별·과세표준 구간별 최저한세율 | v1.0 |
| M2 | M2-03 | 공제 금액 관리 | 통합고용·투자 등 항목별 공제 금액/율 | v1.0 |
| M2 | M2-04 | 상호배제 매트릭스 관리 | 중복적용 가능/불가 조합 규칙 | v1.0 |
| M2 | M2-05 | 수도권 지역 구분 관리 | 과밀억제/성장관리/자연보전/비수도권 | v1.0 |
| M2 | M2-06 | 환급가산금 이율 관리 | 시기별 변동 이율 관리 | v2.0 |
| M2 | M2-07 | 법령 버전 관리 | 사업연도별 적용 법령 버전 매칭 | v2.0 |
| M2 | M2-08 | 외부 참조 데이터 갱신 | 환율, 인정이자율, 인구감소지역, KSIC 코드 | **v4.0r1** |
| M2 | M2-09 | 시스템 파라미터 관리 | NPV 할인율, 환급결정소요일, 절사정책 | v4.0 |
| **M3** | **M3-00** | **경정청구 불가 사유 검증** | **5년경과/분식회계/직권경정/결산조정 사전 차단** | **v4.0r1** |
| M3 | M3-01 | 경정청구 기한 점검 | 일반(5년) + 후발적(3개월) 기한 점검 | v1.0 / v2.0 |
| M3 | M3-02 | 중소기업 해당 여부 판단 | 매출액, 독립성, 졸업유예, **연도별 재판단** | v1.0 / v4.0 |
| M3 | M3-03 | 소재지 구분 판단 | 본점 간주 규정 + 제24조 예외 + **인구감소지역** | v1.0 / v3.0 / v2.0 |
| M3 | M3-04 | 상시근로자 수 산정 | 제외 필터, 월별 평균, **청년 시점 연도별 분기** | v1.0 / v2.0 |
| M3 | M3-05 | 입력 데이터 정합성 검증 | 필수 값, 범위, 논리, **교차검증 X01~X13** | v1.0 / **v4.0r1** |
| M3 | M3-06 | 결산확정 원칙 검증 | 신고조정/결산조정 구분, 경정청구 대상 필터링 | v2.0 |
| **M4** | M4-01 | 통합투자세액공제 | 제24조 기본/추가, **임대·중고 배제, 무형자산 구분** | v1.0 / **v4.0r1** |
| M4 | M4-02 | 통합고용세액공제 | 제29조의8 기본/추가 + **제29조의7 경과규정 비교** | v1.0 / v2.0 |
| M4 | M4-03 | 사회보험료세액공제 | 제30조의4 (청년 만15~29세 별도) | v1.0 / v2.0 |
| M4 | M4-04 | 창업중소기업세액감면 | 제6조, **벤처3년 검증·인구감소지역 100%** | v1.0 / v2.0 / **v4.0r1** |
| M4 | M4-05 | 중소기업특별세액감면 | 제7조 감면세액 계산 | v1.0 |
| M4 | M4-06 | 연구인력개발비세액공제 | 제10조 R&D (유형별 3단계), **위탁연구비 예외** | v1.0 / v2.0 / **v4.0r1** |
| M4 | M4-07 | 외국납부세액공제 | 법인세법 §57 직접+**간접공제**+손금산입 비교 | v2.0 / **v4.0r1** |
| M4 | M4-08 | 이월결손금 재검토 | 법인세법 §13 | v2.0 |
| M4 | M4-09 | 수입배당금 익금불산입 | 법인세법 §18의2 (2023 개정 3단계) | v3.0 |
| M4 | M4-10 | 결손금 소급공제 검토 | 법인세법 §72, 이월 vs 소급 NPV 비교 | v2.0 |
| M4 | M4-11 | 세무조정 재검토 | 손금/익금 오류, **가지급금·접대비·업무용승용차** | v2.0 / v4.0 |
| M4 | M4-12 | 토지등 양도세 추가과세 | 법인세법 §55의2 적용 오류 검토 | v2.0 |
| M4 | M4-13 | 기업구조조정 과세이연 | 법인세법 §44~47 | v2.0 |
| M4 | M4-14 | 연결납세 특화 점검 | 법인세법 §76의8, **자회사 데이터 구조** | v2.0 / **v4.0r1** |
| M4 | **M4-15** | **재해손실세액공제** | **법인세법 §58 — 자산 20%↑ 상실 시** | **v4.0r1** |
| M4 | **M42** | **감가상각 시부인 이월 추인** | **한도초과 이월 추인 누락 검토 (신고조정)** | **v4.0r1** |
| **M5** | M5-01 | 상호배제 규칙 검증 | 제127조 제4항, **연도별 중복 분기** | v1.0 / v2.0 |
| M5 | M5-02 | 최적 조합 탐색 | 그룹A/B 비교 + **순환참조 해결** | v1.0 / v2.0 / v4.0 |
| M5 | M5-03 | 최저한세 적용 | 과세표준 기준, **R&D 배제 3단계** | v1.0 / v3.0 |
| M5 | M5-04 | 농특세 적용 | 항목별 과세/비과세, **연쇄 재계산** | v1.0 / v4.0 |
| M5 | M5-05 | 세액 적용순서 처리 | 법인세법 §59 적용순서 | v1.0 |
| **M6** | M6-01 | 환급액 비교표 생성 | 기존 vs 경정 후 세액 비교 | v1.0 |
| M6 | M6-02 | 환급가산금 산출 | 국기법 §52, **본세/중간예납 기산일 분리** | v1.0 / v2.0 |
| M6 | M6-03 | 지방소득세 환급 안내 | 법인세 환급액 × 10% | v2.0 |
| M6 | M6-04 | 최종 보고서 생성 | **3종 분리 (경영진/세무대리인/국세청)** | v1.0 / v2.0 |
| **M7** | M7-01 | 다수 과세연도 시뮬레이션 | 복수 연도 일괄 + **연도별 중소기업 재판단** | v2.0 / v4.0 |
| M7 | M7-02 | 이월공제 활용 시나리오 | 향후 10년 최적 활용 계획 | v2.0 |
| M7 | M7-03 | 사후관리 리스크 평가 | 고용유지·자산처분, **퇴사예외사유·이자상당가산액** | v2.0 / v4.0 / **v4.0r1** |
| **MX** | MX-01 | 순환 참조 해결 엔진 | 과세표준↔최저한세 반복 (최대 5회, 1원 수렴) | v4.0 |
| MX | MX-02 | 법령 버전 자동 매칭 | 사업연도 → 세율·공제율·적용기한 자동 로드 | v2.0 |
| MX | MX-03 | 검증 엔진 | V/C/B/L/X 5유형, **총 71건** | v1.0 ~ **v4.0r1** |
| MX | MX-04 | 계산 이력 / 감사 추적 | LOG_CALCULATION | v1.0 |
| MX | MX-05 | 절사 정책 | TRUNCATE (반올림 금지) | v4.0 |

### 2.4 기능 분할 통계

| 계층 | 항목 수 | 설명 |
|------|---------|------|
| **Level 0** | 1 | 시스템 전체 |
| **Level 1** | 8 | 대모듈 (M1~M7 + MX) |
| **Level 2** | 52 | 서브모듈 (M1-01~MX-05) |
| **Level 3** | 110+ | 세부 처리 단계 (step/공식/검증 등) |
| **테이블** | 42 | 입력 24 + 기준정보 22 + 출력 6 (*중복 제거 기준) |
| **계산 공식** | 56 | F01~F56 (v4.0r1 기준) |
| **검증 규칙** | 71 | V19 + C13 + B11 + L09 + X13 + W6 |

---

## 3. 테이블 설계 — 입력 테이블

### 3.1 TBL_CORP_BASIC — 법인 기본 정보

> 출처: 엑셀 시트 `1.법인기본정보(당해년도)`

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 | 비고 |
|----|--------|--------|-----------|------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | PK, 자동생성 | |
| 2 | biz_type | 사업자유형 | VARCHAR(10) | Y | '법인사업자' 고정 | |
| 3 | corp_size | 기업규모 | VARCHAR(10) | Y | 소기업/중기업/중견기업/대기업 | |
| 4 | industry_code | 업종코드 | VARCHAR(10) | Y | 한국표준산업분류(KSIC) | 예: C21 |
| 5 | corp_name | 법인명 | VARCHAR(100) | Y | | |
| 6 | biz_reg_no | 사업자등록번호 | VARCHAR(15) | Y | | |
| 7 | corp_reg_no | 법인등록번호 | VARCHAR(15) | Y | | |
| 8 | rep_name | 대표자명 | VARCHAR(50) | N | | |
| 9 | open_date | 개업일자 | DATE | Y | 사업자등록증 개업일 | |
| 10 | location | 소재지 | VARCHAR(200) | Y | 시·군·구 단위 | 사업장 주소 |
| 11 | hq_location | 본점소재지 | VARCHAR(200) | Y | 법인 본점 주소 | ★v2.0: 필수로 변경 |
| 12 | capital_zone | 수도권구분 | VARCHAR(20) | Y | 과밀억제/성장관리/자연보전/비수도권 | |
| 13 | depopulation_area | 인구감소지역여부 | BOOLEAN | N | 행정안전부 고시 기준 | 2025년 이후 창업 시 |
| 14 | target_tax_year | 경정청구대상과세연도 | VARCHAR(4) | Y | 예: 2025 | |
| 15 | fiscal_start | 사업연도시작일 | DATE | Y | 예: 2025-01-01 | |
| 16 | fiscal_end | 사업연도종료일 | DATE | Y | 예: 2025-12-31 | |
| 17 | revenue | 해당연도매출액 | BIGINT | Y | 원 단위 | |
| 18 | revenue_deduction | 감면대상업종매출액 | BIGINT | N | 겸업 시 구분 | |
| 19 | **biz_income** | **각사업연도소득** | BIGINT | Y | 익금총액 - 손금총액 | ★v2.0 신규 (M01) |
| 20 | **non_taxable_income** | **비과세소득** | BIGINT | N | 과세표준 산출 시 차감 | ★v2.0 신규 (M02) |
| 21 | taxable_income | 과세표준 | BIGINT | Y | 기신고 과세표준 | ★v2.0: 설명 정정 (E07) |
| 22 | computed_tax | 산출세액 | BIGINT | Y | 과세표준 × 세율 | |
| 23 | prepaid_tax | 기납부세액 | BIGINT | N | 중간예납+원천징수 합계 | |
| 24 | determined_tax | 기존결정세액 | BIGINT | N | 기존 신고 결정세액 | |
| 25 | paid_tax | 기존납부세액 | BIGINT | Y | 실제 납부 세액 | ★v2.0: 필수로 변경 |
| 26 | founding_date | 창업일자 | DATE | N | 법인설립등기일 | |
| 27 | existing_deduction_type | 기존적용공제감면종류 | VARCHAR(200) | N | 예: 제7조 | |
| 28 | existing_deduction_amount | 기존적용공제감면금액 | BIGINT | N | | |
| 29 | loss_carryforward | 이월결손금잔액 | BIGINT | N | 총잔액 (상세는 별도 테이블) | |
| 30 | foreign_tax_paid | 외국납부세액유무 | BOOLEAN | N | | |
| 31 | consolidated_tax | 연결납세적용여부 | BOOLEAN | N | | |
| 32 | rd_dept_yn | 연구개발전담부서보유 | BOOLEAN | N | KOITA 인정 여부 | |
| 33 | venture_yn | 벤처기업확인여부 | BOOLEAN | N | | |
| 34 | venture_date | 벤처기업확인일 | DATE | N | | |
| 35 | **graduation_year** | **중소기업졸업연도** | VARCHAR(4) | N | 졸업유예 판단용 | ★v2.0 신규 (M20) |
| 36 | **graduation_grace_period** | **졸업유예기간** | INT | N | 3 또는 5 (연도) | ★v2.0 신규 (M20) |
| 37 | **interim_prepaid_tax** | **중간예납세액** | BIGINT | N | 중간예납으로 납부한 세액 | ★v1.1 → v3.0 통합 |
| 38 | **withholding_tax** | **원천납부세액** | BIGINT | N | 원천징수된 세액 | ★v1.1 → v3.0 통합 |
| 39 | **current_year_loss** | **당기결손금** | BIGINT | N | 당해 사업연도 결손금 — 소급공제 검토용 | ★v1.1 → v3.0 통합 |
| 40 | **prior_year_tax_paid** | **직전연도납부세액** | BIGINT | N | 직전 사업연도 납부 법인세 — 소급공제 한도 | ★v1.1 → v3.0 통합 |
| 41 | **prior_year_tax_base** | **직전연도과세표준** | BIGINT | N | 직전 사업연도 과세표준 — 소급공제 환급액 계산 | ★v1.1 → v3.0 통합 |
| 42 | **amendment_history** | **수정신고경정이력** | TEXT | N | JSON 형태 이력 | ★v2.0 신규 (M23) |
| 43 | **claim_reason** | **경정청구사유** | VARCHAR(200) | Y | 미적용/종류변경/기타 | ★v2.0 신규 |
| 44 | **foreign_income_total** | **외국소득총액** | BIGINT | N | 외국납부세액공제 한도 계산용 (원화 환산) | ★v4.0 신규 (E13) |
| 45 | **shareholder_loan_balance** | **가지급금잔액** | BIGINT | N | 인정이자 익금산입 검토용 | ★v4.0 신규 (M27) |
| 46 | **non_business_asset_value** | **업무무관자산가액** | BIGINT | N | 차입금이자 손금불산입 검토용 | ★v4.0 신규 (M28) |
| 47 | **related_interest** | **관련차입금이자** | BIGINT | N | 업무무관자산 관련 손금불산입 검토 | ★v4.0 신규 (M28) |
| 48 | **expected_refund_decision_date** | **환급결정예상일** | DATE | N | 환급가산금 종료일 산정용 | ★v4.0 신규 (M31) |
| 49 | **entertainment_expense** | **접대비지출액** | BIGINT | N | 접대비 한도 초과 검토용 | ★v4.0 신규 (M25) |
| 50 | **government_subsidy** | **국고보조금수령액** | BIGINT | N | 익금불산입 검토용 (법인세법 §18①) | ★v4.0 신규 (E12) |
| 51 | **is_controlling_corp** | **연결모법인여부** | BOOLEAN | N | 연결납세 적용 판단 | ★v4.0r1 (M38) |
| 52 | **disaster_loss_yn** | **재해손실여부** | BOOLEAN | N | 재해손실세액공제 검토 | ★v4.0r1 (M37) |
| 53 | **claim_disqualification_check** | **경정청구불가사유** | VARCHAR(200) | N | 분식회계/5년경과/직권경정 등 사전확인 | ★v4.0r1 (M43) |

### 3.2 TBL_REPRESENTATIVE — 대표자/임원/가족 정보

> v1.0과 동일 (변경 없음)

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK → TBL_CORP_BASIC |
| 2 | person_id | 인물ID | VARCHAR(20) | Y | PK |
| 3 | role_type | 구분 | VARCHAR(20) | Y | 대표이사/대표이사배우자/등기임원/감사 등 |
| 4 | person_name | 성명 | VARCHAR(50) | Y | |
| 5 | birth_date | 생년월일 | DATE | Y | 청년 판단용 |
| 6 | gender | 성별 | VARCHAR(2) | N | 병역가산 적용 여부 참고 |
| 7 | address | 주소 | VARCHAR(200) | N | |
| 8 | phone | 연락처 | VARCHAR(20) | N | |
| 9 | appoint_date | 취임일 | DATE | N | |
| 10 | is_major_shareholder | 최대주주여부 | BOOLEAN | Y | |
| 11 | share_ratio | 지분율 | DECIMAL(5,2) | N | % |
| 12 | military_start | 병역시작일 | DATE | N | |
| 13 | military_end | 병역종료일 | DATE | N | |
| 14 | remark | 비고 | VARCHAR(200) | N | |
| 15 | **family_relation** | **가족관계** | VARCHAR(20) | N | 최대주주와의 관계 | ★v2.0 신규 |

### 3.3 TBL_EMPLOYEE_DETAIL — 상시근로자 상세 명부 *(v4.0r1 M44 보강)*

> 출처: 엑셀 시트 `3.직전년도_12월_상세명부`, `3-2.해당년도_12월_상세명부`

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK |
| 2 | emp_id | 사번 | VARCHAR(20) | Y | PK |
| 3 | year_type | 연도구분 | VARCHAR(10) | Y | **'PRIOR'/'CURRENT'** ★v2.0: 대소문자 통일 (E01) |
| 4 | emp_name | 성명 | VARCHAR(50) | Y | |
| 5 | birth_date | 생년월일 | DATE | Y | |
| 6 | hire_date | 입사일 | DATE | Y | 근로계약 체결일 (2025년~ 청년 판단 기준) |
| 7 | emp_type | 직원유형 | VARCHAR(20) | Y | 일반/청년/60세이상/장애인/경력단절여성/**북한이탈주민** ★v2.0 추가 (M17) |
| 8 | is_disabled | 장애인여부 | BOOLEAN | Y | |
| 9 | is_career_break | 경력단절여성여부 | BOOLEAN | Y | |
| 10 | **career_break_reason** | **경력단절사유** | VARCHAR(50) | N | 결혼/임신/출산/육아/자녀교육/가족돌봄 | ★v2.0 신규 (M19) |
| 11 | **career_break_resign_date** | **경력단절퇴직일** | DATE | N | 퇴직 후 2~15년 이내 재고용 확인 | ★v2.0 신규 (M19) |
| 12 | **rehire_date** | **재고용일** | DATE | N | 경력단절여성 재고용일 | ★v2.0 신규 (M19) |
| 13 | **is_converted_regular** | **정규직전환여부** | BOOLEAN | N | 비정규직→정규직 전환 | ★v2.0 신규 |
| 14 | **conversion_date** | **정규직전환일** | DATE | N | 전환일 기준 2년 유지 조건 | ★v2.0 신규 |
| 15 | **parental_leave_return** | **육아휴직복귀여부** | BOOLEAN | N | 복귀 후 6개월 이상 근무 | ★v2.0 신규 |
| 16 | **parental_return_date** | **육아휴직복귀일** | DATE | N | | ★v2.0 신규 |
| 17 | address | 주소 | VARCHAR(200) | N | |
| 18 | phone | 연락처 | VARCHAR(20) | N | |
| 19 | monthly_salary | 월평균급여 | BIGINT | N | 원 |
| 20 | pension_employer | 국민연금_사업주부담 | BIGINT | N | 월 원 |
| 21 | health_employer | 건강보험_사업주부담 | BIGINT | N | 월 원 |
| 22 | employ_employer | 고용보험_사업주부담 | BIGINT | N | 월 원 |
| 23 | injury_employer | 산재보험_사업주부담 | BIGINT | N | 월 원 |
| 24 | resign_date | 퇴사일 | DATE | N | |
| 25 | resign_reason | 퇴사사유 | VARCHAR(200) | N | |
| 26 | contract_type | 근로계약유형 | VARCHAR(20) | N | 정규직/기간제/파견 |
| 27 | monthly_hours | 월소정근로시간 | INT | N | 60시간 미만 시 제외 |
| 28 | **contract_period_months** | **근로계약기간** | INT | N | 개월 수 (1년 미만 시 제외, 연속갱신 확인) | ★v2.0 신규 |
| 29 | **is_nk_defector** | **북한이탈주민여부** | BOOLEAN | N | 청년등 범위 포함 | ★v2.0 신규 (M17) |
| 30 | **branch_location** | **근무사업장** | VARCHAR(200) | N | 법인 내 근무 사업장 | ★v2.0 신규 |

### 3.4 TBL_EMPLOYEE_MONTHLY — 월별 상시근로자 요약

> 출처: 엑셀 시트 `3-1.직전년도_월별요약`, `3-3.해당년도_월별요약`

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK |
| 2 | year_month | 년월 | VARCHAR(7) | Y | PK (YYYY-MM) |
| 3 | year_type | 연도구분 | VARCHAR(10) | Y | PRIOR/CURRENT |
| 4 | total_regular | 상시근로자수 | DECIMAL(10,2) | Y | |
| 5 | youth_count | 청년수 | DECIMAL(10,2) | Y | 만15~34세 |
| 6 | senior_count | 60세이상수 | DECIMAL(10,2) | Y | |
| 7 | disabled_count | 장애인수 | DECIMAL(10,2) | Y | |
| 8 | career_break_count | 경력단절여성수 | DECIMAL(10,2) | Y | |
| 9 | **nk_defector_count** | **북한이탈주민수** | DECIMAL(10,2) | Y | | ★v4.0 신규 (E11) |

### 3.5 TBL_INVESTMENT_ASSET — 투자 자산 명세

> 출처: 엑셀 시트 `5.통합투자자산명세`

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK |
| 2 | asset_id | 자산번호 | VARCHAR(20) | Y | PK |
| 3 | asset_category | 자산종류 | VARCHAR(50) | Y | 기계장치/차량운반구 등 |
| 4 | asset_name | 자산명 | VARCHAR(100) | Y | |
| 5 | model | 규격모델 | VARCHAR(50) | N | |
| 6 | qty | 수량 | INT | Y | |
| 7 | acquire_date | 취득일자 | DATE | Y | |
| 8 | acquire_cost | 취득가액 | BIGINT | Y | 원 |
| 9 | acquire_method | 취득방법 | VARCHAR(20) | Y | 매입/자가제작 등 |
| 10 | supplier_name | 공급자명 | VARCHAR(100) | N | |
| 11 | supplier_biz_no | 공급자사업자번호 | VARCHAR(20) | N | |
| 12 | install_location | 설치장소 | VARCHAR(200) | Y | 실제 자산 설치 주소 |
| 13 | **install_location_zone** | **설치장소수도권구분** | VARCHAR(20) | Y | 과밀억제/성장관리/자연보전/비수도권 — **제24조 판단용 (본점과 다를 수 있음)** | ★v1.1 |
| 14 | depreciation_start | 감가상각개시일 | DATE | N | |
| 15 | useful_life | 내용연수 | INT | N | 년 |
| 16 | invest_type | 투자구분 | VARCHAR(20) | Y | general/strategic/growth 등 |
| 17 | invest_category | 투자항목 | VARCHAR(100) | Y | 일반/신성장/국가전략/안전/환경/에너지/R&D |
| 18 | tax_credit | 세액공제액 | BIGINT | N | 산출 결과 |
| 19 | evidence | 증빙서류 | VARCHAR(200) | N | |
| 20 | **actual_depreciation** | **실제감가상각비** | BIGINT | N | 당기 실제 계상한 감가상각비 | ★v4.0 신규 (M29) |
| 21 | **required_depreciation** | **의무감가상각비** | BIGINT | N | 세액공제 사후관리상 의무 감가상각비 | ★v4.0 신규 (M29) |
| 22 | **disposal_date** | **처분일자** | DATE | N | 2년 이내 처분 시 추징 리스크 | ★v4.0 신규 (M30) |
| 23 | **disposal_reason** | **처분사유** | VARCHAR(100) | N | 매각/폐기/기타 | ★v4.0 신규 (M30) |
| 24 | **is_rental_asset** | **임대용자산여부** | BOOLEAN | N | TRUE면 제24조 공제 불가 (2024 세법개정) | ★v4.0r1 (E16) |
| 25 | **is_used_asset** | **중고품여부** | BOOLEAN | N | TRUE면 제24조 공제 불가 | ★v4.0r1 (E16) |
| 26 | **asset_class_code** | **자산분류코드** | VARCHAR(20) | N | 기계장치/공구/비품/SW/IP 등 (무형자산 구분) | ★v4.0r1 (M40) |

### 3.6 TBL_STARTUP_INFO — 창업기업 세액감면 정보 *(v4.0r1 M39 벤처검증 보강)*

> 출처: 엑셀 시트 `6.창업기업세액명세서`

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK, PK |
| 2 | founding_date | 창업일 | DATE | N | |
| 3 | location_zone | 수도권구분 | VARCHAR(20) | N | |
| 4 | depopulation_yn | 인구감소지역해당 | BOOLEAN | N | |
| 5 | eligible_industry | 감면대상업종해당 | BOOLEAN | N | |
| 6 | biz_succession | 사업승계여부 | BOOLEAN | N | |
| 7 | is_sme | 중소기업해당여부 | BOOLEAN | N | |
| 8 | rep_birth | 대표자생년월일 | DATE | N | |
| 9 | military_start | 병역시작일 | DATE | N | |
| 10 | military_end | 병역종료일 | DATE | N | |
| 11 | rep_gender | 대표자성별 | VARCHAR(2) | N | |
| 12 | venture_yn | 벤처기업확인 | BOOLEAN | N | |
| 13 | venture_date | 벤처확인일 | DATE | N | |
| 14 | annual_revenue | 수입금액 | BIGINT | N | |
| 15 | founding_period | 창업시점구분 | VARCHAR(20) | N | 2024이전/2025이후 |
| 16 | computed_tax | 산출세액 | BIGINT | N | |
| 17 | taxable_base | 과세표준 | BIGINT | N | |
| 18 | income_ratio | 감면대상소득비율 | DECIMAL(5,2) | N | |
| 19 | first_income_year | 최초소득발생연도 | VARCHAR(4) | N | |
| 20 | existing_deduction | 기존적용공제감면 | VARCHAR(200) | N | |
| 21 | existing_deduction_amt | 기존공제감면금액 | BIGINT | N | |
| 22 | existing_determined | 기존결정세액 | BIGINT | N | |
| 23 | existing_paid | 기존납부세액 | BIGINT | N | |

### 3.7 TBL_SME_SPECIAL — 중소기업 특별세액감면 정보

> 출처: 엑셀 시트 `7.중소기업특별세액감면명세서`

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK, PK |
| 2 | biz_type | 사업자유형 | VARCHAR(10) | N | |
| 3 | corp_size_detail | 기업규모상세 | VARCHAR(10) | N | 소기업/중기업 |
| 4 | industry_name | 업종명 | VARCHAR(100) | N | |
| 5 | industry_code | 업종코드 | VARCHAR(10) | N | |
| 6 | excluded_industry | 감면제외업종해당 | BOOLEAN | N | |
| 7 | location | 사업장소재지 | VARCHAR(200) | N | |
| 8 | capital_zone | 수도권구분 | VARCHAR(20) | N | |
| 9 | hq_location | 법인본점소재지 | VARCHAR(200) | N | |
| 10 | target_year | 경정청구대상연도 | VARCHAR(4) | N | |
| 11 | is_sme | 중소기업해당 | BOOLEAN | N | |
| 12 | graduation_status | 졸업유예상태 | VARCHAR(20) | N | |
| 13 | size_sub | 소기업중기업구분 | VARCHAR(10) | N | |
| 14 | industry_class | 업종분류_감면율용 | VARCHAR(50) | N | |
| 15 | revenue | 해당연도수입금액 | BIGINT | N | |
| 16 | continued_10yr | 10년이상계속경영 | BOOLEAN | N | |
| 17 | income_under_1e | 소득1억이하 | BOOLEAN | N | |
| 18 | faithful_taxpayer | 성실사업자해당 | BOOLEAN | N | |
| 19 | premium_eligible | 우대적용여부 | BOOLEAN | N | 3가지 모두 충족 시 |
| 20 | computed_tax | 산출세액 | BIGINT | N | |
| 21 | taxable_base | 과세표준 | BIGINT | N | |
| 22 | deductible_income | 감면대상업종소득 | BIGINT | N | |
| 23 | total_income | 전체소득금액 | BIGINT | N | |
| 24 | income_ratio | 감면대상소득비율 | DECIMAL(5,2) | N | |
| 25 | deduction_rate | 적용감면율 | DECIMAL(5,2) | N | |
| 26 | prior_yr_employees | 직전연도상시근로자수 | DECIMAL(10,2) | N | |
| 27 | current_yr_employees | 해당연도상시근로자수 | DECIMAL(10,2) | N | |

### 3.8 TBL_LOSS_CARRYFORWARD — 이월결손금 상세 *(v2.0 신규, M03)*

> 프롬프트: [법인 기본 정보] '이월결손금 잔액 및 발생 연도별 내역', 점검 27

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK → TBL_CORP_BASIC |
| 2 | loss_id | 결손금ID | INT | Y | PK |
| 3 | origin_year | 발생사업연도 | VARCHAR(4) | Y | 결손금이 발생한 사업연도 |
| 4 | original_amount | 발생금액 | BIGINT | Y | 원 |
| 5 | used_amount | 기사용금액 | BIGINT | Y | 이미 공제에 사용된 금액 |
| 6 | remaining_amount | 잔액 | BIGINT | Y | 원 |
| 7 | expiry_date | 소멸기한 | DATE | Y | 발생+15년(또는 10년) |
| 8 | carryforward_period | 이월기간 | INT | Y | 10 또는 15 (2020년 기준) |

### 3.9 TBL_CREDIT_CARRYFORWARD — 이월세액공제 상세 *(v2.0 신규, M04)*

> 프롬프트: [법인 기본 정보] '이월된 미공제 세액 내역 (제10조·제24조·제29조의8 등)'

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK |
| 2 | credit_cf_id | 이월공제ID | INT | Y | PK |
| 3 | provision | 적용조항 | VARCHAR(20) | Y | 제10조/제24조/제29조의8 등 |
| 4 | origin_year | 발생사업연도 | VARCHAR(4) | Y | |
| 5 | original_amount | 발생금액 | BIGINT | Y | |
| 6 | used_amount | 기사용금액 | BIGINT | Y | |
| 7 | remaining_amount | 잔액 | BIGINT | Y | |
| 8 | expiry_year | 소멸연도 | VARCHAR(4) | Y | 발생+10년 |

### 3.10 TBL_RD_EXPENSE — R&D 비용 상세 *(v2.0 신규, M05 / v4.0r1 E17 보강)*

> 프롬프트: 점검 22-2 [B] 공제율 결정용 입력자료

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK |
| 2 | rd_id | R&D비용ID | INT | Y | PK |
| 3 | tax_year | 과세연도 | VARCHAR(4) | Y | 해당+직전4년 |
| 4 | rd_type | R&D유형 | VARCHAR(20) | Y | 일반/신성장/국가전략 |
| 5 | personnel_cost | 인건비 | BIGINT | N | |
| 6 | depreciation_cost | 감가상각비 | BIGINT | N | |
| 7 | outsource_cost | 위탁비 | BIGINT | N | |
| 8 | material_cost | 재료비 | BIGINT | N | |
| 9 | test_analysis_cost | 시험분석비 | BIGINT | N | |
| 10 | other_cost | 기타비용 | BIGINT | N | |
| 11 | total_rd_cost | R&D비총액 | BIGINT | Y | 각 비목의 합계 |
| 12 | **is_commissioned** | **위탁연구여부** | BOOLEAN | N | TRUE면 위탁연구비 — 전담부서 없이도 공제 가능 | ★v4.0r1 (E17) |
| 13 | **commissioned_lab_name** | **위탁기관명** | VARCHAR(100) | N | 위탁연구기관명 (적격 연구기관 확인용) | ★v4.0r1 (E17) |
| 14 | **commissioned_contract_date** | **위탁계약일** | DATE | N | 위탁연구개발 계약 체결일 | ★v4.0r1 (E17) |

### 3.11 TBL_EXISTING_DEDUCTION — 기존 신고 공제·감면 상세 *(v2.0 신규, M22)*

> 프롬프트: 점검 9-4 기존 신고 내역 확인

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK |
| 2 | deduction_id | 공제감면ID | INT | Y | PK |
| 3 | provision | 적용조항 | VARCHAR(20) | Y | 제6조/제7조/제10조 등 |
| 4 | deduction_type | 유형 | VARCHAR(10) | Y | 감면/공제 |
| 5 | amount | 적용금액 | BIGINT | Y | |
| 6 | nongteuk_tax | 농특세액 | BIGINT | N | |
| 7 | remark | 비고 | VARCHAR(200) | N | |

### 3.12 TBL_BRANCH_LOCATION — 지점 소재지 *(v2.0 신규, M14)*

> 프롬프트: [법인 기본 정보] '지점(사업장) 소재지'

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK |
| 2 | branch_id | 지점ID | INT | Y | PK |
| 3 | branch_name | 지점명 | VARCHAR(100) | Y | |
| 4 | address | 주소 | VARCHAR(200) | Y | |
| 5 | capital_zone | 수도권구분 | VARCHAR(20) | Y | |
| 6 | is_depopulation | 인구감소지역여부 | BOOLEAN | N | |

### 3.13 TBL_INTERIM_TAX — 중간예납 상세 *(v2.0 신규, M15)*

> 프롬프트: 점검 29, 점검 9-5

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK |
| 2 | interim_id | 중간예납ID | INT | Y | PK |
| 3 | tax_year | 과세연도 | VARCHAR(4) | Y | |
| 4 | payment_date | 납부일 | DATE | Y | 환급가산금 기산점 |
| 5 | payment_amount | 납부금액 | BIGINT | Y | |
| 6 | method | 계산방식 | VARCHAR(20) | N | 직전50%/가결산 |

### 3.14 TBL_DIVIDEND_INCOME — 수입배당금 명세 *(v1.1 → v3.0 통합)*

> **목적**: 법인세법 제18조의2 익금불산입 계산을 위한 배당소득 상세 입력  
> **근거**: v1.1 오류지적 ②항 — M4-09 처리를 위한 입력 테이블 보완

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK → TBL_CORP_BASIC |
| 2 | dividend_id | 배당ID | VARCHAR(20) | Y | PK |
| 3 | dividend_src_corp | 배당지급법인명 | VARCHAR(100) | Y | 배당을 지급한 법인 |
| 4 | dividend_src_biz_no | 배당지급법인사업자번호 | VARCHAR(15) | N | |
| 5 | share_ratio | 지분율 | DECIMAL(5,2) | Y | %, 출자비율 |
| 6 | dividend_amt | 배당금액 | BIGINT | Y | 원 |
| 7 | holding_period_months | 지분보유기간 | INT | N | 월 단위 |
| 8 | is_listed | 상장여부 | BOOLEAN | N | 2022년 이전 적용 시 구분용 |
| 9 | is_holding_company | 지주회사여부 | BOOLEAN | N | 2022년 이전 적용 시 구분용 |
| 10 | tax_year | 적용과세연도 | VARCHAR(4) | Y | 기준정보 테이블 연도 매핑용 |

---


### 3.15 TBL_FOREIGN_TAX — 외국납부세액 상세 *(v4.0 신규, E13)*

> **목적**: 법인세법 §57 외국납부세액공제 한도 계산을 위한 국가별·소득종류별 상세 데이터

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK → TBL_CORP_BASIC |
| 2 | foreign_tax_id | 외국세액ID | INT | Y | PK |
| 3 | country | 외국국가명 | VARCHAR(50) | Y | |
| 4 | income_type | 소득종류 | VARCHAR(30) | Y | 배당/이자/사용료/사업소득/기타 |
| 5 | foreign_income | 외국소득금액 | BIGINT | Y | 원화 환산 금액 |
| 6 | foreign_tax_paid | 외국납부세액 | BIGINT | Y | 원화 환산 금액 |
| 7 | exchange_rate | 적용환율 | DECIMAL(10,4) | Y | |
| 8 | tax_year | 귀속사업연도 | VARCHAR(4) | Y | |
| 9 | **is_indirect_credit** | **간접공제여부** | BOOLEAN | N | 자회사 배당 시 간접외국납부세액공제 | ★v4.0r1 (E18) |
| 10 | **subsidiary_name** | **해외자회사명** | VARCHAR(100) | N | 간접공제 대상 자회사 | ★v4.0r1 (E18) |
| 11 | **subsidiary_share_ratio** | **자회사지분율** | DECIMAL(5,2) | N | 25% 이상 요건 확인 | ★v4.0r1 (E18) |
| 12 | **subsidiary_tax_paid** | **자회사외국법인세** | BIGINT | N | 자회사가 납부한 외국 법인세액 | ★v4.0r1 (E18) |
| 13 | **dividend_from_subsidiary** | **자회사배당금** | BIGINT | N | 자회사로부터 수취한 배당금 | ★v4.0r1 (E18) |

### 3.16 TBL_BUSINESS_VEHICLE — 업무용 승용차 *(v4.0 신규, E14)*

> **목적**: 법인세법 시행령 §50의2 업무용 승용차 비용 불산입 검토

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK → TBL_CORP_BASIC |
| 2 | vehicle_id | 차량ID | INT | Y | PK |
| 3 | vehicle_no | 차량번호 | VARCHAR(20) | Y | |
| 4 | vehicle_type | 차종 | VARCHAR(50) | N | |
| 5 | acquire_date | 취득일자 | DATE | Y | |
| 6 | acquire_cost | 취득가액 | BIGINT | Y | 원 |
| 7 | logbook_maintained | 운행기록부작성여부 | BOOLEAN | Y | 미작성 시 비용 50% 불산입 |
| 8 | exclusive_insurance | 임직원전용보험가입 | BOOLEAN | Y | 미가입 시 비용 전액 불산입 |
| 9 | annual_depreciation | 연간감가상각비 | BIGINT | N | 계상한 감가상각비 |
| 10 | depreciation_limit | 감가상각한도 | BIGINT | N | 연 800만원 |
| 11 | annual_expense | 연간업무용비용 | BIGINT | N | 유지비·보험료·주차비 등 |
| 12 | business_use_ratio | 업무사용비율 | DECIMAL(5,2) | N | % (운행기록부 기준) |

### 3.17 TBL_TAX_ADJUSTMENT — 세무조정계산서 *(v4.0 신규, E15)*

> **목적**: 기존 신고 세무조정 내역 입력 — M4-11 재검토 모듈 입력 데이터

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK → TBL_CORP_BASIC |
| 2 | adjustment_id | 조정ID | INT | Y | PK |
| 3 | tax_year | 귀속사업연도 | VARCHAR(4) | Y | |
| 4 | adjustment_item | 조정항목명 | VARCHAR(100) | Y | 예: 접대비한도초과, 감가상각비부인 등 |
| 5 | adjustment_type | 조정유형 | VARCHAR(20) | Y | 손금불산입/익금불산입/손금산입/익금산입 |
| 6 | adjustment_amount | 조정금액 | BIGINT | Y | 원 |
| 7 | disposition_type | 소득처분유형 | VARCHAR(20) | N | 유보/사외유출/기타 |
| 8 | legal_basis | 근거법령 | VARCHAR(100) | N | 예: 법인세법 §25 |
| 9 | remark | 비고 | VARCHAR(200) | N | |
| 10 | **reserve_type** | **유보구분** | VARCHAR(20) | N | 사내유보/사외유출/기타사외유출 | ★v4.0r1 (M41) |
| 11 | **reserve_balance** | **유보잔액** | BIGINT | N | 당기말 유보 누계액 | ★v4.0r1 (M41) |

### 3.18 TBL_ENTERTAINMENT — 접대비 상세 *(v4.0 신규, M25)*

> **목적**: 법인세법 §25 접대비 한도 초과 여부 상세 검토

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK → TBL_CORP_BASIC |
| 2 | entertainment_id | 접대비ID | INT | Y | PK |
| 3 | expense_date | 지출일 | DATE | Y | |
| 4 | expense_amount | 지출액 | BIGINT | Y | 원 |
| 5 | recipient | 접대대상 | VARCHAR(100) | N | |
| 6 | purpose | 목적 | VARCHAR(200) | N | |
| 7 | evidence_type | 증빙유형 | VARCHAR(20) | N | 신용카드/세금계산서/간이영수증 |

### 3.19 TBL_GOVERNMENT_SUBSIDY — 국고보조금 *(v4.0 신규, E12)*

> **목적**: 법인세법 §18① 국고보조금 익금불산입 검토

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK → TBL_CORP_BASIC |
| 2 | subsidy_id | 보조금ID | INT | Y | PK |
| 3 | subsidy_type | 보조금종류 | VARCHAR(100) | Y | |
| 4 | subsidy_amount | 수령액 | BIGINT | Y | 원 |
| 5 | grant_date | 교부일 | DATE | Y | |
| 6 | granting_agency | 교부기관 | VARCHAR(100) | N | |
| 7 | exclusion_applied | 익금불산입적용여부 | BOOLEAN | N | 기존 신고 시 적용 여부 |
| 8 | asset_acquired | 자산취득여부 | BOOLEAN | N | 자산 취득 시 일시상각충당금 설정 여부 |

### 3.20 TBL_SHAREHOLDER_LOAN — 가지급금 *(v4.0 신규, M27)*

> **목적**: 법인세법 시행령 §89 가지급금 인정이자 익금산입 검토

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK → TBL_CORP_BASIC |
| 2 | loan_id | 가지급금ID | INT | Y | PK |
| 3 | shareholder_name | 주주명 | VARCHAR(50) | Y | |
| 4 | relationship | 관계 | VARCHAR(30) | N | 대표이사/특수관계인 등 |
| 5 | loan_balance | 가지급금잔액 | BIGINT | Y | 사업연도말 기준 |
| 6 | loan_start_date | 대여시작일 | DATE | N | |
| 7 | loan_period_months | 대여기간 | INT | N | 개월 수 |
| 8 | deemed_interest_rate | 인정이자율 | DECIMAL(5,2) | N | 가중평균차입이자율 또는 당좌대출이자율 |
| 9 | deemed_interest | 인정이자금액 | BIGINT | N | 산출 결과 |

### 3.21 TBL_NON_BUSINESS_ASSET — 업무무관자산 *(v4.0 신규, M28)*

> **목적**: 법인세법 §28 업무무관자산 관련 차입금이자 손금불산입 검토

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK → TBL_CORP_BASIC |
| 2 | asset_id | 자산ID | INT | Y | PK |
| 3 | asset_type | 자산종류 | VARCHAR(50) | Y | 비사업용부동산/과다보유현금 등 |
| 4 | asset_name | 자산명 | VARCHAR(100) | N | |
| 5 | asset_value | 자산가액 | BIGINT | Y | 원 |
| 6 | related_loan | 관련차입금 | BIGINT | N | 원 |
| 7 | interest_amount | 차입금이자 | BIGINT | N | 원 |
| 8 | disallowed_amount | 손금불산입액 | BIGINT | N | 산출 결과 |


### 3.22 TBL_DISASTER_LOSS — 재해손실 정보 *(v4.0r1 신규, M37)*

> **목적**: 법인세법 §58 재해손실세액공제 — 천재지변 등으로 자산 총액의 20% 이상 상실 시 미납부 법인세 공제

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK → TBL_CORP_BASIC |
| 2 | disaster_id | 재해ID | INT | Y | PK |
| 3 | disaster_date | 재해발생일 | DATE | Y | |
| 4 | disaster_type | 재해유형 | VARCHAR(50) | Y | 화재/풍수해/지진/전시사변 등 |
| 5 | total_asset_book_value | 재해전자산총액 | BIGINT | Y | 토지 제외 자산 장부가액 |
| 6 | lost_asset_book_value | 상실자산가액 | BIGINT | Y | 상실된 자산 장부가액 |
| 7 | insurance_compensation | 보험금수령액 | BIGINT | N | 참고용 |
| 8 | loss_ratio | 상실비율 | DECIMAL(5,2) | Y | 상실가액/총액 (20% 이상 요건) |
| 9 | unpaid_tax | 미납부법인세 | BIGINT | Y | 재해 발생 연도 미납부 법인세 |
| 10 | tax_year | 귀속사업연도 | VARCHAR(4) | Y | |

### 3.23 TBL_CONSOLIDATED_SUBSIDIARY — 연결납세 자회사 *(v4.0r1 신규, M38)*

> **목적**: 법인세법 §76의8 연결납세 적용 시 자회사 정보 관리 (완전 지배 관계 확인)

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | parent_corp_id | 모법인ID | VARCHAR(20) | Y | FK → TBL_CORP_BASIC |
| 2 | sub_corp_id | 자회사ID | VARCHAR(20) | Y | PK |
| 3 | sub_corp_name | 자회사명 | VARCHAR(100) | Y | |
| 4 | sub_biz_reg_no | 자회사사업자번호 | VARCHAR(15) | Y | |
| 5 | share_ratio | 지분율 | DECIMAL(5,2) | Y | 100% 완전모자 요건 확인 |
| 6 | holding_start_date | 지분보유시작일 | DATE | N | |
| 7 | fiscal_year | 적용사업연도 | VARCHAR(4) | Y | |
| 8 | sub_taxable_income | 자회사소득금액 | BIGINT | N | 개별 소득금액 |
| 9 | sub_deficit | 자회사결손금 | BIGINT | N | 개별 결손금 |
| 10 | sub_computed_tax | 자회사산출세액 | BIGINT | N | 개별 산출세액 |

### 3.24 TBL_DEPRECIATION_ADJUST — 감가상각 시부인 이월 *(v4.0r1 신규, M42)*

> **목적**: 감가상각비 한도초과액 이월 추인(신고조정) — 전기 한도초과액이 있고 당기 시인부족액 발생 시 손금산입(△유보) 누락 여부 검토
> **주의**: 감가상각비 추가 계상(결산조정)은 경정청구 불가. 한도초과 이월 추인(신고조정)만 가능

| No | 컬럼명 | 한글명 | 데이터타입 | 필수 | 설명 |
|----|--------|--------|-----------|------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | Y | FK → TBL_CORP_BASIC |
| 2 | depreciation_id | 감가상각ID | INT | Y | PK |
| 3 | asset_category | 자산종류 | VARCHAR(50) | Y | 건물/기계장치/차량 등 |
| 4 | tax_year | 귀속사업연도 | VARCHAR(4) | Y | |
| 5 | book_depreciation | 회계상감가상각비 | BIGINT | Y | 결산서 계상액 |
| 6 | tax_limit | 세무상한도액 | BIGINT | Y | 정률법/정액법 한도 |
| 7 | excess_amount | 한도초과액 | BIGINT | N | 회계상 > 세무상 (유보 발생) |
| 8 | shortfall_amount | 시인부족액 | BIGINT | N | 세무상 > 회계상 |
| 9 | carryforward_excess | 전기이월한도초과액 | BIGINT | N | 전기에서 이월된 한도초과 잔액 |
| 10 | reinstatement_amount | 추인가능액 | BIGINT | N | MIN(시인부족액, 전기이월한도초과) → 손금산입(△유보) |
| 11 | remaining_excess | 잔여한도초과액 | BIGINT | N | 차기 이월액 |


## 4. 테이블 설계 — 기준정보 테이블

### 4.1 REF_TAX_RATE — 법인세율 기준

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | rate_id | 세율ID | INT | PK |
| 2 | year_from | 적용시작연도 | VARCHAR(4) | |
| 3 | year_to | 적용종료연도 | VARCHAR(4) | |
| 4 | bracket_min | 과세표준하한 | BIGINT | 원 |
| 5 | bracket_max | 과세표준상한 | BIGINT | 원, NULL=무한 |
| 6 | tax_rate | 세율 | DECIMAL(5,2) | % |
| 7 | progressive_deduction | 누진공제 | BIGINT | 원 |

**기본 데이터 (2023~2025년)**:

| 과세표준 구간 | 세율 |
|-------------|------|
| ~2억 | 9% |
| 2억~200억 | 19% |
| 200억~3,000억 | 21% |
| 3,000억 초과 | 24% |

### 4.2 REF_MIN_TAX_RATE — 최저한세율 기준

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | min_tax_id | ID | INT | PK |
| 2 | corp_size | 기업규모 | VARCHAR(10) | 중소/중견/대기업 |
| 3 | bracket_min | 과세표준하한 | BIGINT | |
| 4 | bracket_max | 과세표준상한 | BIGINT | |
| 5 | min_rate | 최저한세율 | DECIMAL(5,2) | % |

**기본 데이터**:

| 기업규모 | 과세표준 | 최저한세율 |
|---------|---------|-----------|
| 중소기업 | 전 구간 | 7% |
| 중견·대기업 | ~100억 | 10% |
| 중견·대기업 | 100억~1,000억 | 12% |
| 중견·대기업 | 1,000억 초과 | 17% |

### 4.3 REF_EMPLOYMENT_CREDIT — 통합고용세액공제 금액 기준

> ★v3.0: 사업연도별 시행령 별표 참조 원칙 — 아래는 2024 사업연도 기준 예시 (E05)

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | credit_id | ID | INT | PK |
| 2 | tax_year | 적용과세연도 | VARCHAR(4) | |
| 3 | corp_size | 기업규모 | VARCHAR(10) | |
| 4 | region | 지역구분 | VARCHAR(10) | 수도권/비수도권 |
| 5 | worker_type | 근로자유형 | VARCHAR(20) | 청년등/일반 |
| 6 | credit_per_person | 1인당공제금액 | BIGINT | 원 |

**기본 데이터 (2024 사업연도 기준 예시)**:

| 기업규모 | 지역 | 유형 | 1인당 공제 |
|---------|------|------|-----------|
| 중소기업 | 수도권 | 청년등 | 1,550만원 |
| 중소기업 | 수도권 | 일반 | 850만원 |
| 중소기업 | 비수도권 | 청년등 | 1,550만원 |
| 중소기업 | 비수도권 | 일반 | 950만원 |
| 중견기업 | 전체 | 청년등 | 800만원 |
| 중견기업 | 전체 | 일반 | 450만원 |
| 대기업 | 전체 | 청년등 | 400만원 |
| 대기업 | 전체 | 일반 | 0원 |

### 4.4 REF_INVESTMENT_CREDIT_RATE — 통합투자세액공제율 기준

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | rate_id | ID | INT | PK |
| 2 | tax_year_from | 적용시작연도 | VARCHAR(4) | |
| 3 | invest_type | 투자유형 | VARCHAR(30) | 일반/신성장/국가전략 |
| 4 | corp_size | 기업규모 | VARCHAR(10) | |
| 5 | basic_rate | 기본공제율 | DECIMAL(5,2) | % |
| 6 | additional_rate | 추가공제율 | DECIMAL(5,2) | % (3년평균초과분) |

### 4.5 REF_MUTUAL_EXCLUSION — 상호배제 매트릭스

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | rule_id | 규칙ID | INT | PK |
| 2 | provision_a | 조항A | VARCHAR(20) | 예: 제6조 |
| 3 | provision_b | 조항B | VARCHAR(20) | 예: 제7조 |
| 4 | year_from | 적용시작연도 | VARCHAR(4) | |
| 5 | year_to | 적용종료연도 | VARCHAR(4) | |
| 6 | is_allowed | 중복가능여부 | BOOLEAN | TRUE=중복가능 |
| 7 | condition_note | 조건비고 | VARCHAR(500) | 특수 조건 설명 |
| 8 | legal_basis | 근거법령 | VARCHAR(100) | |

**핵심 데이터**:

| 조항A | 조항B | 중복가능 | 조건 |
|-------|-------|---------|------|
| 제7조 | 제6조 | ✕ | 택1 선택 |
| 제7조 | 제24조 | ✕ | |
| 제7조 | 제29조의8 | ★ | 연도 무관 |
| 제7조 | 제30조의4 | ★ | |
| 제7조 | 제10조 | ★ | |
| 제6조 | 제24조 | ✕ | |
| 제6조 | 제29조의8 | ● | ~2024 중복가능, 2025~ 중복불가 |
| 제6조 | 제30조의4 | ✕ | |
| 제6조 | 제10조 | ★ | |
| 제24조 | 제29조의8 | ★ | |
| 제24조 | 제10조 | ✕ | 동일 자산 중복불가 |
| 제29조의8 | 제10조 | ★ | |
| 제29조의8 | 제30조의4 | ✕ | 2023~24 선택적용 |

### 4.6 REF_CAPITAL_ZONE — 수도권 지역 구분

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | zone_id | 지역ID | INT | PK |
| 2 | sido | 시도 | VARCHAR(20) | |
| 3 | sigungu | 시군구 | VARCHAR(50) | |
| 4 | zone_type | 지역구분 | VARCHAR(20) | 과밀억제/성장관리/자연보전/비수도권 |
| 5 | is_capital | 수도권여부 | BOOLEAN | |
| 6 | is_depopulation | 인구감소지역여부 | BOOLEAN | |

### 4.7 REF_NONGTEUKSE — 농어촌특별세 적용 기준

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | provision | 조항 | VARCHAR(20) | PK |
| 2 | is_exempt | 비과세여부 | BOOLEAN | |
| 3 | tax_rate | 농특세율 | DECIMAL(5,2) | 보통 20% 또는 0% |
| 4 | legal_basis | 근거법령 | VARCHAR(100) | |

**기본 데이터**:

| 조항 | 농특세 | 실질환급률 |
|------|--------|----------|
| 제6조 (창업감면) | 비과세 | 100% |
| 제7조 (중소특별) | 비과세 | 100% |
| 제10조 (R&D) | 비과세 | 100% |
| 제24조 (투자) | 과세 20% | 80% |
| 제29조의8 (고용) | 과세 20% | 80% |
| 제30조의4 (사보) | 과세 20% | 80% |

### 4.8 REF_SME_DEDUCTION_RATE — 중소기업 특별세액감면율

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | rate_id | ID | INT | PK |
| 2 | corp_size_detail | 기업규모상세 | VARCHAR(10) | 소기업/중기업 |
| 3 | industry_class | 업종분류 | VARCHAR(50) | |
| 4 | zone_type | 지역구분 | VARCHAR(20) | |
| 5 | deduction_rate | 감면율 | DECIMAL(5,2) | 5~30% |

### 4.9 REF_RD_CREDIT_RATE — R&D 세액공제율

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | rate_id | ID | INT | PK |
| 2 | rd_type | R&D유형 | VARCHAR(20) | 일반/신성장/국가전략 |
| 3 | method | 공제방식 | VARCHAR(10) | 증가분/당기분 |
| 4 | corp_size | 기업규모 | VARCHAR(10) | |
| 5 | credit_rate | 공제율 | DECIMAL(5,2) | % |
| 6 | min_tax_exempt | 최저한세배제 | VARCHAR(20) | 전액/50%/미배제 |

### 4.10 REF_REFUND_INTEREST_RATE — 환급가산금 이율 *(v2.0 신규, M13)*

> 프롬프트: 점검 9-5, 국기법 시행규칙 §19의3

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | rate_id | ID | INT | PK |
| 2 | effective_from | 적용시작일 | DATE | |
| 3 | effective_to | 적용종료일 | DATE | |
| 4 | annual_rate | 연이율 | DECIMAL(7,5) | % |
| 5 | legal_basis | 근거법령 | VARCHAR(100) | 국기법 시행규칙 §19의3 |

### 4.11 REF_STARTUP_DEDUCTION_RATE — 창업감면 감면율 기준 *(v2.0 신규)*

> 프롬프트: 점검 12, 제6조 감면율 결정 기준 (지역·창업자유형별)

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | rate_id | ID | INT | PK |
| 2 | founder_type | 창업자유형 | VARCHAR(20) | 청년/비청년/벤처 |
| 3 | location_type | 소재지구분 | VARCHAR(30) | 수도권과밀억제/비수도권/인구감소지역 |
| 4 | deduction_rate | 감면율 | DECIMAL(5,2) | 50/75/100 (%) |
| 5 | year_from | 적용시작연도 | VARCHAR(4) | |
| 6 | year_to | 적용종료연도 | VARCHAR(4) | |
| 7 | legal_basis | 근거법령 | VARCHAR(100) | 조특법 §6①②③ |
| 8 | remark | 비고 | VARCHAR(200) | 2025년 이후 인구감소지역 100% 감면 등 |

### 4.12 REF_DEPOPULATION_AREA — 인구감소지역 목록 *(v2.0 신규)*

> 프롬프트: 점검 12 (2025년 이후 창업 100% 감면), 행정안전부 고시

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | area_id | ID | INT | PK |
| 2 | sido | 시도 | VARCHAR(20) | |
| 3 | sigungu | 시군구 | VARCHAR(50) | |
| 4 | designation_date | 지정일 | DATE | |
| 5 | effective_from | 적용시작일 | DATE | |
| 6 | is_active | 유효여부 | BOOLEAN | |

### 4.13 REF_CORP_TAX_RATE_HISTORY — 법인세율 이력 (2022년 이전 포함) *(v2.0 신규)*

> 프롬프트: 점검 0 [핵심 전제] — 2023년 이전 세율 구간 상이

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | rate_id | ID | INT | PK |
| 2 | year_from | 적용시작연도 | VARCHAR(4) | 예: 2018 |
| 3 | year_to | 적용종료연도 | VARCHAR(4) | 예: 2022 |
| 4 | bracket_min | 과세표준하한 | BIGINT | |
| 5 | bracket_max | 과세표준상한 | BIGINT | NULL=무한 |
| 6 | tax_rate | 세율 | DECIMAL(5,2) | % |
| 7 | progressive_deduction | 누진공제액 | BIGINT | |

**참조**: 2018~2022년: 10%/20%/22%/25% (4단계), 2023~2025년: 9%/19%/21%/24% (4단계)

### 4.14 REF_LAW_VERSION — 법령 버전 관리 *(v2.0 신규, I02)*

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | version_id | ID | INT | PK |
| 2 | law_name | 법령명 | VARCHAR(100) | 법인세법/조특법/국기법 등 |
| 3 | provision | 조항 | VARCHAR(20) | |
| 4 | year_from | 적용시작사업연도 | VARCHAR(4) | |
| 5 | year_to | 적용종료사업연도 | VARCHAR(4) | |
| 6 | version_note | 버전설명 | TEXT | 개정 주요 내용 |

### 4.15 REF_DIVIDEND_EXCLUSION — 수입배당금 익금불산입률 *(v1.1 → v3.0 통합)*

> **목적**: 법인세법 제18조의2에 따른 지분율별 익금불산입률 기준 관리

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | exclusion_id | ID | INT | PK |
| 2 | year_from | 적용시작연도 | VARCHAR(4) | |
| 3 | year_to | 적용종료연도 | VARCHAR(4) | |
| 4 | corp_type | 구분 | VARCHAR(20) | 일반/상장/비상장/지주회사 |
| 5 | share_ratio_min | 지분율하한 | DECIMAL(5,2) | % |
| 6 | share_ratio_max | 지분율상한 | DECIMAL(5,2) | % |
| 7 | exclusion_rate | 익금불산입률 | DECIMAL(5,2) | % |
| 8 | remark | 비고 | VARCHAR(200) | |

**기본 데이터**:

| 적용연도 | 구분 | 지분율 구간 | 익금불산입률 | 비고 |
|---------|------|-----------|------------|------|
| 2023~ | 일반 | 50% 이상 | 100% | 2023 개정법, 상장/비상장 구분 폐지 |
| 2023~ | 일반 | 30% ~ 50% 미만 | 80% | |
| 2023~ | 일반 | 30% 미만 | 30% | |
| ~2022 | 상장 | 100% | 100% | 구법 |
| ~2022 | 상장 | 30% ~ 100% 미만 | 30% | |
| ~2022 | 상장 | 30% 미만 | 0% | |
| ~2022 | 비상장 | 50% 이상 | 100% | |
| ~2022 | 비상장 | 50% 미만 | 30% | |
| ~2022 | 지주회사 | 80%(상장40%)이상 | 100% | 지주회사특례 |
| ~2022 | 지주회사 | 80%(상장40%)미만 | 80% | |

### 4.16 REF_RD_MIN_TAX_EXEMPT — R&D 최저한세 배제율 *(v1.1 → v3.0 통합)*

> **목적**: R&D 세액공제 유형별 최저한세 배제 비율을 별도 기준 테이블로 분리 관리

| R&D 유형 | 대상 기업 | 배제율 | 비고 |
|---------|----------|-------|------|
| 국가전략기술 | 전체(중소/중견/대) | 100% | 전액 최저한세 적용 제외 |
| 신성장·원천기술 | 중소기업 | 100% | 전액 최저한세 적용 제외 |
| 신성장·원천기술 | 중견·대기업 | 0% | 전액 최저한세 적용 |
| 일반 R&D | 중소기업 | 50% | 공제액의 50%만 최저한세 배제, 나머지 50%는 최저한세 적용 |
| 일반 R&D | 중견·대기업 | 0% | 전액 최저한세 적용 |


### 4.17 REF_INDUSTRY_ELIGIBILITY — 업종별 감면 적격성 *(v4.0 신규, M26)*

> **목적**: 조특법 §6(창업감면)·§7(중소특별) 대상/제외 업종 판단

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | ksic_code | 업종코드 | VARCHAR(10) | PK (KSIC 세분류) |
| 2 | industry_name | 업종명 | VARCHAR(100) | |
| 3 | startup_eligible | 창업감면적격 | BOOLEAN | 제6조 대상 여부 |
| 4 | sme_special_eligible | 중소특별적격 | BOOLEAN | 제7조 대상 여부 |
| 5 | excluded_reason | 제외사유 | VARCHAR(200) | 부동산업·유흥업 등 제외 사유 |
| 6 | effective_from | 적용시작일 | DATE | |
| 7 | effective_to | 적용종료일 | DATE | |
| 8 | **is_sme_eligible** | **중소기업해당업종** | BOOLEAN | 중소기업기본법상 해당 업종 여부 | ★v4.0r1 (SME_SCOPE 통합) |

### 4.18 REF_ENTERTAINMENT_LIMIT — 접대비 한도 기준 *(v4.0 신규, M25)*

> **목적**: 법인세법 §25 접대비 한도 계산 기준

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | limit_id | ID | INT | PK |
| 2 | corp_size | 기업규모 | VARCHAR(10) | 중소기업/일반법인 |
| 3 | base_amount | 기본한도 | BIGINT | 중소기업 3,600만원(일반 1,200만원) × 사업연도월수/12 |
| 4 | revenue_bracket_min | 수입금액하한 | BIGINT | |
| 5 | revenue_bracket_max | 수입금액상한 | BIGINT | |
| 6 | rate | 적용률 | DECIMAL(5,4) | % |
| 7 | year_from | 적용시작연도 | VARCHAR(4) | |
| 8 | year_to | 적용종료연도 | VARCHAR(4) | |

**기본 데이터** (2024년 기준):

| 구분 | 기본한도(연) | 수입금액 구간 | 적용률 |
|------|------------|-------------|-------|
| 중소기업 | 3,600만원 | 100억 이하 | 0.3% |
| 중소기업 | 3,600만원 | 100~500억 | 0.2% |
| 중소기업 | 3,600만원 | 500억 초과 | 0.03% |
| 일반법인 | 1,200만원 | 100억 이하 | 0.2% |
| 일반법인 | 1,200만원 | 100~500억 | 0.1% |
| 일반법인 | 1,200만원 | 500억 초과 | 0.03% |

### 4.19 REF_SYSTEM_PARAM — 시스템 파라미터 *(v4.0 신규, M32)*

> **목적**: 시스템 설정 가능 파라미터 중앙 관리

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | param_key | 파라미터키 | VARCHAR(50) | PK |
| 2 | param_value | 파라미터값 | VARCHAR(100) | |
| 3 | param_type | 데이터유형 | VARCHAR(20) | NUMBER/STRING/BOOLEAN |
| 4 | description | 설명 | VARCHAR(200) | |
| 5 | modifiable | 수정가능여부 | BOOLEAN | |
| 6 | last_updated | 최종수정일 | DATE | |

**기본 데이터**:

| 파라미터키 | 기본값 | 수정가능 | 설명 |
|-----------|--------|---------|------|
| discount_rate | 0.03 | Y | NPV 할인율 (소급공제 vs 이월공제 비교) |
| refund_processing_days | 90 | Y | 환급 결정 예상 소요일 |
| truncation_policy | TRUNCATE | N | 절사 정책 (반올림 금지) |
| min_tax_recalc_iterations | 5 | Y | 최저한세 순환 참조 최대 반복 횟수 |
| combination_search_timeout | 300 | Y | 조합 탐색 타임아웃 (초) |

### 4.20 REF_KSIC_CODE — 한국표준산업분류 *(v4.0 신규, M35)*

> **목적**: 업종코드 검증 및 감면 적격성 매핑 기준

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | ksic_code | 업종코드 | VARCHAR(10) | PK (세분류 5자리) |
| 2 | section | 대분류 | VARCHAR(5) | A~U |
| 3 | division | 중분류 | VARCHAR(5) | 2자리 |
| 4 | group_code | 소분류 | VARCHAR(5) | 3자리 |
| 5 | class_code | 세분류 | VARCHAR(5) | 4자리 |
| 6 | sub_class | 세세분류 | VARCHAR(5) | 5자리 |
| 7 | industry_name | 업종명 | VARCHAR(200) | |
| 8 | revision | 개정차수 | VARCHAR(10) | 예: 10차 |
| 9 | effective_date | 시행일 | DATE | |



### 4.21 REF_EXCHANGE_RATE — 외국환 매매기준율 *(v4.0r1 신규)*

> **목적**: 외국납부세액 원화 환산 — 서울외국환중개 매매기준율 기준
> **갱신**: 일별 (영업일 기준), 또는 수동 입력

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | rate_date | 고시일자 | DATE | PK (복합) |
| 2 | currency | 통화코드 | VARCHAR(3) | PK (복합) — USD, JPY, EUR 등 |
| 3 | standard_rate | 매매기준율 | DECIMAL(10,4) | |
| 4 | buy_rate | 매입율 | DECIMAL(10,4) | |
| 5 | sell_rate | 매도율 | DECIMAL(10,4) | |

### 4.22 REF_DEEMED_INTEREST_RATE — 인정이자율 기준 *(v4.0r1 신규)*

> **목적**: 가지급금 인정이자 계산 — 당좌대출이자율 (국세청 고시)
> **갱신**: 연 1회 (국세청 고시 확인)

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | year | 적용연도 | VARCHAR(4) | PK |
| 2 | rate_type | 이자율유형 | VARCHAR(20) | 당좌대출이자율/가중평균차입이자율 |
| 3 | rate | 이자율 | DECIMAL(5,2) | % |
| 4 | legal_basis | 근거 | VARCHAR(100) | 법인세법 시행규칙 §43 |

**기본 데이터**:

| 연도 | 유형 | 이자율 | 비고 |
|------|------|--------|------|
| 2024 | 당좌대출이자율 | 4.6% | 가중평균차입이자율 산정 불가 시 적용 |
| 2023 | 당좌대출이자율 | 4.6% | |


---

## 5. 테이블 설계 — 출력(산출) 테이블

### 5.1 OUT_EMPLOYEE_SUMMARY — 상시근로자 산정 결과

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | corp_id | 법인ID | VARCHAR(20) | PK |
| 2 | prior_total | 직전연도_전체상시근로자 | DECIMAL(10,2) | 연평균 |
| 3 | prior_youth | 직전연도_청년등 | DECIMAL(10,2) | |
| 4 | prior_general | 직전연도_일반 | DECIMAL(10,2) | |
| 5 | current_total | 해당연도_전체상시근로자 | DECIMAL(10,2) | |
| 6 | current_youth | 해당연도_청년등 | DECIMAL(10,2) | |
| 7 | current_general | 해당연도_일반 | DECIMAL(10,2) | |
| 8 | increase_total | 전체증가분 | DECIMAL(10,2) | |
| 9 | increase_youth | 청년등증가분 | DECIMAL(10,2) | 조정 후 |
| 10 | increase_general | 일반증가분 | DECIMAL(10,2) | 조정 후 |
| 11 | excluded_count | 제외대상인원 | INT | |

### 5.2 OUT_INDIVIDUAL_CREDIT — 개별 공제·감면 산출 결과

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | calc_id | 산출ID | INT | PK |
| 2 | corp_id | 법인ID | VARCHAR(20) | FK |
| 3 | provision | 적용조항 | VARCHAR(20) | 제6조/제7조/제10조/제24조/제29조의8 등 |
| 4 | credit_type | 유형 | VARCHAR(10) | 감면/공제 |
| 5 | gross_amount | 총공제감면액 | BIGINT | 농특세 차감 전 |
| 6 | nongteuk_tax | 농특세액 | BIGINT | |
| 7 | net_amount | 실질환급액 | BIGINT | 농특세 차감 후 |
| 8 | is_carryforward | 이월가능여부 | BOOLEAN | |
| 9 | carryforward_amount | 이월공제액 | BIGINT | 최저한세 초과분 |
| 10 | min_tax_exempt | 최저한세배제분 | BIGINT | R&D 등 |
| 11 | legal_basis | 근거법령 | VARCHAR(100) | |
| 12 | calc_detail | 산출상세 | TEXT | JSON 형태 산출 과정 |

### 5.3 OUT_COMBINATION — 조합 비교 결과 (기본)

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | combo_id | 조합ID | INT | PK |
| 2 | corp_id | 법인ID | VARCHAR(20) | FK |
| 3 | combo_rank | 순위 | INT | 1=최적 |
| 4 | combo_name | 조합명 | VARCHAR(200) | 예: "제7조+제29조의8+제10조" |
| 5 | group_type | 그룹유형 | VARCHAR(5) | A/B |
| 6 | total_gross | 총공제감면액_합계 | BIGINT | |
| 7 | total_nongteuk | 농특세합계 | BIGINT | |
| 8 | min_tax_limit | 최저한세한도적용후 | BIGINT | |
| 9 | total_net | 실질환급액_합계 | BIGINT | |
| 10 | refund_amount | 경정청구환급액 | BIGINT | 기존납부 - 경정후 |
| 11 | is_valid | 유효여부 | BOOLEAN | 상호배제 위반 없음 |
| 12 | detail_items | 포함항목상세 | TEXT | JSON |

### 5.5 OUT_FINAL_REFUND — 최종 환급액 산출 (v2.0 보완)

> v1.0 기반 + 중간예납 환급액 필드 추가

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | refund_id | 환급ID | INT | PK |
| 2 | corp_id | 법인ID | VARCHAR(20) | FK |
| 3 | existing_computed_tax | 기존산출세액 | BIGINT | |
| 4 | existing_deductions | 기존공제감면합계 | BIGINT | |
| 5 | existing_determined_tax | 기존결정세액 | BIGINT | |
| 6 | existing_paid_tax | 기존납부세액 | BIGINT | |
| 7 | new_computed_tax | 경정후산출세액 | BIGINT | |
| 8 | new_deductions | 경정후공제감면합계 | BIGINT | |
| 9 | new_determined_tax | 경정후결정세액 | BIGINT | |
| 10 | corp_tax_refund | 법인세환급액 | BIGINT | 기존납부 - 경정후결정 |
| 11 | **interim_tax_refund** | **중간예납환급액** | BIGINT | ★v2.0 신규: 중간예납 과납 환급분 |
| 12 | refund_interest | 환급가산금 | BIGINT | |
| 13 | **interim_interest** | **중간예납환급가산금** | BIGINT | ★v2.0 신규: 기산일 별도 |
| 14 | local_tax_refund | 지방소득세환급액 | BIGINT | 법인세환급 × 10% |
| 15 | total_refund | 총수령예상액 | BIGINT | 법인세+가산금+지방 |
| 16 | carryforward_credits | 이월공제잔액 | BIGINT | |
| 17 | optimal_combo_id | 최적조합ID | INT | FK → OUT_COMBINATION |

### 5.6 OUT_COMBINATION — 최적 조합 상세 (v2.0 보완)

> v1.0 기반 + R&D 최저한세 배제 상세 추가

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | combo_id | 조합ID | INT | PK |
| 2 | corp_id | 법인ID | VARCHAR(20) | FK |
| 3 | combo_rank | 순위 | INT | 1=최적 |
| 4 | exemption_provision | 감면조항 | VARCHAR(20) | 제6조/제7조/없음 |
| 5 | exemption_amount | 감면세액 | BIGINT | |
| 6 | credit_provisions | 공제조항목록 | VARCHAR(200) | 예: 제29조의8,제10조 |
| 7 | credit_amount | 공제세액합계 | BIGINT | |
| 8 | min_tax_cut | 최저한세감액분 | BIGINT | |
| 9 | **rd_min_tax_exempt_national** | **R&D국가전략배제액** | BIGINT | ★v2.0 신규: 전액 배제 |
| 10 | **rd_min_tax_exempt_growth** | **R&D신성장배제액** | BIGINT | ★v2.0 신규: 중소 전액 배제 |
| 11 | **rd_min_tax_exempt_general** | **R&D일반배제액** | BIGINT | ★v2.0 신규: 중소 50% 배제 |
| 12 | nongteuk_tax | 농특세액 | BIGINT | |
| 13 | net_benefit | 실질환급액 | BIGINT | 공제감면 - 농특세 |
| 14 | carryforward_items | 이월항목상세 | TEXT | JSON: [{provision, year, amount}] |

### 5.8 OUT_RISK_ASSESSMENT — 사후관리 리스크 평가 *(v2.0 신규, M24)*

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | risk_id | 리스크ID | INT | PK |
| 2 | corp_id | 법인ID | VARCHAR(20) | FK |
| 3 | provision | 관련조항 | VARCHAR(20) | |
| 4 | risk_type | 리스크유형 | VARCHAR(50) | 고용유지/자산처분/감가상각 등 |
| 5 | risk_period_start | 의무기간시작 | DATE | |
| 6 | risk_period_end | 의무기간종료 | DATE | |
| 7 | potential_clawback | 추징예상액 | BIGINT | |
| 8 | interest_addition | 이자상당가산액 | BIGINT | 조특법 §146 |
| 9 | risk_level | 위험도 | VARCHAR(10) | 상/중/하 |
| 10 | description | 설명 | TEXT | |

### 5.9 OUT_CARRYFORWARD_PLAN — 이월공제 활용 계획 *(v2.0 신규, I05)*

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | plan_id | 계획ID | INT | PK |
| 2 | corp_id | 법인ID | VARCHAR(20) | FK |
| 3 | provision | 조항 | VARCHAR(20) | |
| 4 | origin_year | 발생연도 | VARCHAR(4) | |
| 5 | planned_use_year | 활용예정연도 | VARCHAR(4) | |
| 6 | planned_amount | 활용예정금액 | BIGINT | |
| 7 | expiry_year | 소멸연도 | VARCHAR(4) | |

### 5.10 LOG_CALCULATION — 감사추적 로그 *(v2.0 신규, I06)*

| No | 컬럼명 | 한글명 | 데이터타입 | 설명 |
|----|--------|--------|-----------|------|
| 1 | log_id | 로그ID | BIGINT | PK |
| 2 | corp_id | 법인ID | VARCHAR(20) | FK |
| 3 | calc_step | 계산단계 | VARCHAR(50) | STEP0/STEP1/... |
| 4 | function_name | 함수명 | VARCHAR(100) | |
| 5 | input_data | 입력데이터 | TEXT | JSON |
| 6 | output_data | 출력데이터 | TEXT | JSON |
| 7 | timestamp | 처리시각 | TIMESTAMP | |
| 8 | legal_basis | 근거법령 | VARCHAR(100) | |

---

## 6. 단계별 업무처리 절차서

### 6.1 전체 처리 흐름도

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                   STEP 0: 사전 점검 및 경정청구 전략 수립                       │
│  ┌──────────┐  ┌────────────┐  ┌──────────────┐  ┌────────────────────┐    │
│  │경정청구   │→ │중소기업    │→ │소재지 구분   │→ │결산확정 원칙       │    │
│  │기한 확인  │  │해당여부판단│  │(본점간주규정)│  │(신고조정/결산조정)  │    │
│  └──────────┘  └────────────┘  └──────────────┘  └────────────────────┘    │
│  ┌──────────────────┐  ┌──────────────────────────────┐                    │
│  │경정청구 가능/불가 │→ │후발적 경정청구 사유 확인       │                    │
│  │사전 필터          │  │(국기법 §45의2②)               │                    │
│  └──────────────────┘  └──────────────────────────────┘                    │
└────────────────────────┬───────────────────────────────────────────────────┘
                         ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│              STEP 1: 과세체계 확인 및 기초 데이터 산정                         │
│  ┌─────────────┐  ┌──────────────┐  ┌───────────────┐  ┌──────────────┐   │
│  │과세표준 검증 │→ │이월결손금    │→ │상시근로자수  │→ │중간예납      │   │
│  │(법인세율)    │  │재검토        │  │산정(제외대상) │  │납부확인      │   │
│  └─────────────┘  └──────────────┘  └───────────────┘  └──────────────┘   │
└────────────────────────┬───────────────────────────────────────────────────┘
                         ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│              STEP 2: 개별 공제·감면 항목 산출                                  │
│  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐ ┌──────────┐     │
│  │제6조   │ │제7조   │ │제10조  │ │제24조  │ │제29조  │ │제30조의4 │     │
│  │창업감면│ │중소특별│ │R&D    │ │투자    │ │의8고용│ │사보      │     │
│  └───┬────┘ └───┬────┘ └───┬────┘ └───┬────┘ └───┬────┘ └────┬─────┘     │
│      └──────────┴──────────┴──────────┴──────────┴───────────┘           │
│  ┌────────┐ ┌────────┐ ┌────────┐ ┌──────────┐ ┌──────────┐             │
│  │외국납부│ │수입배당│ │이월결손│ │결손금    │ │세무조정  │             │
│  │세액공제│ │금익금↓ │ │금재검토│ │소급공제  │ │재검토    │             │
│  └────────┘ └────────┘ └────────┘ └──────────┘ └──────────┘             │
│  ┌────────┐ ┌────────┐ ┌────────┐                                       │
│  │토지양도│ │구조조정│ │연결납세│                                       │
│  │세추가  │ │과세이연│ │특화    │                                       │
│  └────────┘ └────────┘ └────────┘                                       │
└────────────────────────┬───────────────────────────────────────────────────┘
                         ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│              STEP 3: 최적 조합 탐색                                           │
│  ┌──────────────┐  ┌───────────────┐  ┌──────────────┐                    │
│  │상호배제      │→ │후보 조합      │→ │세액 적용순서 │                    │
│  │규칙 필터     │  │생성(B&B)      │  │(법59조)      │                    │
│  └──────────────┘  └───────────────┘  └──────────────┘                    │
│                             ▼                                              │
│  ┌──────────────┐  ┌───────────────┐  ┌──────────────┐                    │
│  │최저한세      │→ │R&D최저한세   │→ │농특세 적용   │                    │
│  │적용          │  │배제처리(3단계)│  │(항목별 차등) │                    │
│  └──────────────┘  └───────────────┘  └──────────────┘                    │
│                             ▼                                              │
│  ┌──────────────┐  ┌───────────────┐                                      │
│  │이월공제 처리 │→ │실질 환급액    │                                      │
│  │(10년 이월)   │  │비교·선택      │                                      │
│  └──────────────┘  └───────────────┘                                      │
└────────────────────────┬───────────────────────────────────────────────────┘
                         ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│              STEP 4: 최종 환급액 산출                                          │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐    │
│  │환급액    │→ │환급가산  │→ │중간예납  │→ │지방소득  │→ │총수령    │    │
│  │비교표    │  │금 산출   │  │환급확인  │  │세 안내   │  │예상액    │    │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘  └──────────┘    │
└────────────────────────┬───────────────────────────────────────────────────┘
                         ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│              STEP 5: 보고서 생성 및 사후관리 안내                               │
│  요약표 | 최적조합 | 최저한세영향 | 환급액비교표 |                              │
│  세무조정변동 | 필요증빙 | 사후관리리스크 | 추가확인필요항목 |                  │
│  이월공제활용계획 | 지방소득세경정청구안내                                      │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 6.2 STEP 0: 사전 점검 — 상세 절차 *(v4.0r1 M43 보강)*

| 순서 | 처리내용 | 입력 | 출력 | 판단기준 | 근거법령 |
|------|---------|------|------|---------|---------|
| 0-1 | 경정청구 기한 확인 | 사업연도종료일 | 기한도과여부 | 법정신고기한 후 5년 이내 | 국기법 §45의2① |
| 0-2 | 법정신고기한 산정 | 사업연도종료일 | 법정신고기한 | 종료 후 3개월 (12월결산: 익년 3.31) | 법인세법 §60 |
| 0-3 | 경정청구 마감일 산출 | 법정신고기한 | 마감일 | 법정신고기한 + 5년 | 국기법 §45의2① |
| 0-4 | **후발적 경정청구 사유 확인** | 판결·결정 등 | 후발적사유해당여부 | 사유 발생을 안 날부터 3개월 | 국기법 §45의2② ★v2.0 |
| 0-5 | 중소기업 해당 여부 | 매출액, 주주구조 | 중소/중견/대 | 매출액기준 + 독립성기준 + 졸업유예 | 조특법 시행령 §2 |
| 0-6 | **졸업유예 기간 판단** | 졸업연도, 업종 | 유예기간(3년/5년) | 업종·시행령 적용시기별 상이 | 조특법 시행령 §2⑤ ★v2.0 |
| 0-7 | 본점 소재지 판단 | 본점주소 | 수도권구분 | REF_CAPITAL_ZONE 참조 | 수도권정비계획법 §2 |
| 0-8 | 본점 간주 규정 적용 | 본점수도권여부 | 전사업장수도권간주 | 본점이 수도권 → 전사업장 수도권 | 조특법 §7①단서 |
| 0-9 | **결산확정 원칙 검증** | 경정청구 대상 항목 | 가능/불가 구분 | 결산조정 항목 → 경정청구 불가 차단 | 법인세법 §40 ★v2.0 (M3-06) |
| 0-10 | **법인 전환 이력 확인** | 법인 설립 경위 | 전환/창업 구분 | 개인→법인 전환 시 창업감면 불가 | 조특법 §6①단서 ★v2.0 |

### 6.3 STEP 1: 과세체계 확인 — 상세 절차

| 순서 | 처리내용 | 산출 공식 | 주의사항 |
|------|---------|----------|---------|
| 1-1 | 과세표준 검증 | 각사업연도소득 - 이월결손금 - 비과세소득 | 이월결손금 한도: 중소 100%, 기타 80% |
| 1-2 | **이월결손금 공제 한도 적용** | MIN(이월결손금잔액, 소득×한도율) | 2020년 이후: 15년 이월 / 이전: 10년 이월 ★v2.0 |
| 1-3 | 산출세액 계산 | 과세표준 × 법인세율(초과누진) | **사업연도별 세율 확인 필수** (2022이전/2023이후 상이) |
| 1-4 | 상시근로자 수 산정 | Σ(매월말 상시근로자) ÷ 해당월수 | 소수점 3자리 절사, 2자리까지 |
| 1-5 | 제외 대상 필터링 | 최대주주가족, 임원, 단시간, 1년미만, 파견 제외 | 연속갱신 1년이상 → 포함 |
| 1-6 | 청년등 구분 | 만15~34세(병역가산 최대6년) | **2024이전: 과세연도말 기준** / **2025이후: 근로계약체결시** ★v2.0 |
| 1-7 | 증감 인원 산정 | 해당연도 - 직전연도 (전체/청년등/일반) | 전체 ≤ 0 → 고용공제 불가 |
| 1-8 | **중간예납 납부내역 확인** | TBL_INTERIM_TAX 조회 | 과납 여부 확인, 환급가산금 기산일 분리 ★v2.0 |

### 6.4 STEP 2: 개별 공제·감면 산출 — 상세 절차

#### 6.4.1 통합고용세액공제 (제29조의8) — v2.0 보강

| 순서 | 처리 | 공식 | v2.0 보강사항 |
|------|------|------|-------------|
| 2A-1 | 전체 증가분 확인 | 해당연도전체 - 직전연도전체 (≤0 → 종료) | |
| 2A-2 | 청년등 증가분 산정 | MIN(청년등증가분, 전체증가분) | 청년 판단 시점 연도별 분기 적용 |
| 2A-3 | 일반 증가분 산정 | 전체증가분 - 청년등증가분(조정후) | **대기업 일반: 공제금액 0원** ★v2.0 |
| 2A-4 | 기본 공제세액 | (청년등증가 × 청년등단가) + (일반증가 × 일반단가) | 사업연도별 시행령 별표 참조 원칙 |
| 2A-5 | 추가 공제(경력단절) | 경력단절재고용인원 × 1,300만/900만원 | 퇴직 후 2~15년 이내 재고용 |
| 2A-6 | 추가 공제(정규직전환) | 전환인원 × 1,300만/900만원 | 전환 후 2년 유지 조건 |
| 2A-7 | 추가 공제(육아복귀) | 복귀인원 × 1,300만/900만원 | 복귀 후 6개월 이상 근무 |
| 2A-8 | 총 공제세액 | 기본 + 추가항목 합계 | |
| 2A-9 | **제29조의7 경과규정 비교** | 2022년 적용분 2차·3차 추가공제 산출 | 2023~2024년: §29의7 vs §29의8 유리선택 ★v2.0 |

#### 6.4.2 통합투자세액공제 (제24조) — v4.0r1 E16 배제 로직 보강

| 순서 | 처리 | 공식 |
|------|------|------|
| 2B-1 | 투자 자산 분류 | 자산별 투자유형 구분 (일반/신성장/국가전략) |
| 2B-2 | 수도권 제한 확인 | **설치장소 기준** 과밀억제권역 여부 (본점간주X, 실제투자장소) |
| 2B-3 | 기본공제 산출 | 투자금액 × 기본공제율 (규모·유형별) |
| 2B-4 | 추가공제 산출 | MAX(0, 당해투자 - 직전3년평균) × 추가공제율 |
| 2B-5 | 총 공제세액 | 기본공제 + 추가공제 |

#### 6.4.3 창업중소기업 세액감면 (제6조) — v2.0 보강

| 순서 | 처리 | 공식 | v2.0 보강사항 |
|------|------|------|-------------|
| 2C-1 | 창업 요건 확인 | 소재지, 업종, 승계여부, 중소기업여부 | 법인 전환 여부 확인 |
| 2C-2 | **감면율 결정** | 청년/비청년/벤처/지역별 → 50~100% | REF_STARTUP_DEDUCTION_RATE 참조 ★v2.0 |
| 2C-3 | 감면 기간 확인 | 최초소득발생 + 4년 = 5년간 | |
| 2C-4 | 감면세액 산출 | 산출세액 × 감면대상소득비율 × 감면율 | |
| 2C-5 | **중복적용 연도별 분기** | 2024이전: 제6조+제29조의8 가능 / 2025이후: 택1 | ★v2.0 핵심 |
| 2C-6 | **인구감소지역 100% 감면** | 2025년 이후 인구감소지역 창업 시 | REF_DEPOPULATION_AREA 참조 ★v2.0 |

#### 6.4.4 중소기업 특별세액감면 (제7조)

| 순서 | 처리 | 공식 |
|------|------|------|
| 2D-1 | 감면율 결정 | 업종·규모·소재지별 5~30% |
| 2D-2 | 감면세액 산출 | 산출세액 × 감면대상소득비율 × 감면율 |
| 2D-3 | 감면한도 적용 | MIN(감면세액, MAX(0, 1억 - 감소인원×500만)) |
| 2D-4 | 우대 감면율 확인 | 10년이상+소득1억이하+성실사업자 → ×110% |

#### 6.4.5 연구인력개발비 세액공제 (제10조) — v2.0 보강

| 순서 | 처리 | 공식 | v2.0 보강사항 |
|------|------|------|-------------|
| 2E-1 | R&D 유형 구분 | 일반/신성장/국가전략 | TBL_RD_EXPENSE 활용 |
| 2E-2 | 증가분 방식 산출 | (해당R&D비 - 직전R&D비) × 공제율 | |
| 2E-3 | 당기분 방식 산출 | 해당R&D비 × 공제율 | |
| 2E-4 | 유리한 방식 선택 | MAX(증가분공제, 당기분공제) | 경정청구로 방식 변경 가능 (서이 46012-11806) |
| 2E-5 | **최저한세 배제액 산출** | 유형별 3단계 배제 산출 | 국가전략:전액 / 신성장·중소:전액 / 일반·중소:50% ★v2.0 |

#### 6.4.6 사회보험료세액공제 (제30조의4) — v2.0 보강

| 순서 | 처리 | 공식 |
|------|------|------|
| 2F-1 | 대상자 확인 | 고용증가인원 중 사회보험 신규가입자 |
| 2F-2 | 청년 기준 확인 | **만 15~29세 (통합고용과 다름)** ★v2.0 (M18) |
| 2F-3 | 공제세액 산출 | 사업주 부담분 × 공제율 (50%/100%) |

#### 6.4.7 외국납부세액공제 (법인세법 §57) — v2.0 신규

| 순서 | 처리 | 공식 |
|------|------|------|
| 2G-1 | 외국납부세액 확인 | TBL_CORP_BASIC.foreign_tax_paid |
| 2G-2 | **직접공제 산출** | MIN(외국납부세액, 산출세액 × 국외소득/과세표준) |
| 2G-3 | **손금산입 산출** | 외국납부세액 전액 손금 → 과세표준 감소 효과 |
| 2G-4 | **유리한 방식 비교** | 직접공제 vs 손금산입 → 환급액 극대화 방식 선택 ★v2.0 |

#### 6.4.8 수입배당금 익금불산입 (법인세법 §18의2) — v2.0 신규

| 순서 | 처리 | 공식 |
|------|------|------|
| 2H-1 | 지분율 확인 | 출자법인별 지분율 조회 |
| 2H-2 | **익금불산입 비율 결정** | **2023년 개정법 3단계:** 50%이상→100%, 30~50%미만→80%, 30%미만→30% | ★v4.0 정정 (E09) | 
| 2H-3 | **2023년 개정 전후 구분** | 개정 전/후 지분율 기준 상이 ★v2.0 |
| 2H-4 | 과세표준 재산출 | 익금불산입 적용 후 과세표준 변동 반영 |

#### 6.4.9 결손금 소급공제 (법인세법 §72) — v2.0 신규 (M4-10)

| 순서 | 처리 | 공식 |
|------|------|------|
| 2I-1 | 중소기업 여부 확인 | 소급공제는 중소기업만 가능 |
| 2I-2 | 직전 사업연도 납부세액 확인 | 소급공제 환급 한도 |
| 2I-3 | 소급공제 환급액 산출 | 직전년도법인세 × (결손금/직전년도과세표준) |
| 2I-4 | **이월 vs 소급 NPV 비교** | 이월공제의 현재가치와 소급공제 즉시환급 비교 ★v2.0 (I09) |

#### 6.4.10 세무조정 재검토 — v2.0 신규 (M4-11)

| 순서 | 처리 | 점검항목 |
|------|------|---------|
| 2J-1 | 손금불산입 오류 검토 | 법인세법 §19~§28 위반 여부 |
| 2J-2 | 익금불산입 누락 확인 | 법인세법 §18 해당 항목 미적용 |
| 2J-3 | **업무용 승용차** | 감가상각 한도·운행일지·비용 불산입 재검토 (시행령 §50의2) |
| 2J-4 | 접대비 한도 초과 여부 | 법인세법 §25, REF_ENTERTAINMENT_LIMIT 참조 |
| 2J-5 | **국고보조금 익금불산입** | 법인세법 §18① — 자산취득 시 일시상각충당금 설정 확인 | ★v4.0 신규 (E12) |
| 2J-6 | **가지급금 인정이자** | 시행령 §89 — 특수관계인 가지급금 인정이자 익금산입 | ★v4.0 신규 (M27) |
| 2J-7 | **업무무관자산 차입금이자** | 법인세법 §28 — 업무무관자산 관련 차입금이자 손금불산입 | ★v4.0 신규 (M28) |

#### 6.4.11 토지등 양도세 추가과세 — v2.0 신규 (M4-12)

| 순서 | 처리 | 점검항목 |
|------|------|---------|
| 2K-1 | 추가과세 적용 대상 확인 | 비사업용 토지, 주택 양도 |
| 2K-2 | 적용 오류 검토 | 법인세법 §55의2 과세 요건 충족 여부 |
| 2K-3 | 비과세·감면 적용 확인 | 양도세 추가과세 비적용 사유 검토 |

#### 6.4.12 재해손실세액공제 (법인세법 §58) — v4.0r1 신규 (M37)

| 순서 | 처리 | 공식 |
|------|------|------|
| 2L-1 | 재해 발생 확인 | TBL_DISASTER_LOSS 데이터 존재 여부 |
| 2L-2 | **상실 비율 검증** | 상실비율 = 상실자산가액 / 재해전자산총액 ≥ 20% 요건 |
| 2L-3 | **공제세액 산출** | 공제액 = 미납부법인세 × 상실비율 |
| 2L-4 | **한도 적용** | MIN(공제액, 상실자산가액) |
| 2L-5 | 기존 적용 확인 | 기존 신고에서 미적용 시 경정청구 대상 |


### 6.5 STEP 3: 최적 조합 탐색 — 상세 절차

| 순서 | 처리내용 | 설명 | v2.0 보강사항 |
|------|---------|------|-------------|
| 3-1 | 후보 조합 생성 | 가능한 모든 감면+공제 조합 열거 | **Branch & Bound 알고리즘 적용** ★v2.0 (I10) |
| 3-2 | 상호배제 필터링 | REF_MUTUAL_EXCLUSION 참조, 위반 조합 제거 | **제6조+제29조의8 연도별 분기 반영** ★v2.0 |
| 3-3 | 조합별 세액 적용순서 적용 | **① 감면 → ② 이월불가공제 → ③ 이월가능공제** | 법인세법 §59 준수 |
| 3-4 | 최저한세 적용 | 산출세액 - 최저한세액 = 공제감면 가능 한도 | 과세표준 기준 (법인세 고유) |
| 3-5 | **R&D 최저한세 배제 3단계** | ① 국가전략: 전액 ② 신성장·중소: 전액 ③ 일반·중소: 50% | ★v2.0 핵심 (조특법 §132②) |
| 3-6 | 감면 초과분 처리 | **감면(이월불가) 초과분 = 소멸** | ★v2.0 (E04) |
| 3-7 | 공제 초과분 처리 | **공제(이월가능) 초과분 = 이월(10년)** | ★v2.0 (E04) |
| 3-8 | 농특세 적용 | 항목별 비과세/20% 적용 | **공제 변경 시 농특세 연쇄 재계산** ★v2.0 (I11) |
| 3-9 | 실질 환급액 산출 | 각 조합별 실질환급액 = 총공제감면 - 농특세 | |
| 3-10 | 최적 조합 선택 | 실질환급액 최대 조합 = 1순위 | |

**최적 조합 탐색 핵심 시나리오**:

| 시나리오 | 감면 | 공제 | R&D | 특징 |
|---------|------|------|-----|------|
| 그룹A-1 | 제6조(창업) | 제29조의8(고용)* | 제10조 | *2024이전만 중복가능, 2025이후 택1 |
| 그룹A-2 | 제7조(중소특별) | 제29조의8(고용) | 제10조 | 3중 병행, 핵심 전략 |
| 그룹A-3 | 제7조(중소특별) | 제29조의7(경과규정) | 제10조 | 2023~2024년 한정 비교 대상 |
| 그룹B-1 | 없음 | 제24조+제29조의8 | 제10조 | 투자액 큰 경우 |
| 그룹B-2 | 없음 | 제29조의8(고용) | 제10조 | 고용 증가만 |
| 그룹C | 제6조(창업) | 없음 | 제10조 | 2025이후 감면만+R&D |

### 6.6 STEP 4: 최종 환급액 산출 — 상세 절차

| 순서 | 처리 | 공식 | v2.0 보강사항 |
|------|------|------|-------------|
| 4-1 | 경정 후 결정세액 | 산출세액 - 최적조합 공제감면액(최저한세 적용 후) | |
| 4-2 | 법인세 환급액 | 기존납부세액 - 경정후결정세액 | |
| 4-3 | **본세 환급가산금** | 환급액 × 이율 × 일수 ÷ 365 (1원미만절사) | 기산일: 원래 납부일 다음날, 종료일: 지급결정일 ★v2.0 (E06) |
| 4-4 | **중간예납 환급가산금** | 중간예납환급액 × 이율 × 일수 ÷ 365 | 기산일: 중간예납 납부일 다음날 (별도 기산) ★v2.0 (I12) |
| 4-5 | 지방소득세 환급 | 법인세환급액 × 10% | **별도 경정청구 필요** ★v2.0 (M6-05) |
| 4-6 | 총수령예상액 | 법인세환급 + 환급가산금(본세+중간예납) + 지방소득세환급 | |

### 6.7 STEP 5: 보고서 생성 — v2.0 보강

**보고서 3종 분리** *(v2.0 신규, I08)*:

| 보고서 유형 | 대상 | 포함 내용 |
|------------|------|----------|
| ① 요약보고서 | 경영진 | 환급예상액, 최적조합, 핵심 변경사항, 리스크 요약 |
| ② 상세보고서 | 세무담당자 | 전체 산출 과정, 계산식, 근거법령, 조합별 비교, 검증 로그 |
| ③ 납세자제출용 | 과세관청 | 경정청구서 양식, 첨부서류 목록, 근거서류 |

**보고서 필수 포함 섹션**:

1. 환급액 요약표 (기존 vs 경정후)
2. 최적 조합 상세 (적용 조항, 공제·감면액)
3. 최저한세 영향 분석 (R&D 배제 상세 포함)
4. 환급가산금 산출 내역 (본세/중간예납 분리)
5. 지방소득세 경정청구 안내
6. 농특세 변동 내역
7. 이월공제 잔액 및 향후 활용 계획
8. 사후관리 리스크 평가 (추징 예상액, 의무기간)
9. 필요 증빙서류 목록
10. 추가 확인 필요 항목

---

## 7. 개별 기능 상세설계

### 7.1 [M3-04] 상시근로자 수 산정

**목적**: 통합고용세액공제의 핵심 입력값인 상시근로자 증감 인원을 정확히 산정

**처리 로직**:

```
FUNCTION calculate_regular_employees(corp_id, year_type):

  1. TBL_EMPLOYEE_DETAIL에서 해당 corp_id, year_type 근로자 목록 조회
  
  2. 제외 대상 필터링:
     - TBL_REPRESENTATIVE에서 최대주주 및 배우자, 직계존비속 조회 → 제외
     - role_type = '등기임원' 또는 '감사' → 제외
     - monthly_hours < 60 → 제외 (단시간 근로자)
     - 근로계약기간 1년 미만 → 제외 (단, 연속갱신 총 1년 이상 → 포함) ★v2.0
     - contract_type = '파견' → 제외
  
  3. 월별 상시근로자 수 집계:
     FOR each month in year:
       month_count = 해당월 말일 기준 재직자 수 (제외 대상 차감)
       → TBL_EMPLOYEE_MONTHLY에 저장
  
  4. 연평균 산정:
     annual_avg = TRUNCATE(SUM(monthly_counts) / active_months, 2)
     ※ 소수점 3자리에서 절사 (TRUNCATE, NOT ROUND)
  
  5. 청년등 구분:  ★v2.0 연도별 분기 추가
     FOR each employee:
       IF target_tax_year <= 2024:
         age_base_date = fiscal_end    // 과세연도 말일 기준
       ELSE:
         age_base_date = hire_date     // 근로계약 체결일 기준 (2025~)
       
       age = age_at(age_base_date, birth_date)
       military_years = MIN(6, military_end - military_start)  // 최대 6년
       
       IF age <= 34 + military_years → 청년
       IF is_disabled → 장애인 (청년등)
       IF age >= 60 → 60세이상 (청년등)
       IF is_career_break → 경력단절여성 (청년등)
       IF is_nk_defector → 북한이탈주민 (청년등)  ★v2.0
  
  RETURN {total_avg, youth_avg, general_avg, monthly_details}
```

### 7.2 [M3-06] 결산확정 원칙 검증 *(v2.0 신규)*

**목적**: 경정청구 대상 항목 중 결산조정이 필요한 항목을 사전 차단

**처리 로직**:

```
FUNCTION validate_settlement_principle(claim_items):

  // 결산조정 항목 (경정청구 불가)
  SETTLEMENT_REQUIRED = [
    '감가상각비 추가 계상',
    '퇴직급여충당금 추가',
    '대손충당금 추가',
    '감가상각 방법 변경',
    '결산서 변경 필요 항목'
  ]
  
  // 신고조정 항목 (경정청구 가능)
  RETURN_ADJUSTABLE = [
    '세액감면 신규/변경',
    '세액공제 추가',
    '공제방식 변경(R&D)',
    '일시상각충당금',
    '익금불산입 누락',
    '외국납부세액공제 방식 변경',
    '이월결손금 오류 수정'
  ]
  
  FOR each item in claim_items:
    IF item IN SETTLEMENT_REQUIRED:
      item.status = 'BLOCKED'
      item.reason = '결산조정 항목으로 경정청구 대상 아님 (법인세법 §40)'
    ELSE:
      item.status = 'ELIGIBLE'
  
  // 과세관청 직권경정 시 과소신고분 감면 차단
  IF corp.amendment_history contains '직권경정':
    FOR each 감면 item:
      item.warning = '직권경정 사업연도 감면 적용 제한 확인 (조특법 §128③)'
  
  RETURN filtered_items
```

### 7.3 [M4-02] 통합고용세액공제 — 경과규정 비교 *(v2.0 보강)*

**목적**: 2023~2024년 과세연도에서 제29조의7 경과규정과 제29조의8 중 유리한 공제 선택

```
FUNCTION compare_employment_credits(corp_id, tax_year):
  
  IF tax_year IN [2023, 2024]:
    // 2022년 고용증대세액공제(§29의7) 적용 이력 확인
    IF has_prior_art29_7(corp_id, 2022):
      
      // 경과규정 산출: 2022년 기준 2차·3차 추가공제
      transitional_credit = calc_art29_7_transitional(corp_id, tax_year)
      
      // 통합고용세액공제 산출
      integrated_credit = calc_art29_8(corp_id, tax_year)
      
      // 유리한 쪽 선택
      IF transitional_credit > integrated_credit:
        RETURN {provision: '제29조의7', amount: transitional_credit, reason: '경과규정 유리'}
      ELSE:
        RETURN {provision: '제29조의8', amount: integrated_credit, reason: '통합고용 유리'}
    
    ELSE:
      RETURN calc_art29_8(corp_id, tax_year)
  
  ELSE:
    RETURN calc_art29_8(corp_id, tax_year)
```

### 7.4 [M5-02] 최적 조합 탐색 — v2.0 보강

**목적**: 상호배제 규칙과 최저한세를 반영하여 실질 환급액 극대화 조합 산출

```
FUNCTION find_optimal_combination(corp_id, individual_credits):
  
  // 1. 상호배제 규칙 로드
  exclusion_rules = REF_MUTUAL_EXCLUSION.load()
  
  // 2. 연도별 중복적용 분기 ★v2.0
  IF target_tax_year <= 2024:
    exclusion_rules.allow('제6조', '제29조의8')   // 중복 허용
  ELSE:
    exclusion_rules.deny('제6조', '제29조의8')    // 택1
  
  // 3. 후보 조합 생성 (Branch & Bound) ★v2.0 (I10)
  candidates = generate_combinations_bnb(individual_credits, exclusion_rules)
  
  FOR each combo in candidates:
    
    // 4. 법인세법 §59 적용순서
    step1 = apply_exemptions(combo.exemptions)       // ① 감면
    step2 = apply_non_carryover(combo.credits_nc)    // ② 이월불가공제
    step3 = apply_carryover(combo.credits_cf)        // ③ 이월가능공제
    
    // 5. 최저한세 적용 (과세표준 기준)
    min_tax = computed_tax * min_tax_rate(corp_size, taxable_income)
    max_deduction = computed_tax - min_tax
    
    // 감면 초과분: 소멸 (이월불가) ★v2.0 (E04)
    IF step1.total > max_deduction:
      step1.excess = step1.total - max_deduction  // 소멸
      step1.applied = max_deduction
    
    // 공제 초과분: 이월 ★v2.0 (E04)
    remaining_limit = max_deduction - step1.applied
    IF (step2.total + step3.total) > remaining_limit:
      excess = (step2.total + step3.total) - remaining_limit
      combo.carryforward = allocate_carryforward(excess, combo.credits_cf)  // 10년 이월
    
    // 6. R&D 최저한세 배제 3단계 ★v2.0
    rd_exempt = 0
    rd_exempt += combo.rd_national_strategic   // 국가전략: 전액
    IF corp_size == '중소기업':
      rd_exempt += combo.rd_new_growth         // 신성장: 중소 전액
      rd_exempt += combo.rd_general * 0.5      // 일반: 중소 50%
    
    combo.total_applied = step1.applied + step2.applied + step3.applied + rd_exempt
    
    // 7. 농특세 (항목별 차등)
    combo.nongteuk = calc_nongteuk_by_item(combo)
    
    // 8. 실질 환급액
    combo.net_refund = combo.total_applied - combo.nongteuk
  
  // 9. 최적 조합 선택 (실질환급액 내림차순)
  RETURN candidates.sort_by(net_refund, DESC)
```

### 7.5 [M6-02] 환급가산금 산출 — v2.0 보강

**목적**: 본세와 중간예납의 환급가산금을 분리 산출

```
FUNCTION calc_refund_interest(corp_id, refund_amount):
  
  // 본세 환급가산금
  main_start = original_payment_date + 1일   // 기산일: 납부일 다음날 ★v2.0 (E06)
  main_end = refund_decision_date            // 종료일: 지급결정일
  main_days = main_end - main_start
  main_rate = REF_REFUND_INTEREST_RATE.get(main_start, main_end)  // 기간별 변동이율
  main_interest = TRUNCATE(refund_amount * main_rate * main_days / 365, 0)  // 1원미만 절사
  
  // 중간예납 환급가산금 (별도 기산) ★v2.0 (I12)
  interim_records = TBL_INTERIM_TAX.get(corp_id)
  interim_interest = 0
  FOR each record in interim_records:
    int_start = record.payment_date + 1일
    int_days = refund_decision_date - int_start
    int_rate = REF_REFUND_INTEREST_RATE.get(int_start, refund_decision_date)
    interim_interest += TRUNCATE(record.overpaid * int_rate * int_days / 365, 0)
  
  RETURN {
    main_interest: main_interest,
    interim_interest: interim_interest,
    total_interest: main_interest + interim_interest
  }
```

### 7.6 [M6-05] 지방소득세 경정청구 안내 *(v2.0 신규)*

**목적**: 법인세 환급에 따른 지방소득세 별도 경정청구 필요성 안내

```
FUNCTION generate_local_tax_guidance(corp_tax_refund):
  
  local_tax_refund = corp_tax_refund * 0.10   // 법인세 × 10%
  
  guidance = {
    refund_amount: local_tax_refund,
    filing_to: '본점 소재지 지방자치단체',
    deadline: '법인세 경정청구 결정 통보 후 2개월 이내',
    required_docs: [
      '법인세 경정결정통지서 사본',
      '지방소득세 경정청구서',
      '지방소득세 과세표준 및 세액 신고서'
    ],
    note: '법인세 경정청구와 별도로 지방소득세 경정청구 필요 (자동 연동 아님)'
  }
  
  RETURN guidance
```

### 7.7 [M3-03] 소재지 구분 판단 로직 분기 *(v1.1 → v3.0 통합)*

**목적**: 적용 항목에 따라 서로 다른 소재지 판단 기준을 정확히 적용하여 공제 누락 또는 과다 적용 방지

**근거**: 제7조(본점 간주)와 제24조(실제 설치장소)의 판단 로직 분리

```
FUNCTION determine_location_zone(corp_id, provision):
  /*
   * 소재지 판단 기준은 적용 항목에 따라 이원화된다.
   *
   * - 제7조(중소기업 특별세액감면): 조특법 §7①단서
   *   → 법인의 본점 소재지를 기준으로 판단
   *   → 본점이 수도권이면 모든 사업장을 수도권으로 간주
   *
   * - 제24조(통합투자세액공제): 조특법 §24
   *   → 실제 자산이 설치된 장소를 기준으로 판단
   *   → 본점이 수도권이더라도, 자산이 비수도권에 설치되면 비수도권 공제율 적용
   *   → 과밀억제권역 내 투자는 공제 제한
   *
   * - 제6조(창업중소기업감면): 법인 소재지 기준
   * - 제29조의8(통합고용): 법인 전체 합산 (소재지 무관, 단 공제 금액은 지역별 차등)
   */
  
  IF provision == '제7조':
    // 본점 간주 규정 적용
    RETURN TBL_CORP_BASIC.capital_zone
    
  ELSE IF provision == '제24조':
    // 자산별 실제 설치 장소 기준 (자산 단위로 개별 판단)
    RETURN TBL_INVESTMENT_ASSET.install_location_zone
    
  ELSE IF provision == '제6조':
    // 창업 소재지 기준
    RETURN TBL_STARTUP_INFO.location_zone
    
  ELSE:
    // 기본: 법인 소재지
    RETURN TBL_CORP_BASIC.capital_zone
```

**소재지 교차 검증 로직**:

```
FUNCTION validate_location_for_combo(combo, corp_data):
  FOR each item IN combo:
    IF item == '제7조':
      assert item.location_source == 'capital_zone'
      IF corp_data.capital_zone IN ('과밀억제','성장관리','자연보전'):
        WARN "본점 수도권 간주규정으로 수도권 감면율 적용됨"
        
    IF item == '제24조':
      assert item.location_source == 'install_location_zone'
      IF asset.install_location_zone == '비수도권' AND corp_data.capital_zone != '비수도권':
        INFO "비수도권 설치 자산: 투자세액공제 적용 가능"
```

### 7.8 [M5-03] 최저한세 적용 상세 *(v1.1 → v3.0 통합)*

**처리 로직**:

```
FUNCTION calculate_min_tax(taxable_base, corp_size):

  IF corp_size == '중소기업':
    min_tax = taxable_base × 0.07
    
  ELSE:  // 중견·대기업
    IF taxable_base <= 10,000,000,000:
      min_tax = taxable_base × 0.10
    ELIF taxable_base <= 100,000,000,000:
      min_tax = 10,000,000,000 × 0.10 
               + (taxable_base - 10,000,000,000) × 0.12
    ELSE:
      min_tax = 10,000,000,000 × 0.10 
               + 90,000,000,000 × 0.12 
               + (taxable_base - 100,000,000,000) × 0.17

  // ★v4.0 주석 보강 (E10): 최저한세 계산 기준 명확화
  //   (1) 과세표준 × 최저한세율 = 최저한세액 (조특법 §132, 법인은 과세표준 기준)
  //   (2) 산출세액 - 최저한세액 = 공제·감면 가능 한도
  //   주의: 개인사업자는 산출세액 기준이나, 법인은 과세표준 기준으로 최저한세를 산출
  max_deductible = computed_tax - min_tax  // 공제·감면 가능 한도
  
  RETURN {min_tax, max_deductible}
```

**R&D 최저한세 배제분 상세 계산**:

```
FUNCTION calculate_rd_min_tax_exempt(rd_items, corp_size):
  /*
   * R&D 세액공제는 유형별로 최저한세 배제 비율이 상이하므로
   * 각 유형별로 개별 계산 후 합산한다.
   * 기준: REF_RD_MIN_TAX_EXEMPT 테이블
   */
  
  total_exempt = 0
  total_subject = 0  // 최저한세 적용 대상 금액
  
  FOR rd IN rd_items:
    exempt_rate = lookup(REF_RD_MIN_TAX_EXEMPT, rd.type, corp_size)
    
    IF rd.type == '국가전략기술':
      // 모든 기업: 100% 배제 → 전액 최저한세 한도 외 추가 공제
      total_exempt += rd.credit_amount
      
    ELSE IF rd.type == '신성장·원천기술':
      IF corp_size == '중소기업':
        // 중소기업: 100% 배제
        total_exempt += rd.credit_amount
      ELSE:
        // 중견·대기업: 0% 배제 → 전액 최저한세 적용
        total_subject += rd.credit_amount
        
    ELSE IF rd.type == '일반':
      IF corp_size == '중소기업':
        // 중소기업: 50% 배제 / 50% 적용
        total_exempt += TRUNCATE(rd.credit_amount * 0.5, 10)
        total_subject += rd.credit_amount - TRUNCATE(rd.credit_amount * 0.5, 10)
      ELSE:
        // 중견·대기업: 0% 배제 → 전액 최저한세 적용
        total_subject += rd.credit_amount
  
  RETURN {
    exempt_amount: total_exempt,      // 최저한세 한도와 무관하게 추가 공제 가능
    subject_amount: total_subject     // 최저한세 한도 내에서만 공제 가능
  }
```

### 7.9 [M4-09] 수입배당금 익금불산입 산출 상세 *(v1.1 → v3.0 통합)*

**목적**: 법인세법 제18조의2에 따라 수입배당금 중 익금불산입 금액을 정확히 산출하여 과세표준 재계산에 반영

```
FUNCTION calculate_dividend_exclusion(corp_id, tax_year):
  
  1. TBL_DIVIDEND_INCOME에서 해당 corp_id의 배당 명세 조회
  
  2. 적용 기준 판단 (연도별 분기):
     IF tax_year >= 2023:
       // 2023년 개정법: 상장/비상장 구분 폐지, 3단계 단순화
       FOR each dividend IN dividend_list:
         IF dividend.share_ratio >= 50:
           exclusion_rate = 100%
         ELSE IF dividend.share_ratio >= 30:
           exclusion_rate = 80%
         ELSE:
           exclusion_rate = 30%
         
         exclusion_amt = TRUNCATE(dividend.dividend_amt * exclusion_rate, 10)
     
     ELSE:  // 2022년 이전 — 구법 적용
       FOR each dividend IN dividend_list:
         IF dividend.is_holding_company:
           // 지주회사 특례
           threshold = IF dividend.is_listed THEN 40% ELSE 80%
           IF dividend.share_ratio >= threshold:
             exclusion_rate = 100%
           ELSE:
             exclusion_rate = 80%
         ELSE IF dividend.is_listed:
           // 상장법인
           IF dividend.share_ratio >= 100%: exclusion_rate = 100%
           ELSE IF dividend.share_ratio >= 30%: exclusion_rate = 30%
           ELSE: exclusion_rate = 0%
         ELSE:
           // 비상장법인
           IF dividend.share_ratio >= 50%: exclusion_rate = 100%
           ELSE: exclusion_rate = 30%
         
         exclusion_amt = TRUNCATE(dividend.dividend_amt * exclusion_rate, 10)
  
  3. 합산 및 과세표준 영향 계산:
     total_exclusion = SUM(각 배당별 exclusion_amt)
     // 과세표준 = 각사업연도소득 - 이월결손금 - 비과세소득 - 익금불산입
     // → 익금불산입 금액만큼 과세표준 감소 → 산출세액 재계산 필요
     
  RETURN {
    total_exclusion,
    detail: [{src_corp, share_ratio, dividend_amt, exclusion_rate, exclusion_amt}, ...]
  }
```

### 7.10 [M4-10] 결손금 소급공제 시뮬레이션 상세 *(v1.1 → v3.0 통합)*

**목적**: 중소기업의 당기 결손금에 대해 직전 연도 납부세액 환급(소급공제)과 향후 이월공제의 실익을 비교하여 최적 전략 제안

**근거**: 법인세법 제72조

```
FUNCTION simulate_loss_carryback(corp_id):
  
  1. 적격 요건 확인:
     IF NOT (corp_size IN ('소기업', '중기업')):
       RETURN {eligible: false, reason: "중소기업만 소급공제 가능"}
     IF current_year_loss <= 0:
       RETURN {eligible: false, reason: "당기 결손금 없음"}
     IF prior_year_tax_paid <= 0:
       RETURN {eligible: false, reason: "직전연도 납부세액 없음 — 소급공제 불가"}
  
  2. 소급공제 환급액 산출:
     // 소급공제 대상 결손금 = MIN(당기결손금, 직전연도 과세표준)
     carryback_loss = MIN(current_year_loss, prior_year_tax_base)
     
     // 환급액 = 소급공제 대상 결손금에 대한 직전연도 세율 적용
     revised_prior_tax = calculate_tax(prior_year_tax_base - carryback_loss)
     original_prior_tax = calculate_tax(prior_year_tax_base)
     
     carryback_refund = original_prior_tax - revised_prior_tax
     // 실제 환급액은 직전연도 납부세액 한도
     actual_refund = MIN(carryback_refund, prior_year_tax_paid)
  
  3. 이월공제 예상 실익 산출 (간이):
     // 향후 15년간 이월 적용 시 예상 절세효과
     carryforward_benefit = current_year_loss * estimated_future_rate
     // 현가 할인 (연 3% 가정, 평균 적용 시점 5년)
     carryforward_pv = TRUNCATE(carryforward_benefit / (1.03 ^ 5), 10)
  
  4. 비교 및 권고:
     IF actual_refund > carryforward_pv:
       recommendation = "소급공제 신청 권장"
     ELSE:
       recommendation = "이월공제(15년) 적용 권장"
  
  RETURN {
    eligible: true,
    carryback_refund: actual_refund,
    carryforward_pv: carryforward_pv,
    recommendation, reason
  }
```

---


### 7.11 [M4-11] 세무조정 재검토 상세 *(v4.0 보강, E12·M27·M28)*

**목적**: 기존 신고 세무조정사항의 오류·누락을 체계적으로 재검토하여 추가 환급 가능액 산출

```
FUNCTION review_tax_adjustments(corp_id, tax_year):
  result = {additional_refund: 0, adjustments: []}
  
  // === (1) 국고보조금 익금불산입 검토 ===
  subsidies = SELECT * FROM TBL_GOVERNMENT_SUBSIDY WHERE corp_id AND NOT exclusion_applied
  FOR s IN subsidies:
    IF s.asset_acquired:
      // 자산취득용: 일시상각충당금 설정 확인
      adjustment = s.subsidy_amount  // 익금불산입
      result.adjustments.append({item: '국고보조금', type: '익금불산입', amount: adjustment})
    ELSE:
      // 사업운영용: 미사용 잔액 익금불산입 검토
      ...
  
  // === (2) 가지급금 인정이자 검토 ===
  loans = SELECT * FROM TBL_SHAREHOLDER_LOAN WHERE corp_id
  FOR loan IN loans:
    deemed_interest = loan.loan_balance × loan.deemed_interest_rate × (loan.loan_period_months / 12)
    // 기존 신고에서 이미 인정이자 처리했는지 확인
    existing = SELECT FROM TBL_TAX_ADJUSTMENT 
               WHERE adjustment_item LIKE '%인정이자%' AND tax_year
    IF existing IS NULL:
      result.adjustments.append({item: '가지급금인정이자', type: '익금산입', amount: deemed_interest})
  
  // === (3) 업무무관자산 차입금이자 검토 ===
  assets = SELECT * FROM TBL_NON_BUSINESS_ASSET WHERE corp_id
  FOR asset IN assets:
    disallowed = asset.interest_amount × (asset.asset_value / total_assets)
    result.adjustments.append({item: '업무무관자산이자', type: '손금불산입', amount: disallowed})
  
  // === (4) 업무용 승용차 비용 불산입 검토 ===
  vehicles = SELECT * FROM TBL_BUSINESS_VEHICLE WHERE corp_id
  FOR v IN vehicles:
    IF NOT v.exclusive_insurance:
      disallowed = v.annual_expense  // 전액 불산입
    ELIF NOT v.logbook_maintained:
      disallowed = v.annual_expense × 0.5  // 50% 불산입
    ELSE:
      disallowed = MAX(v.annual_depreciation - v.depreciation_limit, 0)
    
    IF v.acquire_cost > 0:
      depreciation_disallowed = MAX(v.annual_depreciation - 8000000, 0)  // 연 800만원 한도
      disallowed += depreciation_disallowed
    
    result.adjustments.append({item: '업무용승용차', type: '손금불산입', amount: disallowed})
  
  // === (5) 접대비 한도 초과 검토 ===
  entertainment_total = SELECT SUM(expense_amount) FROM TBL_ENTERTAINMENT WHERE corp_id
  limit = calculate_entertainment_limit(corp_id)  // F53
  IF entertainment_total > limit:
    disallowed = entertainment_total - limit
    result.adjustments.append({item: '접대비한도초과', type: '손금불산입', amount: disallowed})
  
  RETURN result
```

### 7.12 [M5-02] 순환 참조 해결 — 과세표준 변동 시 최저한세 재계산 *(v4.0 신규, I16)*

**목적**: 익금불산입(수입배당금, 국고보조금 등) 적용 → 과세표준 변동 → 최저한세 재계산 루프

```
FUNCTION resolve_circular_reference(corp_id, initial_combination):
  max_iterations = lookup(REF_SYSTEM_PARAM, 'min_tax_recalc_iterations')  // 기본 5회
  prev_refund = 0
  
  FOR i IN 1..max_iterations:
    // (1) 익금불산입 적용 후 과세표준 재산출
    adjusted_taxable = recalculate_taxable_base(corp_id, initial_combination)
    
    // (2) 재산출된 과세표준으로 산출세액 재계산
    adjusted_tax = calculate_computed_tax(adjusted_taxable)
    
    // (3) 새로운 산출세액으로 최저한세 재계산
    min_tax_result = calculate_min_tax(adjusted_taxable, corp_size)
    
    // (4) 공제·감면 한도 재적용
    adjusted_refund = apply_deductions_with_limit(
      initial_combination, adjusted_tax, min_tax_result.max_deductible)
    
    // (5) 수렴 여부 확인 (1원 이내 차이)
    IF ABS(adjusted_refund - prev_refund) <= 1:
      RETURN {converged: true, iterations: i, final_refund: adjusted_refund}
    
    prev_refund = adjusted_refund
  
  // 수렴 실패 시 경고
  RETURN {converged: false, iterations: max_iterations, final_refund: prev_refund,
          warning: 'W_CIRCULAR_NOT_CONVERGED'}
```

### 7.13 [M7-01] 다수 과세연도 시뮬레이션 — 연도별 중소기업 재판단 *(v4.0 보강, I17·M36)*

**목적**: 복수 과세연도 일괄 경정청구 시 연도별 중소기업 해당 여부 재판단

```
FUNCTION simulate_multi_year(corp_id, year_list):
  results = []
  
  FOR year IN year_list:
    // (1) 해당 연도 중소기업 해당 여부 재판단
    sme_status = evaluate_sme_status(corp_id, year)
    //   - 매출액 기준 (업종별 중소기업 매출 한도)
    //   - 독립성 기준 (대기업 지분 30% 미만)
    //   - 졸업유예 적용 (최초 초과 과세연도 + 3년)
    
    // (2) 해당 연도 적용 법령 버전 자동 로드 ★I24
    law_version = lookup(REF_LAW_VERSION, year)
    
    // (3) 해당 연도 기준으로 전체 계산 실행
    year_result = calculate_full(corp_id, year, sme_status, law_version)
    
    results.append({year: year, sme_status: sme_status, result: year_result})
  
  // (4) 연도간 이월공제 연계 분석
  carryforward_plan = optimize_carryforward_across_years(results)
  
  RETURN {year_results: results, carryforward_plan: carryforward_plan}
```

### 7.14 [I21] 사후관리 리스크 정량화 *(v4.0 신규)*

**목적**: 고용 유지 실패·자산 처분 등 사후관리 위반 시 추징 예상액 자동 계산

```
FUNCTION quantify_risk(corp_id, tax_year):
  risks = []
  
  // (1) 고용 유지 실패 리스크 (통합고용세액공제)
  employment_credits = SELECT * FROM OUT_INDIVIDUAL_CREDIT 
                       WHERE provision = '제29조의8' AND corp_id
  FOR credit IN employment_credits:
    // 2년 고용유지 의무 위반 시
    clawback = credit.credit_amount
    interest = clawback × refund_interest_rate × (violation_days / 365)
    risks.append({
      type: '고용유지실패',
      provision: '제29조의8',
      clawback_amount: clawback,
      interest_surcharge: interest,
      total_risk: clawback + interest
    })
  
  // (2) 자산 처분 리스크 (통합투자세액공제)
  investment_assets = SELECT * FROM TBL_INVESTMENT_ASSET WHERE corp_id AND disposal_date IS NOT NULL
  FOR asset IN investment_assets:
    IF (disposal_date - acquire_date).days < 730:  // 2년 이내 처분
      clawback = asset.tax_credit
      risks.append({
        type: '자산조기처분',
        provision: '조특법 §146',
        asset_name: asset.asset_name,
        clawback_amount: clawback
      })
  
  // (3) 감가상각 의무 미이행 리스크
  FOR asset IN investment_assets:
    IF asset.actual_depreciation < asset.required_depreciation:
      shortfall = asset.required_depreciation - asset.actual_depreciation
      risks.append({
        type: '감가상각의무미이행',
        provision: '조특법 §128⑨',
        shortfall_amount: shortfall
      })
  
  RETURN risks
```



### 7.15 [M4-07] 외국납부세액공제 — 간접공제 포함 최적 방식 비교 *(v4.0r1 신규, E18)*

**목적**: 직접공제, 간접공제(자회사 배당), 손금산입 방식을 모두 비교하여 최적 유리 방식 도출

```
FUNCTION calculate_foreign_tax_credit_v2(corp_id, tax_year):
  
  // === (1) 직접외국납부세액 집계 ===
  direct_taxes = SELECT * FROM TBL_FOREIGN_TAX 
                 WHERE corp_id AND NOT is_indirect_credit AND tax_year
  total_direct = SUM(direct_taxes.foreign_tax_paid)
  total_foreign_income = SUM(direct_taxes.foreign_income)
  
  // === (2) 간접외국납부세액 계산 (법인세법 §57④) ===
  indirect_items = SELECT * FROM TBL_FOREIGN_TAX 
                   WHERE corp_id AND is_indirect_credit AND tax_year
  total_indirect = 0
  FOR item IN indirect_items:
    IF item.subsidiary_share_ratio >= 25.0:  // 25% 이상 지분 요건
      // 간접공제액 = 자회사법인세 × (수입배당금 / (자회사소득 - 자회사법인세))
      sub_net_income = item.foreign_income - item.subsidiary_tax_paid
      IF sub_net_income > 0:
        indirect_credit = item.subsidiary_tax_paid * (item.dividend_from_subsidiary / sub_net_income)
        total_indirect += TRUNCATE(indirect_credit, 10)
    ELSE:
      LOG_WARNING('W_INDIRECT_SHARE_BELOW_25', item.subsidiary_name)
  
  // === (3) 공제 한도 산정 ===
  // 한도 = 산출세액 × (국외원천소득 / 과세표준)
  taxable_base = lookup(TBL_CORP_BASIC, corp_id, 'taxable_income')
  computed_tax = lookup(TBL_CORP_BASIC, corp_id, 'computed_tax')
  
  credit_limit = TRUNCATE(computed_tax * (total_foreign_income / taxable_base), 10)
  
  total_credit_available = total_direct + total_indirect
  actual_credit = MIN(total_credit_available, credit_limit)
  excess_carryforward = total_credit_available - actual_credit  // 5년 이월
  
  // === (4) 손금산입 방식 비교 ===
  marginal_rate = get_marginal_tax_rate(taxable_base)
  deduction_benefit = TRUNCATE(total_credit_available * marginal_rate, 10)
  
  // === (5) 최적 방식 선택 ===
  IF actual_credit >= deduction_benefit:
    RETURN {method: 'CREDIT', direct: total_direct, indirect: total_indirect,
            amount: actual_credit, excess: excess_carryforward}
  ELSE:
    RETURN {method: 'EXPENSE', amount: deduction_benefit}
```

### 7.16 [M4-15] 재해손실세액공제 산출 *(v4.0r1 신규, M37)*

**목적**: 법인세법 §58 재해손실세액공제 — 자산 20% 이상 상실 시 미납부 법인세 공제

```
FUNCTION calc_disaster_loss_credit(corp_id, tax_year):
  disaster = SELECT * FROM TBL_DISASTER_LOSS WHERE corp_id AND tax_year
  
  IF disaster IS NULL:
    RETURN {eligible: false, amount: 0}
  
  // (1) 상실 비율 검증 (20% 이상)
  ratio = disaster.lost_asset_book_value / disaster.total_asset_book_value
  
  IF ratio < 0.20:
    RETURN {eligible: false, amount: 0, 
            reason: '상실비율 ' + FORMAT(ratio*100, '0.0') + '% — 20% 미만 부적격'}
  
  // (2) 공제 대상 세액 (미납부 법인세)
  target_tax = disaster.unpaid_tax
  
  // (3) 공제세액 산출
  credit_amount = TRUNCATE(target_tax * ratio, 10)
  
  // (4) 한도: 상실된 자산가액
  final_credit = MIN(credit_amount, disaster.lost_asset_book_value)
  
  RETURN {eligible: true, amount: TRUNCATE(final_credit, 10),
          loss_ratio: ratio, target_tax: target_tax}
```

### 7.17 [M3-01] 경정청구 불가 사유 사전 검증 *(v4.0r1 신규, M43)*

**목적**: 경정청구 자체가 불가능한 경우를 사전에 식별하여 불필요한 계산 방지

```
FUNCTION validate_claim_eligibility(corp_id, tax_year):
  errors = []
  
  // (1) 법정신고기한 후 5년 경과 여부
  filing_deadline = get_filing_deadline(tax_year)  // 사업연도 종료일 + 3개월
  claim_deadline = filing_deadline + 5 YEARS
  IF TODAY > claim_deadline:
    errors.append({code: 'DISQ_01', reason: '경정청구 기한(5년) 경과',
                   deadline: claim_deadline})
  
  // (2) 분식회계(사실과 다른 회계처리) 해당 여부
  corp = lookup(TBL_CORP_BASIC, corp_id)
  IF corp.claim_disqualification_check CONTAINS '분식회계':
    errors.append({code: 'DISQ_02', 
                   reason: '사실과 다른 회계처리(국기법 §45의2④) — 경정청구 제한'})
  
  // (3) 결산확정 원칙 위반 항목 사전 필터
  //     결산조정 항목(감가상각비 추가, 퇴직급여충당금 추가 등)은 경정청구 불가
  //     → 신고조정 가능 항목만 환급 전략에 포함
  
  // (4) 과세관청 직권경정 중 감면 적용 제한 확인
  IF corp.amendment_history CONTAINS '직권경정':
    errors.append({code: 'DISQ_03', 
                   reason: '직권경정 시 과소신고분 감면 제한(조특법 §128③) 확인 필요',
                   severity: 'WARNING'})
  
  IF errors.length > 0:
    RETURN {eligible: false, disqualifications: errors}
  ELSE:
    RETURN {eligible: true}
```

### 7.18 [M42] 감가상각 시부인 이월 추인 검토 *(v4.0r1 신규)*

**목적**: 전기 감가상각비 한도초과액(유보)이 있고 당기 시인부족액 발생 시, 손금산입(△유보) 누락 여부 검토

> **주의**: 감가상각비 "추가 계상"은 결산조정 항목이므로 경정청구 불가.
> 그러나 기존 유보의 "추인"(한도초과 이월액의 당기 손금산입)은 **신고조정**으로 가능 → 경정청구 대상

```
FUNCTION check_depreciation_reinstatement(corp_id, tax_year):
  adjustments = SELECT * FROM TBL_DEPRECIATION_ADJUST WHERE corp_id AND tax_year
  additional_deduction = 0
  
  FOR adj IN adjustments:
    IF adj.carryforward_excess > 0 AND adj.shortfall_amount > 0:
      // 전기 한도초과 이월액이 있고, 당기 시인부족(세무상 한도 > 회계상 계상)
      reinstatement = MIN(adj.shortfall_amount, adj.carryforward_excess)
      
      // 기존 신고에서 추인(손금산입 △유보)을 했는지 확인
      existing = SELECT FROM TBL_TAX_ADJUSTMENT 
                 WHERE corp_id AND tax_year AND adjustment_item LIKE '%감가상각%추인%'
      
      IF existing IS NULL OR existing.adjustment_amount < reinstatement:
        // 추인 누락 → 경정청구로 손금산입 가능
        missed = reinstatement - (existing.adjustment_amount IF existing ELSE 0)
        additional_deduction += missed
        
        LOG({item: adj.asset_category, 
             carryforward: adj.carryforward_excess,
             shortfall: adj.shortfall_amount,
             reinstatement_missed: missed})
  
  RETURN {additional_deduction: additional_deduction,
          tax_effect: additional_deduction * marginal_tax_rate}
```


## 8. 계산 공식 정의서

### 8.1 과세표준 및 산출세액

| 공식ID | 공식명 | 산출 공식 | 절사규칙 | 근거법령 | v2.0 변경 |
|--------|--------|----------|---------|---------|----------|
| F01 | 과세표준 | 각사업연도소득 - 이월결손금 - 비과세소득 | 10원미만 절사 | 법인세법 §13 | |
| F02 | 이월결손금 공제한도 | MIN(잔액, 소득 × 한도율) | — | 법인세법 §13 | ★ 중소 100%, 기타 80% 명시 |
| F03 | 산출세액 | 과세표준 × 초과누진세율 | 10원미만 절사 | 법인세법 §55 | ★ 연도별 세율표 참조 |
| F04 | 최저한세 | 과세표준 × 최저한세율 | 10원미만 절사 | 조특법 §132 | 중소 7% / 중견 10~12% / 대 17% |

### 8.2 공제·감면 세액

| 공식ID | 공식명 | 산출 공식 | 절사규칙 | 근거법령 | v2.0 변경 |
|--------|--------|----------|---------|---------|----------|
| F10 | 통합고용 기본공제 | (청년등증가 × 단가) + (일반증가 × 단가) | 10원미만 절사 | 조특법 §29의8 | ★ 대기업일반=0원 |
| F11 | 통합고용 추가공제 | 추가공제대상인원 × 추가단가 | 10원미만 절사 | 조특법 §29의8 | |
| F12 | 통합투자 기본공제 | 투자금액 × 기본공제율 | 10원미만 절사 | 조특법 §24 | |
| F13 | 통합투자 추가공제 | MAX(0, 당해-직전3년평균) × 추가율 | 10원미만 절사 | 조특법 §24 | |
| F14 | 창업감면세액 | 산출세액 × (감면대상소득/총소득) × 감면율 | 10원미만 절사 | 조특법 §6 | ★ 감면율 결정 테이블화 |
| F15 | 중소특별감면세액 | 산출세액 × (감면대상소득/총소득) × 감면율 | 10원미만 절사 | 조특법 §7 | |
| F16 | 중소특별감면한도 | MIN(감면세액, MAX(0, 1억 - 감소인원×500만)) | — | 조특법 §7 | |
| F17 | R&D 증가분공제 | (해당R&D비 - 직전R&D비) × 공제율 | 10원미만 절사 | 조특법 §10 | |
| F18 | R&D 당기분공제 | 해당R&D비 × 공제율 | 10원미만 절사 | 조특법 §10 | |
| F19 | 사보공제 | 사업주부담분 × 공제율 | 10원미만 절사 | 조특법 §30의4 | ★ 청년 만15~29세 별도 |

### 8.3 최종 환급액

| 공식ID | 공식명 | 산출 공식 | 절사규칙 | 근거법령 | v2.0 변경 |
|--------|--------|----------|---------|---------|----------|
| F30 | 법인세환급액 | 기존납부세액 - 경정후결정세액 | — | 국기법 §51 | |
| F31 | 환급가산금(본세) | 환급액 × 이율 × 일수 ÷ 365 | 1원미만 절사 | 국기법 §52 | ★ 기산일 정정 |
| F32 | 환급가산금(중간예납) | 중간예납과납분 × 이율 × 일수 ÷ 365 | 1원미만 절사 | 국기법 §52 | ★v2.0 신규 |
| F33 | 지방소득세환급 | 법인세환급액 × 10% | 10원미만 절사 | 지방세법 §103의23 | |
| F34 | 총수령예상액 | F30 + F31 + F32 + F33 | — | — | ★ 중간예납 가산금 포함 |

### 8.4 농어촌특별세

| 공식ID | 공식명 | 산출 공식 | 비과세 항목 |
|--------|--------|----------|-----------|
| F40 | 농특세 | 감면·공제세액 × 20% | **비과세: 제6조(창업감면), 제7조(중소특별), 제10조(R&D)** / 과세: 제24조(투자), 제29조의8(고용), 제30조의4(사보) | ★v4.0 정정 (E08) |
| F41 | 농특세 변동 | 경정후농특세 - 기존농특세 | 공제 조합 변경 시 연쇄 재계산 ★v2.0 (I11) |


### 8.5 상세 계산 공식 보충 *(v1.1 → v3.0 통합)*

#### 8.5.1 법인세 산출세액 (2023~2025년)

```
산출세액 = 
  IF 과세표준 ≤ 200,000,000:
    과세표준 × 9%
  ELIF 과세표준 ≤ 20,000,000,000:
    18,000,000 + (과세표준 - 200,000,000) × 19%
  ELIF 과세표준 ≤ 300,000,000,000:
    3,780,000,000 + (과세표준 - 20,000,000,000) × 21%
  ELSE:
    62,580,000,000 + (과세표준 - 300,000,000,000) × 24%
  
  → 10원 미만 절사
```

#### 8.5.2 상시근로자 수 산정

```
상시근로자수(연평균) = TRUNCATE(Σ(매월말 상시근로자수) ÷ 해당월수, 2)

청년등증가분 = MIN(해당연도청년등 - 직전연도청년등, 전체증가분)
             (음수 → 0)
일반증가분   = 전체증가분 - 청년등증가분(조정후)
             (음수 → 0)
```

#### 8.5.3 통합고용세액공제

```
기본공제세액 = (청년등증가인원 × 청년등1인당공제) + (일반증가인원 × 일반1인당공제)
추가공제     = 경력단절재고용인원 × 추가공제단가 (중소 1,300만, 중견 900만)
             + 정규직전환인원 × 추가공제단가
             + 육아복귀인원 × 추가공제단가
총공제세액   = 기본공제 + 추가공제  → 10원 미만 절사
실질환급     = 총공제세액 × 80% (농특세 20% 차감)
```

#### 8.5.4 통합투자세액공제

```
기본공제 = Σ(자산별 투자금액 × 기본공제율)
추가공제 = MAX(0, 해당연도투자총액 - 직전3년평균투자) × 추가공제율
총공제   = 기본공제 + 추가공제  → 10원 미만 절사
실질환급 = 총공제 × 80% (농특세 20%)
```

#### 8.5.5 창업중소기업 세액감면

```
감면세액 = 산출세액 × 감면대상소득비율 × 감면율  → 10원 미만 절사
실질환급 = 감면세액 × 100% (농특세 비과세)
```

#### 8.5.6 중소기업 특별세액감면

```
감면세액_산출 = 산출세액 × 감면대상소득비율 × 감면율
감면한도      = MAX(0, 100,000,000 - 감소인원 × 5,000,000)
감면세액      = MIN(감면세액_산출, 감면한도)  → 10원 미만 절사
실질환급      = 감면세액 × 100% (농특세 비과세)
```

#### 8.5.7 최종 환급액

```
경정후결정세액 = 산출세액 - 최적조합공제감면합계(최저한세 적용 후)
법인세환급액   = (기납부세액 + 중간예납세액 + 원천납부세액) - 경정후결정세액
환급가산금(본세) = TRUNCATE(환급액 × 이율 × (원래납부일다음날~지급결정일 일수) ÷ 365, 0)
환급가산금(중간예납) = TRUNCATE(중간예납과납분 × 이율 × (납부일다음날~지급결정일 일수) ÷ 365, 0)
지방소득세환급 = TRUNCATE(법인세환급액 × 10%, 10)
총수령예상액   = 법인세환급액 + 환급가산금(본세+중간예납) + 지방소득세환급
```

#### 8.5.8 이월결손금 공제 한도

```
IF 기업규모 == '중소기업':
  공제한도 = 각사업연도소득 × 100%
ELSE:
  공제한도 = 각사업연도소득 × 80%
```

#### 8.5.9 결손금 소급공제 환급액

```
소급공제대상결손금 = MIN(당기결손금, 직전연도과세표준)
직전연도재계산세액 = 법인세산출(직전연도과세표준 - 소급공제대상결손금)
소급공제환급액     = 직전연도산출세액 - 직전연도재계산세액
실제환급액         = MIN(소급공제환급액, 직전연도납부세액)
```

---


### 8.6 v4.0 추가 계산 공식 *(v4.0 신규)*

#### 8.6.1 외국납부세액공제 한도 (F50) — v4.0r1 간접공제 반영

```
F50_외국납부세액공제한도:
  국가별_한도(country) = MIN(
    해당국가_외국납부세액,
    산출세액 × (해당국가_국외소득 / 과세표준)
  )
  
  총공제한도 = Σ 국가별_한도(country)
  
  // ★v4.0r1: 직접공제 + 간접공제(F55) 합산 후 한도 적용
  // 실제공제 = MIN(직접세액 + 간접세액, 총공제한도)
  // 한도 초과분은 향후 5년간 이월공제 가능 (법인세법 §57③)
  → 10원 미만 절사
```

#### 8.6.2 가지급금 인정이자 (F51)

```
F51_가지급금_인정이자:
  // 법인세법 시행령 §89
  // 인정이자율: 가중평균차입이자율 (없으면 당좌대출이자율)
  
  인정이자 = 가지급금잔액 × 인정이자율 × (대여기간월수 / 12)
  
  // 실제 수취이자와 인정이자 차액 → 익금산입
  익금산입액 = MAX(인정이자 - 실제수취이자, 0)
```

#### 8.6.3 업무무관자산 차입금이자 손금불산입 (F52)

```
F52_업무무관자산_차입금이자:
  // 법인세법 §28
  손금불산입액 = 차입금이자 × (업무무관자산가액 / 총자산가액)
  
  → 원 미만 절사
```

#### 8.6.4 접대비 한도 (F53)

```
F53_접대비한도:
  // 법인세법 §25
  // 기본한도: 중소기업 3,600만원, 일반 1,200만원 (× 사업연도월수/12)
  
  한도 = 기본한도 × (사업연도월수 / 12)
       + 수입금액별_추가한도  // REF_ENTERTAINMENT_LIMIT 참조
  
  // 수입금액별 추가한도:
  //   100억 이하: 수입금액 × 0.3% (중소) / 0.2% (일반)
  //   100~500억: 수입금액 × 0.2% (중소) / 0.1% (일반)
  //   500억 초과: 수입금액 × 0.03% (공통)
  
  손금불산입 = MAX(접대비지출액 - 한도, 0)
```

#### 8.6.5 국고보조금 익금불산입 (F54)

```
F54_국고보조금_익금불산입:
  // 법인세법 §18①
  
  IF 자산취득용_보조금:
    익금불산입 = 보조금액  // 일시상각충당금 설정 의무
  ELSE IF 사업운영용_보조금:
    // 사용 목적에 따라 익금산입 시기 결정
    익금불산입 = 해당사업연도_미사용잔액
```



#### 8.6.6 간접외국납부세액공제 (F55) *(v4.0r1 신규, E18)*

```
F55_간접외국납부세액:
  // 법인세법 §57④ — 지분율 25% 이상 해외 자회사 배당 시
  
  간접공제세액 = 자회사납부외국법인세 × (수입배당금 / (자회사소득 - 자회사법인세))
  
  // 직접공제 + 간접공제 합산 후 한도 적용:
  총공제한도 = 산출세액 × (국외원천소득 / 과세표준)
  실제공제 = MIN(직접세액 + 간접세액, 총공제한도)
  이월액 = (직접세액 + 간접세액) - 실제공제  // 5년 이월
```

#### 8.6.7 재해손실세액공제 (F56) *(v4.0r1 신규, M37)*

```
F56_재해손실세액공제:
  // 법인세법 §58 — 자산 20% 이상 상실 시
  
  상실비율 = 상실자산가액 / 재해전자산총액(토지제외)
  
  IF 상실비율 ≥ 0.20:
    공제세액 = 미납부법인세 × 상실비율
    최종공제 = MIN(공제세액, 상실자산가액)
  ELSE:
    공제세액 = 0  // 부적격
```


## 9. 검증 규칙 및 제약조건

### 9.1 입력 데이터 검증 규칙 (V: Validation)

| 규칙ID | 검증내용 | 조건 | 에러레벨 | 비고 |
|--------|---------|------|---------|------|
| V01 | 필수 입력값 존재 | corp_size, target_tax_year, taxable_income 등 NOT NULL | ERROR | |
| V02 | 과세표준 범위 | taxable_income **≥ 0** | ERROR | ★v2.0: > 0 → ≥ 0으로 수정 (결손금 발생 시 0 가능) |
| V03 | 산출세액 정합성 | computed_tax = tax_formula(taxable_income) | ERROR | 입력 산출세액과 재계산 비교 |
| V04 | 사업연도 범위 | 경정청구 가능 과세연도 | ERROR | 법정신고기한 후 5년 이내 |
| V05 | 근로자 월수 | 1 ≤ active_months ≤ 12 | ERROR | |
| V06 | 생년월일 유효성 | birth_date ≤ 현재일 | ERROR | |
| V07 | 입퇴사일 정합성 | hire_date ≤ resign_date (존재 시) | ERROR | |
| V08 | 기업규모 일관성 | corp_size와 매출액·독립성 일치 | WARNING | ★v2.0: 경고(W)레벨 추가 |
| V09 | 이월결손금 정합성 | TBL_LOSS_CARRYFORWARD 합계 = TBL_CORP_BASIC.loss_carryforward | WARNING | ★v2.0 신규 |
| V10 | 중복 근로자 확인 | 동일 emp_id가 PRIOR/CURRENT에 정합적으로 존재 | WARNING | ★v2.0 신규 |

### 9.2 계산 로직 검증 규칙 (C: Calculation)

| 규칙ID | 검증내용 | 조건 | 에러레벨 | 비고 |
|--------|---------|------|---------|------|
| C01 | 감면세액 ≤ 산출세액 | 감면이 산출세액 초과 불가 | ERROR | |
| C02 | 공제감면 합계 ≤ 산출세액 | 총 공제감면이 산출세액 초과 불가 (이월 제외) | ERROR | |
| C03 | 최저한세 적용 확인 | 감면+공제 후 세액 ≥ 최저한세 (R&D 배제분 제외) | ERROR | |
| C04 | 농특세 적용 확인 | 감면 항목에 농특세 20% 적용 (비과세 항목 제외) | WARNING | |
| C05 | 환급가산금 이율 확인 | REF_REFUND_INTEREST_RATE에서 해당 기간 이율 존재 | ERROR | ★v2.0 신규 |
| C06 | 이월결손금 한도 확인 | 공제액 ≤ 소득 × 한도율 (중소100%/기타80%) | ERROR | ★v2.0 신규 |
| C07 | TRUNCATE 준수 | 모든 금액 계산에 ROUND 미사용 | ERROR | 시스템 전역 규칙 |

### 9.3 업무 규칙 검증 (B: Business)

| 규칙ID | 검증내용 | 조건 | 에러레벨 | 비고 |
|--------|---------|------|---------|------|
| B01 | 상호배제 위반 | REF_MUTUAL_EXCLUSION 규칙 위반 조합 없음 | ERROR | |
| B02 | 적용기한 확인 | 각 공제·감면의 적용기한 내 | ERROR | |
| B03 | 중소기업 요건 | 감면 전제인 중소기업 요건 충족 | ERROR | |
| B04 | 창업 요건 | 제6조 적용 시 업종·소재지·승계여부 충족 | ERROR | |
| B05 | 고용 증가 전제 | 전체 상시근로자 순증 ≥ 1 (고용공제 전제) | ERROR | |
| B06 | 결산확정 원칙 | 결산조정 항목 경정청구 차단 | ERROR | ★v2.0 신규 (M3-06) |
| B07 | 제6조+제29조의8 연도별 분기 | 2024이전: 중복허용 / 2025이후: 택1 | ERROR | ★v2.0 신규 |

### 9.4 법령 검증 규칙 (L: Legal) *(v2.0 신규)*

| 규칙ID | 검증내용 | 조건 | 에러레벨 | 비고 |
|--------|---------|------|---------|------|
| L01 | 적용순서 근거법 | **법인세법 제59조** 적용 (소득세법 아님) | ERROR | E02 수정 반영 |
| L02 | 청년 판단 시점 | 2024이전=과세연도말 / 2025이후=근로계약체결시 | ERROR | |
| L03 | 졸업유예 기간 | 업종·시행령 적용시기별 3년 또는 5년 | WARNING | |
| L04 | 이월기간 적용 | 2020년 이후 발생분 15년 / 이전 10년 | ERROR | |
| L05 | 인구감소지역 확인 | 2025년 이후 창업 시 REF_DEPOPULATION_AREA 대조 | WARNING | |
| L06 | 사보공제 청년 기준 | 만 15~29세 (통합고용 34세와 상이) | ERROR | |

### 9.5 교차검증 규칙 *(v2.0 신규, I07)*

| 규칙ID | 검증내용 | 교차 대상 |
|--------|---------|----------|
| X01 | 상시근로자 수 합산 = 전 사업장 합계 | TBL_EMPLOYEE_DETAIL ↔ TBL_BRANCH_LOCATION |
| X02 | 기존 공제감면 합계 일치 | TBL_EXISTING_DEDUCTION.SUM ↔ TBL_CORP_BASIC.existing_deduction_amount |
| X03 | R&D비 합계 일치 | TBL_RD_EXPENSE.total ↔ 개별항목합계 |
| X04 | 이월결손금 잔액 일치 | TBL_LOSS_CARRYFORWARD.SUM ↔ TBL_CORP_BASIC.loss_carryforward |
| X05 | 중간예납 합계 일치 | TBL_INTERIM_TAX.SUM ↔ TBL_CORP_BASIC.prepaid_tax (일부) |
| X06 | 과세표준 역산 검증 | biz_income - loss_carryforward_applied - non_taxable = taxable_income |
| X07 | 산출세액 역산 검증 | tax_formula(taxable_income) = computed_tax |
| X08 | 소재지 교차검증 *(v1.1)* | 제7조: capital_zone 사용 / 제24조: install_location_zone 사용 확인 |
| X09 | 소급공제 적격 확인 *(v1.1)* | 중소기업 여부 AND 당기결손금 > 0 AND 직전연도 납부세액 > 0 |

---


### 9.6 v4.0 추가 검증 규칙 — 15건

#### 입력 데이터 검증 (V)

| 코드 | 규칙 | 심각도 |
|------|------|--------|
| V11 | 외국소득 합계(TBL_CORP_BASIC.foreign_income_total) = Σ TBL_FOREIGN_TAX.foreign_income | ERROR |
| V12 | 가지급금 인정이자 = 잔액 × 인정이자율 × 기간 (TBL_SHAREHOLDER_LOAN 정합성) | ERROR |
| V13 | 업무무관자산 차입금이자(TBL_NON_BUSINESS_ASSET) ≤ 총 차입금이자 | ERROR |
| V14 | 접대비 지출액(TBL_ENTERTAINMENT 합계) ≥ 0 | ERROR |
| V15 | 국고보조금 수령액(TBL_GOVERNMENT_SUBSIDY 합계) ≥ 0 | ERROR |
| V16 | 업무용 승용차 감가상각 한도(TBL_BUSINESS_VEHICLE) = 연 800만원 이하 | WARNING |

#### 계산 로직 검증 (C)

| 코드 | 규칙 | 심각도 |
|------|------|--------|
| C08 | 외국납부세액공제 한도 = 산출세액 × (국외소득/과세표준) 정합성 | ERROR |
| C09 | 가지급금 인정이자 익금산입 = 인정이자 - 실제수취이자 (음수 시 0) | ERROR |
| C10 | 업무용 승용차 감가상각비 ≤ 연 800만원 (운행일지 미작성 시 50% 적용) | ERROR |

#### 업무 규칙 검증 (B)

| 코드 | 규칙 | 심각도 |
|------|------|--------|
| B08 | 국고보조금 익금불산입 요건: 자산취득용 → 일시상각충당금 설정 의무 확인 | WARNING |
| B09 | 업무용 승용차: 전용보험 미가입 시 비용 전액 불산입 경고 | WARNING |

#### 법령 검증 (L)

| 코드 | 규칙 | 심각도 |
|------|------|--------|
| L07 | 접대비 한도 = REF_ENTERTAINMENT_LIMIT 기준 적용, 중소기업 우대 한도 확인 | ERROR |
| L08 | 외국납부세액공제 vs 손금산입 선택 최적성 비교 | WARNING |

#### 교차검증 (X)

| 코드 | 규칙 | 심각도 |
|------|------|--------|
| X10 | 외국소득 합계: TBL_CORP_BASIC.foreign_income_total = Σ TBL_FOREIGN_TAX.foreign_income | ERROR |
| X11 | 접대비 한도 초과: TBL_CORP_BASIC.entertainment_expense > F53 한도 시 경고 | WARNING |



### 9.7 v4.0r1 추가 검증 규칙 — 10건

#### 입력 데이터 검증 (V)

| 코드 | 규칙 | 심각도 |
|------|------|--------|
| V17 | 재해 상실비율 = 상실자산가액/총자산가액 (TBL_DISASTER_LOSS 정합성) | ERROR |
| V18 | 간접공제 자회사 지분율 ≥ 25% (TBL_FOREIGN_TAX.subsidiary_share_ratio) | ERROR |
| V19 | 벤처확인일 - 창업일 ≤ 3년 (TBL_STARTUP_INFO 벤처감면 적격) | ERROR |

#### 계산 로직 검증 (C)

| 코드 | 규칙 | 심각도 |
|------|------|--------|
| C11 | 간접공제세액 = 자회사법인세 × (배당금/(자회사소득-자회사법인세)) 정합성 | ERROR |
| C12 | 재해손실공제 = MIN(미납부법인세 × 상실비율, 상실자산가액) | ERROR |
| C13 | 감가상각 추인액 = MIN(시인부족액, 전기이월한도초과) | ERROR |

#### 업무 규칙 검증 (B)

| 코드 | 규칙 | 심각도 |
|------|------|--------|
| B10 | 임대용 자산(is_rental_asset=TRUE) → 통합투자세액공제 배제 확인 | ERROR |
| B11 | 중고품(is_used_asset=TRUE) → 통합투자세액공제 배제 확인 | ERROR |

#### 법령 검증 (L)

| 코드 | 규칙 | 심각도 |
|------|------|--------|
| L09 | 경정청구 불가 사유 사전 검증 통과 확인 (M43) | ERROR |

#### 교차검증 (X)

| 코드 | 규칙 | 심각도 |
|------|------|--------|
| X13 | 퇴사자 예외사유(resign_exception_code) 설정 시 추징액 제외 반영 | WARNING |


## 10. 용어 정의

| 용어 | 정의 | 근거법령 |
|------|------|---------|
| 경정청구 | 과세표준 신고서에 기재된 과세표준·세액이 세법에 의하여 신고해야 할 과세표준·세액을 초과할 때 그 차액의 경정을 청구하는 것 | 국기법 §45의2 |
| 후발적 경정청구 | 판결, 결정 등 후발적 사유 발생 시 그 사유를 안 날부터 3개월 이내 경정청구 | 국기법 §45의2② |
| 각 사업연도 소득 | 법인의 각 사업연도의 익금총액에서 손금총액을 공제한 금액 | 법인세법 §14 |
| 과세표준 | 각사업연도소득 - 이월결손금 - 비과세소득 | 법인세법 §13 |
| 산출세액 | 과세표준 × 세율 | 법인세법 §55 |
| 최저한세 | 각종 감면·공제를 적용한 후에도 납부해야 하는 최소한의 세금 | 조특법 §132 |
| 상시근로자 | 근로기준법에 따른 근로자 중 근로계약기간이 1년 이상이고 월 소정근로시간 60시간 이상인 자 (임원, 최대주주 가족 등 제외) | 조특법 시행령 §23⑩ |
| 청년 (통합고용) | 만 15~34세 (병역복무기간 최대 6년 가산), 2025년부터 근로계약 체결 시점 기준 | 조특법 시행령 §23⑩, §26의8 |
| 청년 (사보공제) | 만 15~29세 | 조특법 §30의4 |
| 경력단절여성 | 결혼·임신·출산·육아·자녀교육·가족돌봄 사유로 퇴직 후 2~15년 이내 재고용된 여성 | 조특법 §29의8③ |
| 본점 간주 규정 | 법인 본점이 수도권 소재 시 전 사업장을 수도권으로 간주 (제7조) | 조특법 §7①단서 |
| 실질 환급액 | 공제·감면세액 합계 - 농어촌특별세 = 실제 수령 가능 환급액 | — |
| 환급가산금 | 국세환급금에 대해 일정 이율을 곱한 금액 | 국기법 §52 |
| 이월세액공제 | 최저한세 등으로 당해 사용 불가한 공제세액을 향후 10년간 이월하여 공제 | 조특법 §144 |
| 결산조정 | 법인의 결산 확정 시 장부에 계상해야만 세무상 인정되는 항목 (경정청구 불가) | 법인세법 §40 |
| 신고조정 | 세무조정계산서에 의해 조정하는 항목 (경정청구 가능) | 법인세법 §60 |
| R&D 최저한세 배제 | R&D 세액공제의 일부 또는 전부를 최저한세 적용에서 배제 | 조특법 §132② |

---

## 11. 프롬프트 대비 교차검증 결과

### 11.1 프롬프트 점검항목 ↔ 설계서 모듈 매핑

| 프롬프트 점검 | 점검 주제 | 설계서 모듈 | 커버 상태 |
|--------------|----------|-----------|----------|
| 점검 0 | 사전확인·경정청구전략 | M3-01, M3-02, M3-03, **M3-06**, **M4-10**, **M4-11** | ★v2.0 보완 |
| 점검 1~8 | 법인세 특화 점검 | M4-07~M4-09, **M4-12~M4-14** | ★v2.0 보완 |
| 점검 9 | 과세표준·세율 확인 | M1-01, STEP 1 | ○ |
| 점검 9-2 | 중소기업 판단 | M3-02 | ○ (졸업유예 상세화) |
| 점검 9-3 | 감면·공제 적용순서 | M5-05 | ○ (법인세법 §59 통일) |
| 점검 9-4 | 기존 신고 확인 | **M1-09**, TBL_EXISTING_DEDUCTION | ★v2.0 신규 |
| 점검 9-5 | 환급가산금 | M6-02 | ★v2.0 보강 (기산일, 이율 테이블) |
| 점검 10~11 | 상시근로자 산정 | M3-04, M1-03 | ○ |
| 점검 12~13 | 창업중소기업 감면 | M4-04, M1-05 | ★v2.0 보강 (감면율 테이블, 인구감소지역) |
| 점검 14 | 고용공제 청년연령 | M3-04 내 청년 판단 | ★v2.0 연도별 분기 추가 |
| 점검 15 | 고용공제 공제액 산정 | M4-02 | ★v2.0 보강 (경과규정, 경력단절 등) |
| 점검 15-5~15-6 | 최저한세·이월공제 | M5-03, M5-02 | ★v2.0 (감면초과소멸, 공제초과이월) |
| 점검 16~18 | 청년등 세부구분 | M3-04, M4-03 | ★v2.0 (북한이탈주민, 사보청년기준) |
| 점검 19 | 고용증대세액공제 경과규정 | **M4-02 경과규정 비교** | ★v2.0 신규 |
| 점검 20~21 | 통합투자세액공제 | M4-01 | ○ |
| 점검 22 | R&D 세액공제 | M4-06, **TBL_RD_EXPENSE** | ★v2.0 보강 (최저한세 배제 3단계) |
| 점검 23~26 | 기타 공제·감면 | M4-05, M4-07, M4-09, M4-08 | ○ |
| 점검 27 | 이월결손금 | M4-08, **TBL_LOSS_CARRYFORWARD** | ★v2.0 신규 테이블 |
| 점검 28 | 사후관리 | **M7-03**, **OUT_RISK_ASSESSMENT** | ★v2.0 신규 |
| 점검 29 | 중간예납 | **TBL_INTERIM_TAX**, M6-02 | ★v2.0 신규 |
| 점검 30 | 지방소득세 | M6-03, **M6-05** | ★v2.0 상세 안내 추가 |
| 점검 31 | 기업구조조정 | **M4-13** | ★v2.0 신규 |
| 점검 32 | 연결납세 | **M4-14** | ★v2.0 신규 |

### 11.2 프롬프트 핵심전제 ↔ 설계서 반영 확인

| 핵심전제 | 설계서 반영 위치 | 상태 |
|---------|----------------|------|
| 법인세법 §59 적용순서 | §1.3 핵심설계원칙, M5-05, STEP 3-3 | ✅ 통일 |
| 반올림 절대 금지(TRUNCATE) | §1.3, 검증규칙 C07 | ✅ |
| 본점 간주 규정 | §1.3, M3-03, STEP 0-6/0-8 | ✅ |
| 결산확정 원칙 | §1.3, **M3-06**, 검증규칙 B06 | ✅ v2.0 신규 |
| 사업연도별 법령 적용 | §1.3, REF_LAW_VERSION, REF_CORP_TAX_RATE_HISTORY | ✅ v2.0 신규 |
| 법인 전체 합산 | §1.3, M3-04 | ✅ |
| R&D 최저한세 배제 | M5-02 step 6, STEP 3-5 | ✅ v2.0 3단계 상세화 |
| 청년 판단 시점 변경 | M3-04 step 5, STEP 1-6, L02 | ✅ v2.0 연도별 분기 |
| 제6조+제29조의8 중복 | STEP 3-2, 시나리오 표, B07 | ✅ v2.0 연도별 분기 |

### 11.3 v2.0 에러코드 체계 *(신규, I01)*

| 접두어 | 유형 | 설명 | 예시 |
|--------|------|------|------|
| V | Validation | 입력 데이터 검증 | V01: 필수값 누락 |
| C | Calculation | 계산 로직 검증 | C01: 감면 > 산출세액 |
| B | Business | 업무 규칙 검증 | B01: 상호배제 위반 |
| L | Legal | 법령 검증 | L01: 적용순서 법령 불일치 |
| W | Warning | 경고 (계속 진행 가능) | W01: 기업규모 불일치 의심 |

---



---


### 11.4 v4.0 프롬프트 대비 커버리지 보완 확인

| 프롬프트 점검 | v3.0 상태 | v4.0 보완 | 상태 |
|--------------|----------|----------|------|
| 점검 0 (세무조정) | M4-11 존재 | 국고보조금·가지급금·업무무관자산·업무용 승용차·접대비 상세화 | ✅ |
| 점검 0 (소급공제) | M4-10 존재 | NPV 할인율 파라미터화 (REF_SYSTEM_PARAM) | ✅ |
| 점검 0 (결산확정) | M3-06 존재 | 변경 없음 | ✅ |
| 점검 12 (업종 제한) | 언급만 | REF_INDUSTRY_ELIGIBILITY 신설 | ✅ |
| 점검 16 (청년등 정의) | TBL_EMPLOYEE_DETAIL | TBL_EMPLOYEE_MONTHLY에 nk_defector_count 추가 | ✅ |
| 점검 27 (이월결손금) | TBL_LOSS_CARRYFORWARD | 변경 없음 | ✅ |
| 점검 28 (수입배당금) | M4-09, REF_DIVIDEND_EXCLUSION | 익금불산입률 3단계 정정 (E09) | ✅ |
| 점검 29 (중간예납) | TBL_INTERIM_TAX, M6-02 | 변경 없음 | ✅ |
| 점검 9-2 (중소기업 판단) | M7-01 | 연도별 중소기업 재판단 로직 추가 (M36) | ✅ |
| 점검 9-4 (기존 신고) | TBL_EXISTING_DEDUCTION | TBL_TAX_ADJUSTMENT 추가 (E15) | ✅ |
| 점검 9-5 (환급가산금) | REF_REFUND_INTEREST_RATE | 갱신 프로세스 명시 (M34) | ✅ |



### 11.5 v4.0r1 외부검토 반영 커버리지 확인

| 프롬프트 점검 | v4.0 상태 | v4.0r1 보완 | 상태 |
|--------------|----------|------------|------|
| 점검 9-3 (적용순서·법인고유) | 순서 존재 | 재해손실세액공제(§58) M4-15·F56 신설 | ✅ |
| 점검 10 (투자 제외 대상) | 일반 제외만 | 임대자산·중고품 배제 필드 + 무형자산 구분 추가 | ✅ |
| 점검 14 (청년 판단 시점) | M3-04에서 연도별 분기 | v4.0에서 이미 반영 완료 (2차 지적은 기반영 확인) | ✅ |
| 점검 20-2 (벤처 3년) | TBL_STARTUP_INFO | 벤처확인일-창업일 ≤ 3년 검증 로직 + V19 규칙 | ✅ |
| 점검 26 (외국납부·간접공제) | 직접공제만 | 간접외국납부세액공제 로직 + TBL_FOREIGN_TAX 확장 | ✅ |
| 점검 32 (연결납세) | M4-14 모듈 | TBL_CONSOLIDATED_SUBSIDIARY 데이터 구조 신설 | ✅ |
| 경정청구 불가 사유 | 언급 없음 | M43 사전 검증 모듈 + STEP 0 보강 | ✅ |
| 결산확정 원칙 (유보 추인) | M3-06 존재 | TBL_DEPRECIATION_ADJUST + M42 추인 검토 로직 | ✅ |
| 점검 15-6 [E] (사후관리) | I21 리스크 정량화 | 퇴사 예외사유(resign_exception_code) 추가 | ✅ |


## 부록 A: v1.1 오류지적사항 검토 결과 *(통합 기록용)*

> 아래는 v1.0에 대해 제출된 오류지적사항 4건에 대한 검토 결과입니다. v1.1에서 반영되었으며, v3.0에 모두 통합되었습니다.

### ① 소재지 판단 기준의 혼선 — 판정: **부분 타당 (반영)**

**지적 내용**: M3-03에서 본점 간주 규정을 일괄 적용하여 제24조(투자공제)에서 비수도권 자산의 공제 기회를 놓칠 위험이 있다.

**반영 내용**: M3-03 기능 설명 변경, 소재지 이원화 로직 분기 함수 추가 (7.7절), 검증 규칙 V09 추가 → **v3.0 §7.7 반영 완료**

### ② 수입배당금 익금불산입 기준표 누락 — 판정: **타당 (반영)**

**지적 내용**: M4-09 기능은 목록에 존재하나, 기준정보 테이블과 연도별 처리 로직이 누락되어 있다.

**반영 내용**: TBL_DIVIDEND_INCOME (§3.14), REF_DIVIDEND_EXCLUSION (§4.15), M4-09 상세 로직 (§7.9) → **v3.0 반영 완료**

### ③ 최저한세 배제 항목의 세분화 부족 — 판정: **부분 타당 (반영)**

**지적 내용**: M5-03에서 R&D 최저한세 배제분을 뭉뚱그려 처리하고 있어 유형별 가중치 적용 로직이 필요하다.

**반영 내용**: REF_RD_MIN_TAX_EXEMPT (§4.16), calculate_rd_min_tax_exempt() 함수 (§7.8) → **v3.0 반영 완료**

### ④ 결손금 소급공제(Loss Carryback) 로직 부재 — 판정: **타당 (반영)**

**지적 내용**: M4-08에 이월결손금 재검토 기능은 있으나, 중소기업의 소급공제 vs 이월공제 실익 비교 엔진이 없다.

**반영 내용**: M4-10 모듈 (§7.10), TBL_CORP_BASIC 입력 필드 추가, 계산 공식 §8.5.9 → **v3.0 반영 완료**

**— 문서 끝 — 법인사업자 법인세 경정청구 환급액 산출 시스템 개발상세설계서 v3.0 (v1.1 + v2.0 최종 통합본)**


## 부록 B: v4.0 개발 우선순위 *(v4.0 신규)*

### 우선순위 1 — 필수 오류 수정 (즉시)

| No | 항목 | 영향도 |
|----|------|--------|
| E08 | 농특세 비과세 항목 정정 (F40) | 환급액 산출 오류 직결 |
| E09 | 수입배당금 익금불산입률 3단계 정정 | 과세표준 재계산 오류 |
| E11 | TBL_EMPLOYEE_MONTHLY 북한이탈주민 컬럼 | 고용세액공제 산출 누락 |

### 우선순위 2 — 핵심 누락 보완 (1주 이내)

| No | 항목 | 영향도 |
|----|------|--------|
| E12~E15 | 세무조정 관련 입력 테이블 4개 신설 | 세무조정 재검토 기능 완성 |
| M25~M28 | 접대비·업종별 감면·가지급금·업무무관자산 | 추가 환급 발굴 |
| M31 | 환급 결정 예상일 | 환급가산금 정확도 |

### 우선순위 3 — 외부 참조 데이터 (2주 이내)

| No | 항목 | 영향도 |
|----|------|--------|
| M26 | REF_INDUSTRY_ELIGIBILITY (감면 적격성) | 업종 판단 자동화 |
| M25 | REF_ENTERTAINMENT_LIMIT (접대비 한도) | 손금불산입 정확도 |
| M32 | REF_SYSTEM_PARAM (NPV 할인율) | 시스템 유연성 |
| M35 | REF_KSIC_CODE (산업분류) | 입력 검증 |

### 우선순위 4 — 개선사항 (1개월 이내)

| No | 항목 | 영향도 |
|----|------|--------|
| I16 | 순환 참조 해결 (최저한세 재계산 루프) | 계산 정확도 |
| I17 | 다수 과세연도 중소기업 재판단 | 복수 연도 정확도 |
| I20 | 농특세 연쇄 영향 자동화 | 실질 환급 정확도 |
| I21 | 사후관리 리스크 정량화 | 의사결정 지원 |



### 우선순위 5 — 외부검토 반영 (v4.0r1)

| No | 항목 | 영향도 | 일정 |
|----|------|--------|------|
| E16 | 임대/중고 자산 배제 필드 (TBL_INVESTMENT_ASSET) | 과대 공제 방지 | 즉시 |
| E18 | 간접외국납부세액공제 (TBL_FOREIGN_TAX + M4-07) | 해외 소득 법인 필수 | 1주 |
| M37 | 재해손실세액공제 (TBL_DISASTER_LOSS + M4-15) | 재해 법인 한정 | 1주 |
| M38 | 연결납세 자회사 (TBL_CONSOLIDATED_SUBSIDIARY) | 연결납세 법인 한정 | 2주 |
| M43 | 경정청구 불가 사유 검증 (STEP 0) | 사전 필터 필수 | 즉시 |
| M42 | 감가상각 시부인 이월 추인 | 경정청구 추가 환급 | 2주 |

## 부록 C: 외부 참조 데이터 갱신 프로세스 *(v4.0 신규)*

### C.1 법령 기준 데이터 갱신 절차

| 데이터 | 갱신 트리거 | 갱신 절차 | 담당 |
|--------|-----------|----------|------|
| REF_CORP_TAX_RATE_HISTORY | 세법개정 확정 (12월 국회 통과) | 관보 확인 → 이력 테이블 INSERT | 세무관리자 |
| REF_MIN_TAX_RATE | 조특법 개정 확정 | 관보 확인 → 이력 테이블 INSERT | 세무관리자 |
| REF_EMPLOYMENT_CREDIT | 시행령 별표 개정 (매년 2~3월) | 시행령 확인 → 공제금액 UPDATE | 세무관리자 |
| REF_REFUND_INTEREST_RATE | 국기법 시행규칙 변경 (분기별 확인) | 국세청 고시 확인 → 이율 UPDATE | 시스템관리자 |
| REF_DEPOPULATION_AREA | 행정안전부 고시 (연 1회, 보통 12월) | 고시 확인 → 지역 목록 UPDATE | 시스템관리자 |
| REF_CAPITAL_ZONE | 수도권정비계획법 개정 (비정기) | 법령 확인 → 지역 구분 UPDATE | 세무관리자 |
| REF_KSIC_CODE | 통계청 KSIC 개정 (5년 주기) | 통계청 고시 확인 → 전체 REPLACE | 시스템관리자 |
| REF_EXCHANGE_RATE | 영업일 매일 (서울외국환중개) | 매매기준율 조회 → INSERT | 시스템관리자 | ★v4.0r1 |
| REF_DEEMED_INTEREST_RATE | 국세청 고시 (연 1회) | 당좌대출이자율 확인 → UPDATE | 세무관리자 | ★v4.0r1 |

### C.2 갱신 검증 체크리스트

1. 갱신 전: 기존 데이터 백업 (스냅샷)
2. 갱신 후: 변경 항목 수·내용 대조 확인
3. 회귀 테스트: 기존 계산 결과 재현 여부 확인 (직전 과세연도 기준)
4. 이력 관리: 갱신일·갱신자·변경내역 LOG_CALCULATION에 기록

---

**[문서 끝]** — 법인사업자 법인세 경정청구 환급액 산출 시스템 개발상세설계서 v4.0

