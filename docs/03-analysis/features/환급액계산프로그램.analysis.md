# 프롬프트 요구사항 vs 설계서 커버리지 Gap Analysis Report

> **Summary**: 개인사업자 프롬프트(v1.3) + 법인사업자 프롬프트(v1.3)의 요구사항과 설계서(환급액계산프로그램.design.md)의 커버리지 비교 분석
>
> **Analyzer**: gap-detector Agent
> **Date**: 2026-02-17
> **Status**: Addressed (Design v2.0 updated)
> **Design Revision**: 환급액계산프로그램.design.md v1.0 -> v2.0 (22 Critical + 16 Warning addressed)

---

## Analysis Overview

- **Analysis Target**: 환급액계산프로그램 (경정청구 환급액 극대화 시스템)
- **Design Document**: `docs/02-design/features/환급액계산프로그램.design.md`
- **Requirement Sources**:
  - `개인사업자-프롬프트_v1.3.md` (개인사업자/종합소득세, 약 1,420줄)
  - `법인사업자-프롬프트_v1.3.md` (법인사업자/법인세, 약 2,000줄 이상)
- **Existing Validation**: `docs/02-design/design-validation-report.md` (78/100점)

---

## Overall Scores

| Category | Score | Status |
|----------|:-----:|:------:|
| 개인사업자 프롬프트 커버리지 | 62% | WARNING |
| 법인사업자 프롬프트 커버리지 | 68% | WARNING |
| 계산 공식/로직 커버리지 | 75% | WARNING |
| 데이터 구조 커버리지 | 80% | WARNING |
| 비즈니스 규칙 커버리지 | 82% | WARNING |
| **Overall** | **68%** | WARNING |

---

## 1. 개인사업자 프롬프트 커버리지 (62%)

### 1.1 점검 항목별 커버리지 매트릭스

개인사업자 프롬프트에는 총 44개 점검 항목이 존재한다 (점검 1 ~ 점검 37, 점검 9-2 ~ 9-8, 점검 15-2 ~ 15-6, 점검 20-2 ~ 20-6, 점검 22-2 ~ 22-6, 점검 24-2 ~ 24-6 포함).

| 점검 항목 | 프롬프트 요구사항 | 설계서 매핑 | 커버리지 | 심각도 |
|-----------|-------------------|-------------|:--------:|:------:|
| 핵심전제 (과세구조) | 종합소득세 13개 전제조건 | TaxType.INC 분기, 개인 전용 공식 | 85% | Info |
| 납세자기본정보 | 20+ 입력 필드 | RI_S_RAW_DATA JSON 스키마 참조 | 70% | Warning |
| 사전확인 (경정청구기한) | 5년 기한, 성실신고 6.30 | M3-01 checkDeadline() | 90% | - |
| 점검1 (그룹A/B비교) | 감면/공제 그룹 비교 전략 | M5-02 compareGroups() | 90% | - |
| 점검2 (소재지) | 사업장별 개별 판단 | M3-03 checkLocation() INC분기 | 90% | - |
| 점검3 (농특세) | 20% 부담 반영 | M5-04 applyNongteuk() | 95% | - |
| 점검4 (농특세 예외) | 제6,7,10조 비과세 | CreditItem.nongteukExempt | 95% | - |
| 점검5 (최저한세) | 산출세액x35%/45% 개인 | M5-03 applyMinimumTax() INC분기 | 85% | Info |
| 점검6 (상호배제 불가) | 7개 중복불가 조합 | M5-01 verifyExclusion() | 90% | - |
| 점검7 (상호배제 허용) | 5개 중복가능 조합 | M5-01 + RF_S_MUTUAL_EXCLUSION | 90% | - |
| 점검8 (금액절사) | 10원미만 절사 | MoneyAmount.truncate10() | 100% | - |
| 점검9 (비율절사) | 소수3자리 절사 | TaxRate.truncate3() | 100% | - |
| 점검9-2 (중소기업판단) | 매출액/독립성/졸업유예 | M3-02 checkSmeStatus() | 85% | Info |
| 점검9-3 (적용순서) | 소득세법 제60조 순서 | M5-05 applyOrder() INC분기 | 90% | - |
| **점검9-4 (기존신고확인)** | **중간예납/원천징수/분납 반영** | **RefundResult에 originalPaidTax만 존재** | **50%** | **Critical** |
| 점검9-5 (환급가산금) | 기산일/이율/비과세 | M6 interestAmount | 80% | Warning |
| **점검9-6 (다사업장 배분)** | **감면소득배분 공식 상세** | **IncomeAllocationService** | **70%** | **Warning** |
| **점검9-7 (소득세 세율)** | **6~45% 8단계 과세연도별** | **MX-02 LawVersionMatcher 참조만** | **40%** | **Critical** |
| **점검9-8 (결손금 소급공제)** | **소득세법 제85조의2 상세** | **M4_31_LossCarryback 구현체명만** | **30%** | **Critical** |
| 점검10-13 (투자세액공제) | 대상자산/공제율/수도권제한 | M4_01_InvestmentCredit | 75% | Warning |
| 점검14-16 (통합고용) | 청년연령/공제액/상시근로자 | M4_02_EmploymentCredit | 75% | Warning |
| 점검15-2~15-6 (고용상세) | 입력자료/공식/중복/최저한세 | CreditCalculator 인터페이스만 | 50% | Warning |
| 점검17-18 (사회보험료) | 4대보험/공제율 | M4_25_SocialInsuranceCredit 구현체명만 | 30% | Warning |
| 점검19 (고용증대 경과) | 제29조의7 경과규정 | 설계 미반영 | 10% | Warning |
| 점검20-21 (창업감면) | 요건/감면율/농특세 | M4_04_StartupExemption | 70% | Warning |
| 점검20-2~20-6 (창업상세) | 입력자료/공식/중복/최저한세 | CreditCalculator 인터페이스만 | 40% | Warning |
| 점검22-23 (R&D 공제) | 증가분/당기분/신성장/국가전략 | M4_06_RdCredit | 70% | Warning |
| 점검22-2~22-6 (R&D상세) | 입력자료/공식/중복/최저한세 | CreditCalculator 인터페이스만 | 40% | Warning |
| 점검24-25 (중소특별감면) | 감면율/소득한도 | M4_05_SmeSpecialExemption | 70% | Warning |
| 점검24-2~24-6 (감면상세) | 입력자료/공식/중복/최저한세 | CreditCalculator 인터페이스만 | 40% | Warning |
| **점검26 (성실사업자 의료비교육비)** | **최저한세 비대상 별도 적용** | **P4_04_MedicalEducation 구현체명만** | **30%** | **Critical** |
| **점검27 (노란우산공제)** | **소득공제 연500만원 한도** | **설계 미반영** | **0%** | **Critical** |
| **점검28 (연금저축)** | **세액공제 연600만원 한도** | **설계 미반영** | **0%** | **Critical** |
| **점검29 (자녀세액공제)** | **7세 이상 기본 15만원** | **설계 미반영** | **0%** | **Critical** |
| 점검30 (기장세액공제) | 산출세액 20% 100만원 한도 | P4_06_BookkeepingCredit 구현체명만 | 30% | Warning |
| 점검31 (전자신고) | 2만원 공제 | 설계 미반영 | 0% | Info |
| **점검31-2 (성실신고확인비용)** | **최저한세 적용 대상 구분** | **P4_05_SincerityConfirmation 구현체명만** | **30%** | **Warning** |
| **점검32 (소득공제 누락)** | **인적공제/보험료/세율구간 최적화** | **P4-01 설계 전무 (design-validation C-02)** | **0%** | **Critical** |
| 점검33 (지방소득세) | 별도 경정청구, 10% 환급 | RefundResult.localTaxRefund | 80% | - |
| **점검34 (외국납부세액공제)** | **소득세법 제57조 상세** | **M4_28_ForeignTaxCredit_Indv 구현체명만** | **30%** | **Warning** |
| **점검35 (착한임대인)** | **조특법 제96조의3** | **설계 미반영 (P4-08 없음)** | **0%** | **Warning** |
| 점검36 (재해손실) | 소득세법 제58조 | 설계 미반영 | 0% | Info |
| 점검37 (벤처투자출자) | 조특법 제16조 | 설계 미반영 | 0% | Info |
| 필수준수규칙 (28개) | 계산원칙/적용순서/개인전용 | 부분 반영 | 70% | Warning |
| 중복적용 매트릭스 | 6x6 매트릭스 | RF_S_MUTUAL_EXCLUSION 참조 | 85% | - |
| 참고판례예규 (10개) | 대법원/예규 인용 | 설계 미반영 (법적 근거 참조 체계 없음) | 10% | Info |

### 1.2 개인사업자 프롬프트 미커버 Critical 항목

| # | 항목 | 설명 | 영향도 |
|---|------|------|--------|
| INC-C01 | 소득공제 누락 점검 (점검32) | 인적공제/국민연금/건강보험/주택자금/노란우산공제 등 소득공제 누락 점검 및 세율구간 최적화 전략 -- 개인사업자 핵심 기능임에도 설계 전무 | **Very High** |
| INC-C02 | 노란우산공제 (점검27) | 소기업/소상공인 연 200~500만원 소득공제. 과세표준 직접 영향 | High |
| INC-C03 | 연금저축 세액공제 (점검28) | 연 600만원 한도 세액공제. 소득구간별 12%/15% 공제율 차등 | High |
| INC-C04 | 자녀세액공제 (점검29) | 7세 이상 기본 15만원. 다자녀 추가공제 | Medium |
| INC-C05 | 결손금 소급공제 상세 (점검9-8) | 소득세법 제85조의2. 환급세액 산출공식, NPV 비교 로직 미설계 | High |
| INC-C06 | 소득세 세율 확인 (점검9-7) | 6~45% 8단계 누진세율, 과세연도별 세율 차이. RF_I_TAX_RATE 참조만 존재하고 적용 로직 상세 없음 | High |
| INC-C07 | 기존 신고 중간예납/분납 (점검9-4) | 중간예납세액, 원천징수세액, 분납분 등 기납부세액 상세 구분이 RefundResult에 부재 | High |
| INC-C08 | 성실사업자 의료비/교육비 최저한세 비대상 (점검26) | 최저한세 비대상 별도 처리 로직 명시 없음. M5-03에서 제외 처리 필요 | High |

---

## 2. 법인사업자 프롬프트 커버리지 (68%)

### 2.1 점검 항목별 커버리지 매트릭스

법인사업자 프롬프트에는 총 50개 이상 점검 항목이 존재한다.

| 점검 항목 | 프롬프트 요구사항 | 설계서 매핑 | 커버리지 | 심각도 |
|-----------|-------------------|-------------|:--------:|:------:|
| 핵심전제 (법인세 과세구조) | 법인세 8개 전제조건 | TaxType.CORP 분기 | 85% | - |
| 경정청구 가능/불가능 항목 | 신고조정 vs 결산조정 구분 | M3-00 checkDisqualification() | 90% | - |
| 법인기본정보 | 30+ 입력 필드 | RI_S_RAW_DATA JSON 스키마 참조 | 75% | Warning |
| 사전확인 (경정청구기한) | 사업연도 종료+3개월 기산 | M3-01 checkDeadline() CORP분기 | 90% | - |
| **점검0 (과세표준 재산정)** | **법인세율 4단계, 이월결손금** | **일부 MX-02 참조, 상세 로직 부족** | **60%** | **Warning** |
| **점검0 (이월결손금 재검토)** | **80%/100% 한도, 15년 이월** | **M4_29_LossCarryforward 구현체명만** | **30%** | **Critical** |
| **점검0 (결손금 소급공제)** | **법인세법 제72조, NPV 비교** | **M4_31_LossCarryback 구현체명만** | **30%** | **Critical** |
| **점검0 (세무조정 재검토)** | **손금불산입/익금산입 오류검토** | **설계 미반영 (M4-11 없음)** | **0%** | **Critical** |
| **점검0 (업무용 승용차)** | **법인세법 시행령 제50조의2** | **설계 미반영** | **0%** | **Warning** |
| **점검0 (결산확정의 원칙)** | **결산조정 vs 신고조정 전략** | **M3-00에서 Hard Fail만 처리** | **50%** | **Warning** |
| 점검1 (그룹A/B비교) | 감면/공제 그룹 비교 + 법인특화 | M5-02 compareGroups() | 85% | - |
| 점검2 (소재지-본점간주) | 본점 소재지 간주 규정 | M3-03 CORP 분기 | 90% | - |
| 점검3-4 (농특세) | 부담 반영 + 예외 | M5-04 | 95% | - |
| 점검5 (최저한세-법인) | 과세표준 x 7~17% | M5-03 CORP 분기 | 85% | - |
| 점검6-7 (상호배제) | 불가/허용 조합 | M5-01 | 90% | - |
| 점검8-9 (금액/비율 절사) | 절사 원칙 | MoneyAmount/TaxRate | 100% | - |
| 점검9-2 (중소기업-법인특화) | 독립성/주주/연결납세 | M3-02 + 법인 추가 요건 참조 | 75% | Warning |
| 점검9-3 (적용순서-법인) | 법인세법 제59조 | M5-05 CORP 분기 | 90% | - |
| 점검9-4 (기존신고-법인) | 세액조정계산서/중간예납 | RefundResult에 부분 반영 | 60% | Warning |
| 점검9-5 (환급가산금-법인) | 익금불산입 처리 | M6 interestAmount | 80% | - |
| 점검10-13 (투자세액공제) | 공제율/수도권/감가상각 | M4_01 InvestmentCredit | 80% | - |
| 점검14-16 (통합고용-법인) | 법인단위합산, 등기임원제외 | M4_02 EmploymentCredit | 75% | Warning |
| 점검15-2~15-6 (고용상세) | 법인 특화 입력자료/공식 | CreditCalculator 인터페이스만 | 50% | Warning |
| 점검17-18 (사회보험료) | 4대보험/공제율 | M4_25 구현체명만 | 30% | Warning |
| 점검19 (고용증대 경과) | 제29조의7 경과규정 | 설계 미반영 | 10% | Warning |
| 점검20-21 (창업감면-법인) | 법인설립일, 법인전환 불인정 | M4_04 StartupExemption | 70% | Warning |
| 점검20-2~20-6 (창업상세) | 법인 특화 입력자료/공식 | CreditCalculator 인터페이스만 | 40% | Warning |
| 점검22-23 (R&D-법인) | 법인 특화 R&D | M4_06 RdCredit | 75% | Warning |
| 점검22-2~22-6 (R&D상세) | 증가분/당기분/공식 | CreditCalculator 인터페이스만 | 40% | Warning |
| 점검24 (중소특별감면-법인) | 본점간주 감면율 영향 | M4_05 SmeSpecialExemption | 70% | Warning |
| 점검24-2~24-6 (감면상세) | 법인 특화 입력자료/공식 | CreditCalculator 인터페이스만 | 40% | Warning |
| **외국납부세액공제 (법인)** | **직접+간접공제, 손금산입 비교** | **M4_07_ForeignTaxCredit_Corp 구현체명만** | **30%** | **Warning** |
| **수입배당금 익금불산입** | **법인세법 제18조의2, 3단계 개정** | **M4_09_DividendExclusion 구현체명만** | **20%** | **Warning** |
| **토지등 양도세 추가과세** | **법인세법 제55조의2** | **설계 미반영 (M4-12 없음)** | **0%** | **Warning** |
| **기업구조조정 과세이연** | **합병/분할 관련** | **설계 미반영 (M4-13 없음)** | **0%** | **Info** |
| **연결납세 특화 점검** | **연결납세 대상 법인** | **설계 미반영 (M4-14 없음)** | **0%** | **Info** |
| **재해손실세액공제(법인)** | **법인세법 제58조** | **설계 미반영 (M4-15 없음)** | **0%** | **Info** |

### 2.2 법인사업자 프롬프트 미커버 Critical 항목

| # | 항목 | 설명 | 영향도 |
|---|------|------|--------|
| CORP-C01 | 이월결손금 재검토 (점검0) | 법인세법 제13조. 80%/100% 한도, 15년 이월, 과세표준 변동시 재산정. M4_29 구현체명만 존재 | **Very High** |
| CORP-C02 | 결손금 소급공제 NPV 비교 (점검0) | 법인세법 제72조. 이월 vs 소급 NPV 비교 로직 미설계 | High |
| CORP-C03 | 세무조정 재검토 (점검0) | 손금불산입/익금산입/접대비한도/업무무관자산이자/가지급금인정이자/수입배당금 등 세무조정 오류 검토 전체 미설계 | **Very High** |
| CORP-C04 | 업무용 승용차 비용 불산입 재검토 | 법인세법 시행령 제50조의2. 많은 법인에서 오류 발생하는 항목으로 프롬프트에서 강조됨 | High |

---

## 3. 계산 공식/로직 커버리지 (75%)

### 3.1 커버된 계산 공식

| 공식 ID | 공식 | 설계서 위치 | 정확도 |
|---------|------|-------------|:------:|
| F01 | 감면세액 = 산출세액 x (감면대상소득/종합소득) x 감면율 | IncomeAllocationService | PASS |
| F02 | 통합고용 = (청년증가 x 단가) + (일반증가 x 단가) | M4_02 참조 | Partial |
| F03 | 최저한세(법인) = 과세표준 x 7~17% | M5-03 CORP 분기 | PASS |
| F04 | 최저한세(개인) = 산출세액 x 35%(3천만 초과 45%) | M5-03 INC 분기 | PASS |
| F05 | 농특세 = 공제액 x 20% | M5-04 | PASS |
| F06 | 환급가산금 = 환급세액 x 일수 x 연이율 / 365 | M6 RefundCalculation | PASS |
| F07 | 다사업장 감면 = SUM(산출세액 x 사업장소득/종합소득 x 감면율) | IncomeAllocationService.calculateMultiBusinessExemption | PASS |
| F08 | 금액 절사: 10원 미만 truncate | MoneyAmount.truncate10() | PASS |
| F09 | 비율 절사: 소수점 3자리 truncate | TaxRate.truncate3() | PASS |
| F10 | 순환참조 해결: 최대 5회, 1원 수렴 | CircularReferenceResolver | PASS |

### 3.2 미커버 / 부분 커버 계산 공식

| 공식 ID | 공식 | 프롬프트 출처 | 심각도 |
|---------|------|---------------|:------:|
| **F11** | **소득세 산출세액 = 과세표준 x 누진세율(8단계)** | 개인 점검9-7 | **Critical** |
| **F12** | **법인세 산출세액 = 과세표준 x 법인세율(4단계)** | 법인 점검0 | **Warning** |
| **F13** | **결손금 소급공제 환급세액 = 직전연도 산출세액 x (소급결손금/직전과세표준)** | 개인 점검9-8, 법인 점검0 | **Critical** |
| **F14** | **상시근로자 수 = SUM(월말 재직 수) / 해당 월수** | 개인/법인 점검15-3 | **Warning** |
| **F15** | **청년 조정나이 = 만나이 - (복무개월수/12)** | 개인/법인 점검14 | **Warning** |
| **F16** | **감면한도(제7조) = MAX(0, 1억원 - 감소인원 x 500만원)** | 개인/법인 점검24-3 | **Warning** |
| **F17** | **R&D 증가분 공제 = (당기R&D - 직전R&D) x 공제율** | 개인/법인 점검22-3 | **Warning** |
| **F18** | **R&D 당기분 공제 = 당기R&D x 공제율** | 개인/법인 점검22-3 | **Warning** |
| **F19** | **R&D 비율분 = 수입금액 대비 R&D비 비율 x 3배 (최대 10%)** | 개인/법인 점검22-3 | **Warning** |
| **F20** | **실질 환급액 = 기존 납부세액(중간예납+확정+분납) - 경정후 결정세액** | 개인 점검9-4 | **Critical** |
| **F21** | **외국납부세액공제 한도 = 산출세액 x (국외원천소득/종합소득)** | 개인 점검34 | **Warning** |
| **F22** | **공동사업자 감면 = 산출세액 x (본인지분 감면소득/종합소득) x 감면율** | 개인 점검9-6 | **Warning** |

---

## 4. 데이터 구조 커버리지 (80%)

### 4.1 프롬프트 필수 입력 필드 vs 설계서 테이블

#### 개인사업자 입력 필드

| 프롬프트 입력 필드 | 설계서 DDL/Entity | 커버리지 |
|-------------------|-------------------|:--------:|
| 사업자 유형 (개인) | tax_type = 'INC' | PASS |
| 기업 규모 (소기업/중기업) | CorpSize enum | PASS |
| 사업장 수 (다사업장) | RI_S_RAW_DATA JSON | Partial |
| **공동사업자 여부/손익분배비율** | **설계 미반영** | **FAIL** |
| 업종 (KSIC 코드) | RI_S_RAW_DATA JSON | Partial |
| 사업장 소재지 | CapitalZone enum | PASS |
| **인구감소지역 여부** | **설계 미반영** | **FAIL** |
| 수입금액/사업소득금액 | RI_S_RAW_DATA JSON | Partial |
| 상시근로자 수 (청년등/일반) | employee_detail JSON | Partial |
| 창업일 | RI_S_RAW_DATA JSON | Partial |
| 연구개발 전담부서 보유 | RI_S_RAW_DATA JSON | Partial |
| 벤처기업 확인 여부/확인일 | RI_S_RAW_DATA JSON | Partial |
| **대표자 생년월일/성별** | **RI_S_RAW_DATA 추정** | **Partial** |
| **대표자 병역이행 기간** | **RI_S_RAW_DATA 추정** | **Partial** |
| **종합소득 합산 정보(근로/이자/배당/연금/기타)** | **설계 미반영** | **FAIL** |
| **소득공제 정보(인적/연금/주택자금/노란우산)** | **설계 미반영** | **FAIL** |
| **과거 사업 이력(동일업종 폐업)** | **설계 미반영** | **FAIL** |
| **차기 연도 결손 여부** | **설계 미반영** | **FAIL** |
| **분리과세 소득 여부** | **설계 미반영** | **FAIL** |
| **외국납부세액 유무** | **RI_S_RAW_DATA 추정** | **Partial** |
| **임대료 인하 여부** | **설계 미반영** | **FAIL** |
| **기장 방식 (복식/간편/추계)** | **설계 미반영** | **FAIL** |
| **성실신고확인대상 여부** | **M3-01 참조만** | **Partial** |

#### 법인사업자 추가 입력 필드

| 프롬프트 입력 필드 | 설계서 DDL/Entity | 커버리지 |
|-------------------|-------------------|:--------:|
| 법인등록번호 | RI_S_RAW_DATA JSON | Partial |
| 사업연도 | RI_S_RAW_DATA JSON | Partial |
| **이월결손금 (공제 전/후)** | **설계 미반영 (RI_S_CREDIT_CARRYFORWARD DDL 없음)** | **FAIL** |
| **이월된 미공제 세액 내역** | **설계 미반영** | **FAIL** |
| **이월결손금 잔액 및 발생 연도별** | **설계 미반영** | **FAIL** |
| **연결납세 적용 여부** | **설계 미반영** | **FAIL** |
| **세액조정계산서 주요 항목** | **설계 미반영** | **FAIL** |
| 결정세액/납부세액 | co_s_refund.original_determined_tax | PASS |

### 4.2 산출 데이터 구조

| 프롬프트 산출 요구 | 설계서 테이블 | 커버리지 |
|-------------------|--------------|:--------:|
| 적용 가능 항목 목록 | co_s_credit_detail (14건) | PASS |
| 최적 조합 (그룹A/B) | co_s_combination | PASS |
| 환급액 비교표 | co_s_refund | PASS |
| 최저한세 영향 분석 | M5-03 결과 | Partial |
| **이월공제 대상 금액/연도** | **설계 미반영** | **FAIL** |
| **필요 증빙 서류 목록** | **설계 미반영** | **FAIL** |
| **사후관리 리스크 수치화** | **설계 미반영** | **FAIL** |
| **소득공제 반영 전/후 비교** | **설계 미반영** | **FAIL** |

---

## 5. 비즈니스 규칙 커버리지 (82%)

### 5.1 커버된 비즈니스 규칙

| 규칙 | 설계서 반영 | 정확도 |
|------|-------------|:------:|
| 상호배제 규칙 (7개 조합) | M5-01 + RF_S_MUTUAL_EXCLUSION | PASS |
| 상호배제 허용 (5개 조합) | M5-01 | PASS |
| 2025년부터 제6조+제29조의8 중복배제 | verifyExclusion() taxYear 분기 | PASS |
| 최저한세 법인/개인 분리 | M5-03 TaxType 분기 | PASS |
| 농특세 비과세 항목 구분 | CreditItem.nongteukExempt | PASS |
| 적용순서 (감면->이월불가->이월가능) | M5-05 applyOrder() | PASS |
| 절사 원칙 (반올림 금지) | MoneyAmount/TaxRate ROUND 없음 | PASS |
| 순환참조 5회 수렴 | CircularReferenceResolver MAX_ITERATIONS=5 | PASS |
| 본점 소재지 간주 (법인 제7조) | M3-03 CORP 분기 | PASS |
| 투자세액공제는 실제 투자소재지 (제24조) | M3-03 주석 | PASS |
| R&D 최저한세 3단계 배제 | M5-03 주석 | PASS |
| 감면은 이월불가 / 공제는 이월가능 | CreditItem.carryforwardable | PASS |

### 5.2 미커버 / 부분 커버 비즈니스 규칙

| 규칙 | 프롬프트 출처 | 심각도 |
|------|---------------|:------:|
| **결산확정의 원칙 (경정청구 전략 핵심)** | 법인 점검0 | **Critical** |
| **경정청구 가능/불가능 항목 구분** | 법인 프롬프트 서두 | **Critical** |
| **개인 사업장별 개별 소재지 판단 vs 법인 본점간주** | 점검2 | Partial (주석 존재) |
| **공동사업자 손익분배비율 배분** | 개인 점검9-6 | **Warning** |
| **분리과세 소득 종합소득금액 제외** | 개인 점검9-6 | **Warning** |
| **금융소득 2천만원 초과시 전액 합산** | 개인 점검9-6 | **Warning** |
| **추계신고 사업자 감면 배제** | 개인 점검9-6 | **Warning** |
| **기장세액공제 = 조특법 중복배제 비대상** | 개인 점검30 | **Warning** |
| **성실신고확인비용 = 최저한세 적용 대상 / 의료비교육비 = 비대상** | 개인 점검5/26/31-2 | **Critical** |
| **창업 불인정 사유 (동일업종 재창업)** | 개인/법인 점검20 | **Warning** |
| **고용증대세액공제 경과규정 (제29조의7)** | 개인/법인 점검19 | **Warning** |
| **장수 성실중소기업 우대 (감면율 x 110%)** | 법인 점검24-3 | **Info** |
| **중소기업 졸업 시 투자세액공제 점감구조** | 법인 점검11 | **Info** |
| **환급가산금 = 개인은 비과세소득 / 법인은 익금불산입** | 개인/법인 점검9-5 | **Info** |

---

## 6. 교차 분석: 프롬프트 공통 요구사항 vs 설계서

프롬프트 두 문서에 공통으로 존재하는 핵심 요구사항의 설계 반영 현황.

| 공통 요구사항 | 개인 프롬프트 | 법인 프롬프트 | 설계서 반영 | Gap |
|--------------|:-----------:|:-----------:|:-----------:|:---:|
| 그룹A/B 비교 분석 | 점검1 | 점검1 | M5-02 | Low |
| 농특세 부담/예외 | 점검3-4 | 점검3-4 | M5-04 | Low |
| 최저한세 적용 | 점검5 | 점검5 | M5-03 | Low |
| 상호배제 규칙 | 점검6-7 | 점검6-7 | M5-01 | Low |
| 절사 원칙 | 점검8-9 | 점검8-9 | MoneyAmount/TaxRate | None |
| 중소기업 판단 | 점검9-2 | 점검9-2 | M3-02 | Low |
| 적용순서 | 점검9-3 | 점검9-3 | M5-05 | Low |
| **기존 신고 확인** | **점검9-4** | **점검9-4** | **RefundResult 부분** | **High** |
| 환급가산금 | 점검9-5 | 점검9-5 | M6 | Medium |
| 통합투자세액공제 | 점검10-13 | 점검10-13 | M4_01 | Medium |
| 통합고용세액공제 | 점검14-16 | 점검14-16 | M4_02 | Medium |
| **고용공제 상세 (15-2~15-6)** | **6개 하위점검** | **6개 하위점검** | **인터페이스만** | **High** |
| 사회보험료 세액공제 | 점검17-18 | 점검17-18 | M4_25 이름만 | High |
| **고용증대 경과규정** | **점검19** | **점검19** | **미설계** | **High** |
| 창업감면 | 점검20-21 | 점검20-21 | M4_04 | Medium |
| **창업감면 상세 (20-2~20-6)** | **5개 하위점검** | **6개 하위점검** | **인터페이스만** | **High** |
| R&D 공제 | 점검22-23 | 점검22-23 | M4_06 | Medium |
| **R&D 상세 (22-2~22-6)** | **5개 하위점검** | **6개 하위점검** | **인터페이스만** | **High** |
| 중소특별감면 | 점검24-25 | 점검24 | M4_05 | Medium |
| **감면 상세 (24-2~24-6)** | **5개 하위점검** | **6개 하위점검** | **인터페이스만** | **High** |
| **필수 증빙서류 목록** | **4단계 보고서** | **4단계 보고서** | **미설계** | **High** |
| **사후관리 리스크** | **4단계 보고서** | **4단계 보고서** | **미설계** | **Medium** |

---

## 7. Critical / Warning / Info 분류 종합

### 7.1 Critical Issues (22건)

설계서에 전혀 반영되지 않았거나 구현체 이름만 존재하여 비즈니스 로직 상세가 없는 핵심 항목.

| # | Category | Issue | 프롬프트 출처 | 설계 현황 |
|---|----------|-------|---------------|-----------|
| CR-01 | 개인 | 소득공제 누락 점검/세율구간 최적화 (P4-01) | 개인 점검32 | 설계 전무 |
| CR-02 | 개인 | 노란우산공제 소득공제 | 개인 점검27 | 설계 전무 |
| CR-03 | 개인 | 연금저축 세액공제 | 개인 점검28 | 설계 전무 |
| CR-04 | 개인 | 자녀세액공제 | 개인 점검29 | 설계 전무 |
| CR-05 | 개인 | 결손금 소급공제 상세+NPV비교 | 개인 점검9-8 | 구현체명만 |
| CR-06 | 개인 | 소득세 세율 적용 로직 | 개인 점검9-7 | MX-02 참조만 |
| CR-07 | 개인 | 기납부세액 상세(중간예납/원천/분납) | 개인 점검9-4 | originalPaidTax 단일필드 |
| CR-08 | 개인 | 성실사업자 의료비교육비 최저한세 비대상 처리 | 개인 점검26 | 구현체명만 |
| CR-09 | 개인 | 공동사업자 소득배분 로직 | 개인 점검9-6 | 설계 전무 (P4-03) |
| CR-10 | 개인 | 종합소득금액 산정(사업+근로+기타 합산) | 개인 핵심전제 | 암시적 처리만 |
| CR-11 | 법인 | 이월결손금 재검토 상세 | 법인 점검0 | 구현체명만 |
| CR-12 | 법인 | 결손금 소급공제 NPV 비교 | 법인 점검0 | 구현체명만 |
| CR-13 | 법인 | 세무조정 재검토 전체 | 법인 점검0 | 설계 전무 (M4-11) |
| CR-14 | 공통 | 통합고용세액공제 상세 산출공식 | 점검15-3 | 인터페이스만 |
| CR-15 | 공통 | 창업감면 상세 산출공식 | 점검20-3 | 인터페이스만 |
| CR-16 | 공통 | R&D 공제 상세 산출공식 | 점검22-3 | 인터페이스만 |
| CR-17 | 공통 | 중소특별감면 상세 산출공식 | 점검24-3 | 인터페이스만 |
| CR-18 | 공통 | 최종보고서 양식 (환급액비교표/이월분석/증빙목록) | 4단계 보고서 | CO_S_REPORT_JSON 구조만 |
| CR-19 | 개인 | 분리과세 소득 처리 (종합소득금액 제외) | 개인 핵심전제 12번 | 주석에만 언급 |
| CR-20 | 개인 | 입력 필드: 공동사업자/분리과세/기장방식/임대료인하 등 | 개인 납세자기본정보 | RI_S_RAW_DATA JSON 미상세 |
| CR-21 | 법인 | 입력 필드: 이월결손금/이월미공제/세액조정계산서 등 | 법인 기본정보 | RI_S_RAW_DATA JSON 미상세 |
| CR-22 | 공통 | 사회보험료 세액공제 상세 로직 | 점검17 | 구현체명만 |

### 7.2 Warning Issues (16건)

| # | Category | Issue |
|---|----------|-------|
| WR-01 | 개인 | 착한 임대인 세액공제 (P4-08 없음) |
| WR-02 | 개인 | 기장세액공제 상세 (구현체명만) |
| WR-03 | 개인 | 성실신고확인비용 세액공제 상세 (구현체명만) |
| WR-04 | 법인 | 업무용 승용차 비용 불산입 재검토 (M4-11 없음) |
| WR-05 | 법인 | 외국납부세액공제 직접+간접+손금산입 비교 로직 |
| WR-06 | 법인 | 수입배당금 익금불산입 3단계 개정 반영 |
| WR-07 | 공통 | 고용증대세액공제 경과규정 (제29조의7) |
| WR-08 | 공통 | 각 서브모듈 필수 증빙서류 체크리스트 |
| WR-09 | 공통 | 사후관리 리스크 수치화 (추징 예상액) |
| WR-10 | 개인 | 다사업장 소득 합산/배분 구조 상세 |
| WR-11 | 법인 | 결산확정의 원칙 전략적 활용 |
| WR-12 | 공통 | 환급가산금 법적 성격 구분 (개인 비과세 vs 법인 익금불산입) |
| WR-13 | 법인 | 토지등 양도세 추가과세 (M4-12 없음) |
| WR-14 | 공통 | 인구감소지역 해당 여부 판단 로직 |
| WR-15 | 개인 | 건강보험료 가입유형별 처리 (지역/직장 구분) |
| WR-16 | 공통 | 법령 적용 시점 판단 원칙 상세 (경정청구 대상 사업연도 기준) |

### 7.3 Info Issues (8건)

| # | Category | Issue |
|---|----------|-------|
| NF-01 | 법인 | 기업구조조정 과세이연 (M4-13 없음, Could) |
| NF-02 | 법인 | 연결납세 특화 점검 (M4-14 없음, Could) |
| NF-03 | 공통 | 재해손실세액공제 (M4-15 없음, 제한적 사례) |
| NF-04 | 개인 | 벤처투자조합 출자 소득공제 (제한적 사례) |
| NF-05 | 개인 | 전자신고 세액공제 2만원 (소액) |
| NF-06 | 공통 | 참고 판례/예규 인용 체계 |
| NF-07 | 법인 | 장수 성실중소기업 우대 |
| NF-08 | 법인 | 중소기업 졸업 시 투자세액공제 점감구조 |

---

## 8. 기존 검증 리포트(78점)와의 비교

기존 `design-validation-report.md`는 Plan 문서(55개 FR) 대비 Design을 검증한 것이고, 본 분석은 원본 프롬프트(개인+법인) 대비 Design을 검증한 것이다.

| 비교 항목 | 기존 리포트 (Plan vs Design) | 본 분석 (Prompt vs Design) |
|-----------|:---------------------------:|:--------------------------:|
| 분석 대상 | Plan FR 55개 (68개 하위 포함) | 프롬프트 점검 항목 90+ |
| 분석 범위 | 기능 요구사항 중심 | 계산 공식 + 비즈니스 규칙 + 입력 필드 포함 |
| 점수 | 78/100 | 68% |
| Critical 건수 | 3건 (C-01~C-03) | 22건 |
| 주요 발견 | req_id 불일치, P4-01 미설계, CANCELLED 미설계 | 개인 전용 공제 7건 미설계, 서브모듈 상세 전무, 법인 세무조정 미설계 |

본 분석에서 추가로 발견된 주요 Gap:
1. **프롬프트의 서브 점검 항목**: 점검 15-2~15-6, 20-2~20-6, 22-2~22-6, 24-2~24-6 등 각 공제/감면의 (a)입력자료 (b)산출공식 (c)중복규칙 (d)최저한세 (e)경정청구 유의사항을 상세히 요구하나, 설계서는 CreditCalculator 인터페이스만 정의
2. **개인사업자 전용 공제 7건**: 노란우산공제, 연금저축, 자녀세액공제, 기장세액공제, 성실신고확인비용, 성실사업자 의료비/교육비, 소득공제 누락점검 -- 이 중 3건만 구현체명 존재
3. **법인사업자 세무조정**: 손금불산입/익금산입/접대비한도/업무용 승용차 등 세무조정 오류 재검토 전체가 설계 미반영

---

## 9. Recommended Actions

### 9.1 Immediate (설계 보완 필수, 구현 착수 전)

| # | Action | 관련 이슈 | 예상 공수 |
|---|--------|-----------|:---------:|
| 1 | **P4-01 소득공제 누락 점검 모듈 상세 설계** | CR-01, CR-02, CR-03, CR-04 | 2일 |
| 2 | **개인사업자 전용 공제 4건 상세 설계 추가** (노란우산, 연금저축, 자녀세액, 전자신고) | CR-02~CR-04 | 1일 |
| 3 | **결손금 소급공제(개인+법인) NPV 비교 로직 설계** | CR-05, CR-12 | 1일 |
| 4 | **소득세/법인세 세율 적용 로직 상세 설계** (MX-02 확장) | CR-06 | 0.5일 |
| 5 | **기납부세액 상세 구분 추가** (RefundResult 확장: 중간예납/원천징수/확정신고/분납) | CR-07 | 0.5일 |
| 6 | **법인 세무조정 재검토 모듈(M4-11) 설계** | CR-13 | 2일 |
| 7 | **공동사업자 소득배분(P4-03) 설계** | CR-09 | 1일 |

### 9.2 High Priority (Sprint 1 전 권장)

| # | Action | 관련 이슈 | 예상 공수 |
|---|--------|-----------|:---------:|
| 8 | 14개 서브모듈 각각의 상세 산출공식/입력자료/검증규칙 설계 | CR-14~CR-17, CR-22 | 5일 |
| 9 | 이월결손금 재검토 상세 설계 (M4_29) | CR-11 | 1일 |
| 10 | 성실사업자 의료비/교육비 최저한세 비대상 M5-03 반영 | CR-08 | 0.5일 |
| 11 | 착한 임대인 세액공제(P4-08) 설계 | WR-01 | 0.5일 |
| 12 | 고용증대세액공제 경과규정(제29조의7) 설계 | WR-07 | 0.5일 |
| 13 | 입력 필드 상세 정의 (공동사업자/분리과세/기장방식/임대료인하 등) | CR-20, CR-21 | 1일 |
| 14 | 최종보고서(4단계) 양식 상세 설계 (환급액비교표/이월분석/증빙목록/사후관리리스크) | CR-18 | 2일 |

### 9.3 Medium Priority (구현 중 보완)

| # | Action | 관련 이슈 | 예상 공수 |
|---|--------|-----------|:---------:|
| 15 | 외국납부세액공제 직접/간접/손금산입 비교 로직 | WR-05 | 1일 |
| 16 | 수입배당금 익금불산입 3단계 개정 반영 | WR-06 | 0.5일 |
| 17 | 사후관리 리스크 수치화 (추징 예상액 산출) | WR-09 | 1일 |
| 18 | 필수 증빙서류 체크리스트 데이터 구조 | WR-08 | 0.5일 |
| 19 | 인구감소지역 판단 로직 (행정안전부 고시 연동) | WR-14 | 0.5일 |
| 20 | 법령 적용 시점 판단 원칙 구현 (MX-02 확장) | WR-16 | 1일 |

---

## 10. Synchronization Options

본 Gap 분석 결과에 따라 다음 옵션을 권고한다:

| Option | 설명 | 권고 |
|--------|------|:----:|
| **Option 1**: 설계서 보완 후 구현 | CR-01~CR-22 해결 후 구현 착수 | Recommended |
| **Option 2**: 구현과 병행 보완 | 기반(Week 1-2)부터 시작하며 설계 보완 | Acceptable |
| **Option 3**: 설계서를 현행대로 유지 | 프롬프트 요구사항 일부를 Phase 2로 이관 | Not Recommended |

**권고 사항**: Option 1을 기본으로 하되, 최소 Immediate(9.1) 7건을 해결한 후 Option 2로 전환하는 것이 현실적이다. 특히 CR-01(소득공제 누락 점검)과 CR-13(세무조정 재검토)은 각각 개인/법인의 핵심 환급 로직이므로 반드시 설계 완료 후 구현해야 한다.

---

## Version History

| Version | Date | Changes |
|---------|------|---------|
| 1.0 | 2026-02-17 | 초기 Gap 분석 - 프롬프트 v1.3 (개인+법인) vs 설계서 v1.0. Overall 68%, Critical 22건, Warning 16건, Info 8건 |
